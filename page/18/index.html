<!DOCTYPE html>
<html  lang="zh">
<head>
    <meta charset="utf-8" />

<meta name="generator" content="Hexo 3.9.0" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>Learning</title>


    <meta name="description" content="private learning">
<meta property="og:type" content="website">
<meta property="og:title" content="Learning">
<meta property="og:url" content="http://yoursite.com/page/18/index.html">
<meta property="og:site_name" content="Learning">
<meta property="og:description" content="private learning">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://yoursite.com/images/og_image.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Learning">
<meta name="twitter:description" content="private learning">
<meta name="twitter:image" content="http://yoursite.com/images/og_image.png">







<link rel="icon" href="/images/favicon.svg">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    

    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    

    
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">


    
    
    
    

<link rel="stylesheet" href="/css/back-to-top.css">


    
    

    
    
    
    

    
    
<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

    
    
    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.svg" alt="Learning" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">Home</a>
                
                <a class="navbar-item"
                href="/archives">Archives</a>
                
                <a class="navbar-item"
                href="/categories">Categories</a>
                
                <a class="navbar-item"
                href="/tags">Tags</a>
                
                <a class="navbar-item"
                href="/">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    
                    <a class="navbar-item" target="_blank" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                
                <a class="navbar-item search" title="Search" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main">
    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-07-17T03:00:00.000Z">2019-07-17</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/IT/">IT</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    31 分钟 read (About 4608 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/07/17/springboot-quarz/">springboot Quartz</a>
            
        </h1>
        <div class="content">
            <p>SpringBoot整合Quartz作为调度中心完整实用例子 </p>
<p>因为想要做一个类似于调度中心的东西，定时执行一些Job(通常是一些自定义程序或者可执行的jar包)，搭了一个例子，总结了前辈们的相关经验和自己的一些理解，如有雷同或不当之处，望各位大佬见谅和帮忙指正。<br>由于之前有许多小伙伴问过我如何写个定时任务，里面写上逻辑自己的逻辑,我另做了一个SpringBoot完全整合Quartz的简单例子<br>可以作为Quartz的入门参考 : <a href="https://github.com/EalenXie/springboot-quartz-simple" target="_blank" rel="noopener">https://github.com/EalenXie/springboot-quartz-simple</a></p>
<p>本例子是整合Quartz作为调度中心使用的。<br>1.首先新建项目SpringBoot-Quartz ,选用的技术栈为 SpringBoot + Quartz + Spring Data Jpa。完整代码可见(本文已非最新代码,最新见Github) : <a href="https://github.com/EalenXie/SpringBoot-Quartz" target="_blank" rel="noopener">https://github.com/EalenXie/SpringBoot-Quartz</a><br>pom.xml依赖 : </p>
<figure class="highlight xml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>name.ealenxie<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>SpringBoot-Quartz<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.1.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>runtime<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span> <span class="hljs-comment">&lt;!--quartz依赖--&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.quartz-scheduler<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>quartz<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.2.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-context-support<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.quartz-scheduler<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>quartz-jobs<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.2.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>2.你需要在数据库中建立Quartz的相关系统表，所以你需要在数据库中执行如下来自Quartz官方的脚本。</p>
<figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">-- in your Quartz properties file, you'll need to set org.quartz.jobStore.driverDelegateClass = org.quartz.impl.jdbcjobstore.StdJDBCDelegate</span></span><br><span class="line"><span class="hljs-comment">-- 你需要在你的quartz.properties文件中设置org.quartz.jobStore.driverDelegateClass = org.quartz.impl.jdbcjobstore.StdJDBCDelegate</span></span><br><span class="line"><span class="hljs-comment">-- StdJDBCDelegate说明支持集群，所有的任务信息都会保存到数据库中，可以控制事物，还有就是如果应用服务器关闭或者重启，任务信息都不会丢失，并且可以恢复因服务器关闭或者重启而导致执行失败的任务</span></span><br><span class="line"><span class="hljs-comment">-- This is the script from Quartz to create the tables in a MySQL database, modified to use INNODB instead of MYISAM</span></span><br><span class="line"><span class="hljs-comment">-- 这是来自quartz的脚本，在MySQL数据库中创建以下的表，修改为使用INNODB而不是MYISAM</span></span><br><span class="line"><span class="hljs-comment">-- 你需要在数据库中执行以下的sql脚本</span></span><br><span class="line"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">EXISTS</span> QRTZ_FIRED_TRIGGERS;</span><br><span class="line"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">EXISTS</span> QRTZ_PAUSED_TRIGGER_GRPS;</span><br><span class="line"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">EXISTS</span> QRTZ_SCHEDULER_STATE;</span><br><span class="line"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">EXISTS</span> QRTZ_LOCKS;</span><br><span class="line"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">EXISTS</span> QRTZ_SIMPLE_TRIGGERS;</span><br><span class="line"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">EXISTS</span> QRTZ_SIMPROP_TRIGGERS;</span><br><span class="line"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">EXISTS</span> QRTZ_CRON_TRIGGERS;</span><br><span class="line"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">EXISTS</span> QRTZ_BLOB_TRIGGERS;</span><br><span class="line"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">EXISTS</span> QRTZ_TRIGGERS;</span><br><span class="line"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">EXISTS</span> QRTZ_JOB_DETAILS;</span><br><span class="line"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">EXISTS</span> QRTZ_CALENDARS;</span><br><span class="line"><span class="hljs-comment">-- 存储每一个已配置的Job的详细信息</span></span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> QRTZ_JOB_DETAILS(</span><br><span class="line">SCHED_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">120</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">JOB_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">JOB_GROUP <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">DESCRIPTION <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">250</span>) <span class="hljs-literal">NULL</span>,</span><br><span class="line">JOB_CLASS_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">250</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">IS_DURABLE <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">IS_NONCONCURRENT <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">IS_UPDATE_DATA <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">REQUESTS_RECOVERY <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">JOB_DATA <span class="hljs-built_in">BLOB</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="hljs-keyword">KEY</span> (SCHED_NAME,JOB_NAME,JOB_GROUP))</span><br><span class="line"><span class="hljs-keyword">ENGINE</span>=<span class="hljs-keyword">InnoDB</span>;</span><br><span class="line"><span class="hljs-comment">-- 存储已配置的Trigger的信息</span></span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> QRTZ_TRIGGERS (</span><br><span class="line">SCHED_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">120</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">TRIGGER_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">TRIGGER_GROUP <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">JOB_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">JOB_GROUP <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">DESCRIPTION <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">250</span>) <span class="hljs-literal">NULL</span>,</span><br><span class="line">NEXT_FIRE_TIME <span class="hljs-built_in">BIGINT</span>(<span class="hljs-number">13</span>) <span class="hljs-literal">NULL</span>,</span><br><span class="line">PREV_FIRE_TIME <span class="hljs-built_in">BIGINT</span>(<span class="hljs-number">13</span>) <span class="hljs-literal">NULL</span>,</span><br><span class="line"><span class="hljs-keyword">PRIORITY</span> <span class="hljs-built_in">INTEGER</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">TRIGGER_STATE <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">16</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">TRIGGER_TYPE <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">8</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">START_TIME <span class="hljs-built_in">BIGINT</span>(<span class="hljs-number">13</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">END_TIME <span class="hljs-built_in">BIGINT</span>(<span class="hljs-number">13</span>) <span class="hljs-literal">NULL</span>,</span><br><span class="line">CALENDAR_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-literal">NULL</span>,</span><br><span class="line">MISFIRE_INSTR <span class="hljs-built_in">SMALLINT</span>(<span class="hljs-number">2</span>) <span class="hljs-literal">NULL</span>,</span><br><span class="line">JOB_DATA <span class="hljs-built_in">BLOB</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="hljs-keyword">KEY</span> (SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP),</span><br><span class="line"><span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (SCHED_NAME,JOB_NAME,JOB_GROUP)</span><br><span class="line"><span class="hljs-keyword">REFERENCES</span> QRTZ_JOB_DETAILS(SCHED_NAME,JOB_NAME,JOB_GROUP))</span><br><span class="line"><span class="hljs-keyword">ENGINE</span>=<span class="hljs-keyword">InnoDB</span>;</span><br><span class="line"><span class="hljs-comment">-- 存储已配置的Simple Trigger的信息</span></span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> QRTZ_SIMPLE_TRIGGERS (</span><br><span class="line">SCHED_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">120</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">TRIGGER_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">TRIGGER_GROUP <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">REPEAT_COUNT <span class="hljs-built_in">BIGINT</span>(<span class="hljs-number">7</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">REPEAT_INTERVAL <span class="hljs-built_in">BIGINT</span>(<span class="hljs-number">12</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">TIMES_TRIGGERED <span class="hljs-built_in">BIGINT</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="hljs-keyword">KEY</span> (SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP),</span><br><span class="line"><span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP)</span><br><span class="line"><span class="hljs-keyword">REFERENCES</span> QRTZ_TRIGGERS(SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP))</span><br><span class="line"><span class="hljs-keyword">ENGINE</span>=<span class="hljs-keyword">InnoDB</span>;</span><br><span class="line"><span class="hljs-comment">-- 存储Cron Trigger，包括Cron表达式和时区信息</span></span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> QRTZ_CRON_TRIGGERS (</span><br><span class="line">SCHED_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">120</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">TRIGGER_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">TRIGGER_GROUP <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">CRON_EXPRESSION <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">120</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">TIME_ZONE_ID <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">80</span>),</span><br><span class="line">PRIMARY <span class="hljs-keyword">KEY</span> (SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP),</span><br><span class="line"><span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP)</span><br><span class="line"><span class="hljs-keyword">REFERENCES</span> QRTZ_TRIGGERS(SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP))</span><br><span class="line"><span class="hljs-keyword">ENGINE</span>=<span class="hljs-keyword">InnoDB</span>;</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> QRTZ_SIMPROP_TRIGGERS</span><br><span class="line">  (</span><br><span class="line">    SCHED_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">120</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">    TRIGGER_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">    TRIGGER_GROUP <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">    STR_PROP_1 <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">512</span>) <span class="hljs-literal">NULL</span>,</span><br><span class="line">    STR_PROP_2 <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">512</span>) <span class="hljs-literal">NULL</span>,</span><br><span class="line">    STR_PROP_3 <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">512</span>) <span class="hljs-literal">NULL</span>,</span><br><span class="line">    INT_PROP_1 <span class="hljs-built_in">INT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">    INT_PROP_2 <span class="hljs-built_in">INT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">    LONG_PROP_1 <span class="hljs-built_in">BIGINT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">    LONG_PROP_2 <span class="hljs-built_in">BIGINT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">    DEC_PROP_1 <span class="hljs-built_in">NUMERIC</span>(<span class="hljs-number">13</span>,<span class="hljs-number">4</span>) <span class="hljs-literal">NULL</span>,</span><br><span class="line">    DEC_PROP_2 <span class="hljs-built_in">NUMERIC</span>(<span class="hljs-number">13</span>,<span class="hljs-number">4</span>) <span class="hljs-literal">NULL</span>,</span><br><span class="line">    BOOL_PROP_1 <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">1</span>) <span class="hljs-literal">NULL</span>,</span><br><span class="line">    BOOL_PROP_2 <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">1</span>) <span class="hljs-literal">NULL</span>,</span><br><span class="line">    PRIMARY <span class="hljs-keyword">KEY</span> (SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP),</span><br><span class="line">    <span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP)</span><br><span class="line">    <span class="hljs-keyword">REFERENCES</span> QRTZ_TRIGGERS(SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP))</span><br><span class="line"><span class="hljs-keyword">ENGINE</span>=<span class="hljs-keyword">InnoDB</span>;</span><br><span class="line"><span class="hljs-comment">--  Trigger作为Blob类型存储(用于Quartz用户用JDBC创建他们自己定制的Trigger类型，JobStore并不知道如何存储实例的时候)</span></span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> QRTZ_BLOB_TRIGGERS (</span><br><span class="line">SCHED_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">120</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">TRIGGER_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">TRIGGER_GROUP <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">BLOB_DATA <span class="hljs-built_in">BLOB</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="hljs-keyword">KEY</span> (SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP),</span><br><span class="line"><span class="hljs-keyword">INDEX</span> (SCHED_NAME,TRIGGER_NAME, TRIGGER_GROUP),</span><br><span class="line"><span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP)</span><br><span class="line"><span class="hljs-keyword">REFERENCES</span> QRTZ_TRIGGERS(SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP))</span><br><span class="line"><span class="hljs-keyword">ENGINE</span>=<span class="hljs-keyword">InnoDB</span>;</span><br><span class="line"><span class="hljs-comment">-- 以Blob类型存储Quartz的Calendar日历信息,quartz可配置一个日历来指定一个时间范围</span></span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> QRTZ_CALENDARS (</span><br><span class="line">SCHED_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">120</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">CALENDAR_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">CALENDAR <span class="hljs-built_in">BLOB</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="hljs-keyword">KEY</span> (SCHED_NAME,CALENDAR_NAME))</span><br><span class="line"><span class="hljs-keyword">ENGINE</span>=<span class="hljs-keyword">InnoDB</span>;</span><br><span class="line"><span class="hljs-comment">-- 存储已暂停的Trigger组的信息</span></span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> QRTZ_PAUSED_TRIGGER_GRPS (</span><br><span class="line">SCHED_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">120</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">TRIGGER_GROUP <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="hljs-keyword">KEY</span> (SCHED_NAME,TRIGGER_GROUP))</span><br><span class="line"><span class="hljs-keyword">ENGINE</span>=<span class="hljs-keyword">InnoDB</span>;</span><br><span class="line"><span class="hljs-comment">-- 存储与已触发的Trigger相关的状态信息，以及相联Job的执行信息</span></span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> QRTZ_FIRED_TRIGGERS (</span><br><span class="line">SCHED_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">120</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">ENTRY_ID <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">95</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">TRIGGER_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">TRIGGER_GROUP <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">INSTANCE_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">FIRED_TIME <span class="hljs-built_in">BIGINT</span>(<span class="hljs-number">13</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">SCHED_TIME <span class="hljs-built_in">BIGINT</span>(<span class="hljs-number">13</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line"><span class="hljs-keyword">PRIORITY</span> <span class="hljs-built_in">INTEGER</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">STATE <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">16</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">JOB_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-literal">NULL</span>,</span><br><span class="line">JOB_GROUP <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-literal">NULL</span>,</span><br><span class="line">IS_NONCONCURRENT <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">1</span>) <span class="hljs-literal">NULL</span>,</span><br><span class="line">REQUESTS_RECOVERY <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">1</span>) <span class="hljs-literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="hljs-keyword">KEY</span> (SCHED_NAME,ENTRY_ID))</span><br><span class="line"><span class="hljs-keyword">ENGINE</span>=<span class="hljs-keyword">InnoDB</span>;</span><br><span class="line"><span class="hljs-comment">-- 存储少量的有关 Scheduler的状态信息，和别的 Scheduler 实例(假如是用于一个集群中)</span></span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> QRTZ_SCHEDULER_STATE (</span><br><span class="line">SCHED_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">120</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">INSTANCE_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">LAST_CHECKIN_TIME <span class="hljs-built_in">BIGINT</span>(<span class="hljs-number">13</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">CHECKIN_INTERVAL <span class="hljs-built_in">BIGINT</span>(<span class="hljs-number">13</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="hljs-keyword">KEY</span> (SCHED_NAME,INSTANCE_NAME))</span><br><span class="line"><span class="hljs-keyword">ENGINE</span>=<span class="hljs-keyword">InnoDB</span>;</span><br><span class="line"><span class="hljs-comment">-- 存储程序的非观锁的信息(假如使用了悲观锁)</span></span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> QRTZ_LOCKS (</span><br><span class="line">SCHED_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">120</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">LOCK_NAME <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">40</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">PRIMARY <span class="hljs-keyword">KEY</span> (SCHED_NAME,LOCK_NAME))</span><br><span class="line"><span class="hljs-keyword">ENGINE</span>=<span class="hljs-keyword">InnoDB</span>;</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> IDX_QRTZ_J_REQ_RECOVERY <span class="hljs-keyword">ON</span> QRTZ_JOB_DETAILS(SCHED_NAME,REQUESTS_RECOVERY);</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> IDX_QRTZ_J_GRP <span class="hljs-keyword">ON</span> QRTZ_JOB_DETAILS(SCHED_NAME,JOB_GROUP);</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> IDX_QRTZ_T_J <span class="hljs-keyword">ON</span> QRTZ_TRIGGERS(SCHED_NAME,JOB_NAME,JOB_GROUP);</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> IDX_QRTZ_T_JG <span class="hljs-keyword">ON</span> QRTZ_TRIGGERS(SCHED_NAME,JOB_GROUP);</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> IDX_QRTZ_T_C <span class="hljs-keyword">ON</span> QRTZ_TRIGGERS(SCHED_NAME,CALENDAR_NAME);</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> IDX_QRTZ_T_G <span class="hljs-keyword">ON</span> QRTZ_TRIGGERS(SCHED_NAME,TRIGGER_GROUP);</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> IDX_QRTZ_T_STATE <span class="hljs-keyword">ON</span> QRTZ_TRIGGERS(SCHED_NAME,TRIGGER_STATE);</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> IDX_QRTZ_T_N_STATE <span class="hljs-keyword">ON</span> QRTZ_TRIGGERS(SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP,TRIGGER_STATE);</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> IDX_QRTZ_T_N_G_STATE <span class="hljs-keyword">ON</span> QRTZ_TRIGGERS(SCHED_NAME,TRIGGER_GROUP,TRIGGER_STATE);</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> IDX_QRTZ_T_NEXT_FIRE_TIME <span class="hljs-keyword">ON</span> QRTZ_TRIGGERS(SCHED_NAME,NEXT_FIRE_TIME);</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> IDX_QRTZ_T_NFT_ST <span class="hljs-keyword">ON</span> QRTZ_TRIGGERS(SCHED_NAME,TRIGGER_STATE,NEXT_FIRE_TIME);</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> IDX_QRTZ_T_NFT_MISFIRE <span class="hljs-keyword">ON</span> QRTZ_TRIGGERS(SCHED_NAME,MISFIRE_INSTR,NEXT_FIRE_TIME);</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> IDX_QRTZ_T_NFT_ST_MISFIRE <span class="hljs-keyword">ON</span> QRTZ_TRIGGERS(SCHED_NAME,MISFIRE_INSTR,NEXT_FIRE_TIME,TRIGGER_STATE);</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> IDX_QRTZ_T_NFT_ST_MISFIRE_GRP <span class="hljs-keyword">ON</span> QRTZ_TRIGGERS(SCHED_NAME,MISFIRE_INSTR,NEXT_FIRE_TIME,TRIGGER_GROUP,TRIGGER_STATE);</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> IDX_QRTZ_FT_TRIG_INST_NAME <span class="hljs-keyword">ON</span> QRTZ_FIRED_TRIGGERS(SCHED_NAME,INSTANCE_NAME);</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> IDX_QRTZ_FT_INST_JOB_REQ_RCVRY <span class="hljs-keyword">ON</span> QRTZ_FIRED_TRIGGERS(SCHED_NAME,INSTANCE_NAME,REQUESTS_RECOVERY);</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> IDX_QRTZ_FT_J_G <span class="hljs-keyword">ON</span> QRTZ_FIRED_TRIGGERS(SCHED_NAME,JOB_NAME,JOB_GROUP);</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> IDX_QRTZ_FT_JG <span class="hljs-keyword">ON</span> QRTZ_FIRED_TRIGGERS(SCHED_NAME,JOB_GROUP);</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> IDX_QRTZ_FT_T_G <span class="hljs-keyword">ON</span> QRTZ_FIRED_TRIGGERS(SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP);</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> IDX_QRTZ_FT_TG <span class="hljs-keyword">ON</span> QRTZ_FIRED_TRIGGERS(SCHED_NAME,TRIGGER_GROUP);</span><br><span class="line"><span class="hljs-keyword">commit</span>;</span><br></pre></td></tr></table></figure>

<p>3.新建完Quartz系统表之后,你需要做SpringBoot和Quartz的相关配置<br>application.yml</p>
<figure class="highlight yaml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-attr">quartz:</span></span><br><span class="line"><span class="hljs-attr">  enabled:</span> <span class="hljs-literal">true</span></span><br><span class="line"><span class="hljs-attr">server:</span></span><br><span class="line"><span class="hljs-attr">  port:</span> <span class="hljs-number">9090</span></span><br><span class="line"><span class="hljs-attr">spring:</span></span><br><span class="line"><span class="hljs-attr">  datasource:</span></span><br><span class="line"><span class="hljs-attr">    url:</span> <span class="hljs-attr">jdbc:mysql://localhost:3306/spring_quartz</span></span><br><span class="line"><span class="hljs-attr">    username:</span> <span class="hljs-string">yourname</span></span><br><span class="line"><span class="hljs-attr">    password:</span> <span class="hljs-string">yourpassword</span></span><br><span class="line"><span class="hljs-attr">    tomcat:</span></span><br><span class="line"><span class="hljs-attr">      initialSize:</span> <span class="hljs-number">20</span></span><br><span class="line"><span class="hljs-attr">      maxActive:</span> <span class="hljs-number">100</span></span><br><span class="line"><span class="hljs-attr">      maxIdle:</span> <span class="hljs-number">100</span></span><br><span class="line"><span class="hljs-attr">      minIdle:</span> <span class="hljs-number">20</span></span><br><span class="line"><span class="hljs-attr">      maxWait:</span> <span class="hljs-number">10000</span></span><br><span class="line"><span class="hljs-attr">      testWhileIdle:</span> <span class="hljs-literal">true</span></span><br><span class="line"><span class="hljs-attr">      testOnBorrow:</span> <span class="hljs-literal">false</span></span><br><span class="line"><span class="hljs-attr">      testOnReturn:</span> <span class="hljs-literal">false</span></span><br></pre></td></tr></table></figure>


<p> 4.需要调度数据库中的Job实例定义。<br>JobEntity.class</p>
<figure class="highlight typescript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line">package com.ealen.entity;</span><br><span class="line"><span class="hljs-keyword">import</span> javax.persistence.*;</span><br><span class="line"><span class="hljs-keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * Created by EalenXie on 2018/6/4 14:09</span></span><br><span class="line"><span class="hljs-comment"> * 这里个人示例,可自定义相关属性</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line"><span class="hljs-meta">@Entity</span></span><br><span class="line"><span class="hljs-meta">@Table</span>(name = <span class="hljs-string">"JOB_ENTITY"</span>)</span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> JobEntity <span class="hljs-keyword">implements</span> Serializable &#123;</span><br><span class="line">    <span class="hljs-meta">@Id</span></span><br><span class="line">    <span class="hljs-meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="hljs-keyword">private</span> Integer id;</span><br><span class="line">    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> name;          <span class="hljs-comment">//job名称</span></span><br><span class="line">    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> group;         <span class="hljs-comment">//job组名</span></span><br><span class="line">    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> cron;          <span class="hljs-comment">//执行的cron</span></span><br><span class="line">    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> parameter;     <span class="hljs-comment">//job的参数</span></span><br><span class="line">    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> description;   <span class="hljs-comment">//job描述信息</span></span><br><span class="line">    <span class="hljs-meta">@Column</span>(name = <span class="hljs-string">"vm_param"</span>)</span><br><span class="line">    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> vmParam;       <span class="hljs-comment">//vm参数</span></span><br><span class="line">    <span class="hljs-meta">@Column</span>(name = <span class="hljs-string">"jar_path"</span>)</span><br><span class="line">    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> jarPath;       <span class="hljs-comment">//job的jar路径,在这里我选择的是定时执行一些可执行的jar包</span></span><br><span class="line">    <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> status;        <span class="hljs-comment">//job的执行状态,这里我设置为OPEN/CLOSE且只有该值为OPEN才会执行该Job</span></span><br><span class="line">    <span class="hljs-keyword">public</span> JobEntity() &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">public</span> Integer getId() &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> setId(Integer id) &#123;</span><br><span class="line">        <span class="hljs-keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">String</span> getName() &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> setName(<span class="hljs-built_in">String</span> name) &#123;</span><br><span class="line">        <span class="hljs-keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">String</span> getGroup() &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> group;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> setGroup(<span class="hljs-built_in">String</span> group) &#123;</span><br><span class="line">        <span class="hljs-keyword">this</span>.group = group;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">String</span> getCron() &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> cron;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> setCron(<span class="hljs-built_in">String</span> cron) &#123;</span><br><span class="line">        <span class="hljs-keyword">this</span>.cron = cron;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">String</span> getParameter() &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> parameter;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> setParameter(<span class="hljs-built_in">String</span> parameter) &#123;</span><br><span class="line">        <span class="hljs-keyword">this</span>.parameter = parameter;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">String</span> getDescription() &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> description;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> setDescription(<span class="hljs-built_in">String</span> description) &#123;</span><br><span class="line">        <span class="hljs-keyword">this</span>.description = description;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">String</span> getVmParam() &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> vmParam;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> setVmParam(<span class="hljs-built_in">String</span> vmParam) &#123;</span><br><span class="line">        <span class="hljs-keyword">this</span>.vmParam = vmParam;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">String</span> getJarPath() &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> jarPath;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> setJarPath(<span class="hljs-built_in">String</span> jarPath) &#123;</span><br><span class="line">        <span class="hljs-keyword">this</span>.jarPath = jarPath;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">String</span> getStatus() &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> status;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> setStatus(<span class="hljs-built_in">String</span> status) &#123;</span><br><span class="line">        <span class="hljs-keyword">this</span>.status = status;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-meta">@Override</span></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">String</span> toString() &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-string">"JobEntity&#123;"</span> +</span><br><span class="line">                <span class="hljs-string">"id="</span> + id +</span><br><span class="line">                <span class="hljs-string">", name='"</span> + name + <span class="hljs-string">'\''</span> +</span><br><span class="line">                <span class="hljs-string">", group='"</span> + group + <span class="hljs-string">'\''</span> +</span><br><span class="line">                <span class="hljs-string">", cron='"</span> + cron + <span class="hljs-string">'\''</span> +</span><br><span class="line">                <span class="hljs-string">", parameter='"</span> + parameter + <span class="hljs-string">'\''</span> +</span><br><span class="line">                <span class="hljs-string">", description='"</span> + description + <span class="hljs-string">'\''</span> +</span><br><span class="line">                <span class="hljs-string">", vmParam='"</span> + vmParam + <span class="hljs-string">'\''</span> +</span><br><span class="line">                <span class="hljs-string">", jarPath='"</span> + jarPath + <span class="hljs-string">'\''</span> +</span><br><span class="line">                <span class="hljs-string">", status='"</span> + status + <span class="hljs-string">'\''</span> +</span><br><span class="line">                <span class="hljs-string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-comment">//新增Builder模式,可选,选择设置任意属性初始化对象</span></span><br><span class="line">    <span class="hljs-keyword">public</span> JobEntity(Builder builder) &#123;</span><br><span class="line">        id = builder.id;</span><br><span class="line">        name = builder.name;</span><br><span class="line">        group = builder.group;</span><br><span class="line">        cron = builder.cron;</span><br><span class="line">        parameter = builder.parameter;</span><br><span class="line">        description = builder.description;</span><br><span class="line">        vmParam = builder.vmParam;</span><br><span class="line">        jarPath = builder.jarPath;</span><br><span class="line">        status = builder.status;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> Builder &#123;</span><br><span class="line">        <span class="hljs-keyword">private</span> Integer id;</span><br><span class="line">        <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> name = <span class="hljs-string">""</span>;          <span class="hljs-comment">//job名称</span></span><br><span class="line">        <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> group = <span class="hljs-string">""</span>;         <span class="hljs-comment">//job组名</span></span><br><span class="line">        <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> cron = <span class="hljs-string">""</span>;          <span class="hljs-comment">//执行的cron</span></span><br><span class="line">        <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> parameter = <span class="hljs-string">""</span>;     <span class="hljs-comment">//job的参数</span></span><br><span class="line">        <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> description = <span class="hljs-string">""</span>;   <span class="hljs-comment">//job描述信息</span></span><br><span class="line">        <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> vmParam = <span class="hljs-string">""</span>;       <span class="hljs-comment">//vm参数</span></span><br><span class="line">        <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> jarPath = <span class="hljs-string">""</span>;       <span class="hljs-comment">//job的jar路径</span></span><br><span class="line">        <span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> status = <span class="hljs-string">""</span>;        <span class="hljs-comment">//job的执行状态,只有该值为OPEN才会执行该Job</span></span><br><span class="line">        <span class="hljs-keyword">public</span> Builder withId(Integer i) &#123;</span><br><span class="line">            id = i;</span><br><span class="line">            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">public</span> Builder withName(<span class="hljs-built_in">String</span> n) &#123;</span><br><span class="line">            name = n;</span><br><span class="line">            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">public</span> Builder withGroup(<span class="hljs-built_in">String</span> g) &#123;</span><br><span class="line">            group = g;</span><br><span class="line">            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">public</span> Builder withCron(<span class="hljs-built_in">String</span> c) &#123;</span><br><span class="line">            cron = c;</span><br><span class="line">            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">public</span> Builder withParameter(<span class="hljs-built_in">String</span> p) &#123;</span><br><span class="line">            parameter = p;</span><br><span class="line">            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">public</span> Builder withDescription(<span class="hljs-built_in">String</span> d) &#123;</span><br><span class="line">            description = d;</span><br><span class="line">            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">public</span> Builder withVMParameter(<span class="hljs-built_in">String</span> vm) &#123;</span><br><span class="line">            vmParam = vm;</span><br><span class="line">            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">public</span> Builder withJarPath(<span class="hljs-built_in">String</span> jar) &#123;</span><br><span class="line">            jarPath = jar;</span><br><span class="line">            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">public</span> Builder withStatus(<span class="hljs-built_in">String</span> s) &#123;</span><br><span class="line">            status = s;</span><br><span class="line">            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">public</span> JobEntity newJobEntity() &#123;</span><br><span class="line">            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> JobEntity(<span class="hljs-keyword">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>为了方便测试,设计好表之后先插入几条记录,job_entity.sql,相关sql语句如下: </p>
<figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">SET</span> FOREIGN_KEY_CHECKS=<span class="hljs-number">0</span>;</span><br><span class="line"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">EXISTS</span> <span class="hljs-string">`job_entity`</span>;</span><br><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-string">`job_entity`</span> (</span><br><span class="line">  <span class="hljs-string">`id`</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="hljs-string">`name`</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">  <span class="hljs-string">`group`</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">  <span class="hljs-string">`cron`</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">  <span class="hljs-string">`parameter`</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">  <span class="hljs-string">`description`</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">  <span class="hljs-string">`vm_param`</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">  <span class="hljs-string">`jar_path`</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">  <span class="hljs-string">`status`</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="hljs-keyword">KEY</span> (<span class="hljs-string">`id`</span>)</span><br><span class="line">) <span class="hljs-keyword">ENGINE</span>=<span class="hljs-keyword">InnoDB</span> AUTO_INCREMENT=<span class="hljs-number">7</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">CHARSET</span>=utf8;</span><br><span class="line"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-string">`job_entity`</span> <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'1'</span>,  <span class="hljs-string">'first'</span>, <span class="hljs-string">'helloworld'</span>, <span class="hljs-string">'0/2 * * * * ? '</span>, <span class="hljs-string">'1'</span>, <span class="hljs-string">'第一个'</span>, <span class="hljs-string">''</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">'OPEN'</span>);</span><br><span class="line"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-string">`job_entity`</span> <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'2'</span>,  <span class="hljs-string">'second'</span>, <span class="hljs-string">'helloworld'</span>, <span class="hljs-string">'0/5 * * * * ? '</span>, <span class="hljs-string">'2'</span>, <span class="hljs-string">'第二个'</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">'OPEN'</span>);</span><br><span class="line"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-string">`job_entity`</span> <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'3'</span>,  <span class="hljs-string">'third'</span>, <span class="hljs-string">'helloworld'</span>, <span class="hljs-string">'0/15 * * * * ? '</span>, <span class="hljs-string">'3'</span>, <span class="hljs-string">'第三个'</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">'OPEN'</span>);</span><br><span class="line"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-string">`job_entity`</span> <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'4'</span>,  <span class="hljs-string">'four'</span>, <span class="hljs-string">'helloworld'</span>, <span class="hljs-string">'0 0/1 * * * ? *'</span>, <span class="hljs-string">'4'</span>, <span class="hljs-string">'第四个'</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">'CLOSE'</span>);</span><br><span class="line"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-string">`job_entity`</span> <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'5'</span>,  <span class="hljs-string">'OLAY Job'</span>, <span class="hljs-string">'Nomal'</span>, <span class="hljs-string">'0 0/2 * * * ?'</span>, <span class="hljs-string">'5'</span>, <span class="hljs-string">'第五个'</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">'C:\\EalenXie\\Download\\JDE-Order-1.0-SNAPSHOT.jar'</span>, <span class="hljs-string">'CLOSE'</span>);</span><br></pre></td></tr></table></figure>

<p>Quartz的核心配置类 : ConfigureQuartz.class</p>
<figure class="highlight java hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">package</span> com.ealen.config;</span><br><span class="line"><span class="hljs-keyword">import</span> org.quartz.spi.JobFactory;</span><br><span class="line"><span class="hljs-keyword">import</span> org.quartz.spi.TriggerFiredBundle;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.beans.factory.config.AutowireCapableBeanFactory;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.beans.factory.config.PropertiesFactoryBean;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.context.ApplicationContextAware;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.core.io.ClassPathResource;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.scheduling.quartz.SchedulerFactoryBean;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.scheduling.quartz.SpringBeanJobFactory;</span><br><span class="line"><span class="hljs-keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="hljs-keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="hljs-keyword">import</span> java.util.Properties;</span><br><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * Created by EalenXie on 2018/6/4 11:02</span></span><br><span class="line"><span class="hljs-comment"> * Quartz的核心配置类</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line"><span class="hljs-meta">@Configuration</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConfigureQuartz</span> </span>&#123;</span><br><span class="line">    <span class="hljs-comment">//配置JobFactory</span></span><br><span class="line">    <span class="hljs-meta">@Bean</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> JobFactory <span class="hljs-title">jobFactory</span><span class="hljs-params">(ApplicationContext applicationContext)</span> </span>&#123;</span><br><span class="line">        AutowiringSpringBeanJobFactory jobFactory = <span class="hljs-keyword">new</span> AutowiringSpringBeanJobFactory();</span><br><span class="line">        jobFactory.setApplicationContext(applicationContext);</span><br><span class="line">        <span class="hljs-keyword">return</span> jobFactory;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment">     * SchedulerFactoryBean这个类的真正作用提供了对org.quartz.Scheduler的创建与配置，并且会管理它的生命周期与Spring同步。</span></span><br><span class="line"><span class="hljs-comment">     * org.quartz.Scheduler: 调度器。所有的调度都是由它控制。</span></span><br><span class="line"><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> dataSource 为SchedulerFactory配置数据源</span></span><br><span class="line"><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> jobFactory 为SchedulerFactory配置JobFactory</span></span><br><span class="line"><span class="hljs-comment">     */</span></span><br><span class="line">    <span class="hljs-meta">@Bean</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> SchedulerFactoryBean <span class="hljs-title">schedulerFactoryBean</span><span class="hljs-params">(DataSource dataSource, JobFactory jobFactory)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        SchedulerFactoryBean factory = <span class="hljs-keyword">new</span> SchedulerFactoryBean();</span><br><span class="line">        <span class="hljs-comment">//可选,QuartzScheduler启动时更新己存在的Job,这样就不用每次修改targetObject后删除qrtz_job_details表对应记录</span></span><br><span class="line">        factory.setOverwriteExistingJobs(<span class="hljs-keyword">true</span>);</span><br><span class="line">        factory.setAutoStartup(<span class="hljs-keyword">true</span>); <span class="hljs-comment">//设置自行启动</span></span><br><span class="line">        factory.setDataSource(dataSource);</span><br><span class="line">        factory.setJobFactory(jobFactory);</span><br><span class="line">        factory.setQuartzProperties(quartzProperties());</span><br><span class="line">        <span class="hljs-keyword">return</span> factory;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-comment">//从quartz.properties文件中读取Quartz配置属性</span></span><br><span class="line">    <span class="hljs-meta">@Bean</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> Properties <span class="hljs-title">quartzProperties</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        PropertiesFactoryBean propertiesFactoryBean = <span class="hljs-keyword">new</span> PropertiesFactoryBean();</span><br><span class="line">        propertiesFactoryBean.setLocation(<span class="hljs-keyword">new</span> ClassPathResource(<span class="hljs-string">"/quartz.properties"</span>));</span><br><span class="line">        propertiesFactoryBean.afterPropertiesSet();</span><br><span class="line">        <span class="hljs-keyword">return</span> propertiesFactoryBean.getObject();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-comment">//配置JobFactory,为quartz作业添加自动连接支持</span></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AutowiringSpringBeanJobFactory</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SpringBeanJobFactory</span> <span class="hljs-keyword">implements</span></span></span><br><span class="line"><span class="hljs-class">            <span class="hljs-title">ApplicationContextAware</span> </span>&#123;</span><br><span class="line">        <span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> AutowireCapableBeanFactory beanFactory;</span><br><span class="line">        <span class="hljs-meta">@Override</span></span><br><span class="line">        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setApplicationContext</span><span class="hljs-params">(<span class="hljs-keyword">final</span> ApplicationContext context)</span> </span>&#123;</span><br><span class="line">            beanFactory = context.getAutowireCapableBeanFactory();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-meta">@Override</span></span><br><span class="line">        <span class="hljs-function"><span class="hljs-keyword">protected</span> Object <span class="hljs-title">createJobInstance</span><span class="hljs-params">(<span class="hljs-keyword">final</span> TriggerFiredBundle bundle)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;</span><br><span class="line">            <span class="hljs-keyword">final</span> Object job = <span class="hljs-keyword">super</span>.createJobInstance(bundle);</span><br><span class="line">            beanFactory.autowireBean(job);</span><br><span class="line">            <span class="hljs-keyword">return</span> job;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>写一个dao访问数据库，JobEntityRepository.class</p>
<figure class="highlight haxe hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">package</span> com.ealen.dao;</span><br><span class="line"><span class="hljs-keyword">import</span> com.ealen.entity.JobEntity;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.data.repository.CrudRepository;</span><br><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * Created by EalenXie on 2018/6/4 14:27</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">JobEntityRepository</span> <span class="hljs-keyword"><span class="hljs-keyword">extends</span> <span class="hljs-type">CrudRepository</span></span>&lt;<span class="hljs-title">JobEntity</span>, <span class="hljs-title">Long</span>&gt; </span>&#123;</span><br><span class="line">    JobEntity getById(Integer id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>5.定义调度中心执行逻辑的Job,这个Job的作用就是按照数据库中的Job的逻辑,规则去执行数据库中的Job。<br>这里使用了一个自定义的枚举工具类StringUtils , StringUtils.class : </p>
<figure class="highlight processing hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">package</span> com.ealen.util;</span><br><span class="line"><span class="hljs-keyword">import</span> java.util.List;</span><br><span class="line"><span class="hljs-keyword">import</span> java.util.Map;</span><br><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * Created by EalenXie on 2018/6/4 14:20</span></span><br><span class="line"><span class="hljs-comment"> * 自定义枚举单例对象 StringUtil</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> StringUtils &#123;</span><br><span class="line">    getStringUtil;</span><br><span class="line">    <span class="hljs-comment">//是否为空</span></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> isEmpty(<span class="hljs-keyword">String</span> <span class="hljs-built_in">str</span>) &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> (<span class="hljs-built_in">str</span> == <span class="hljs-keyword">null</span>) || (<span class="hljs-built_in">str</span>.length() == <span class="hljs-number">0</span>) || (<span class="hljs-built_in">str</span>.equals(<span class="hljs-string">""</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-comment">//去空格</span></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-keyword">String</span> <span class="hljs-built_in">trim</span>(<span class="hljs-keyword">String</span> <span class="hljs-built_in">str</span>) &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span> == <span class="hljs-keyword">null</span> ? <span class="hljs-keyword">null</span> : <span class="hljs-built_in">str</span>.<span class="hljs-built_in">trim</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-comment">//获取Map参数值</span></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-keyword">String</span> getMapString(Map&lt;<span class="hljs-keyword">String</span>, <span class="hljs-keyword">String</span>&gt; <span class="hljs-built_in">map</span>) &#123;</span><br><span class="line">        <span class="hljs-keyword">String</span> result = <span class="hljs-string">""</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (Map.Entry entry : <span class="hljs-built_in">map</span>.entrySet()) &#123;</span><br><span class="line">            result += entry.getValue() + <span class="hljs-string">" "</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-comment">//获取List参数值</span></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-keyword">String</span> getListString(List&lt;<span class="hljs-keyword">String</span>&gt; list) &#123;</span><br><span class="line">        <span class="hljs-keyword">String</span> result = <span class="hljs-string">""</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">String</span> s : list) &#123;</span><br><span class="line">            result += s + <span class="hljs-string">" "</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>调度中心执行逻辑的Job。DynamicJob.class :  </p>
<figure class="highlight processing hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">package</span> com.ealen.job;</span><br><span class="line"><span class="hljs-keyword">import</span> com.ealen.util.StringUtils;</span><br><span class="line"><span class="hljs-keyword">import</span> org.quartz.*;</span><br><span class="line"><span class="hljs-keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="hljs-keyword">import</span> java.io.*;</span><br><span class="line"><span class="hljs-keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="hljs-keyword">import</span> java.util.List;</span><br><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * Created by EalenXie on 2018/6/4 14:29</span></span><br><span class="line"><span class="hljs-comment"> * :@DisallowConcurrentExecution : 此标记用在实现Job的类上面,意思是不允许并发执行.</span></span><br><span class="line"><span class="hljs-comment"> * :注意org.quartz.threadPool.threadCount线程池中线程的数量至少要多个,否则@DisallowConcurrentExecution不生效</span></span><br><span class="line"><span class="hljs-comment"> * :假如Job的设置时间间隔为3秒,但Job执行时间是5秒,设置@DisallowConcurrentExecution以后程序会等任务执行完毕以后再去执行,否则会在3秒时再启用新的线程执行</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line">@DisallowConcurrentExecution</span><br><span class="line">@Component</span><br><span class="line"><span class="hljs-keyword">public</span> class DynamicJob implements Job &#123;</span><br><span class="line">    <span class="hljs-keyword">private</span> Logger logger = LoggerFactory.getLogger(DynamicJob.class);</span><br><span class="line">    <span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment">     * 核心方法,Quartz Job真正的执行逻辑.</span></span><br><span class="line"><span class="hljs-comment">     * @param executorContext executorContext JobExecutionContext中封装有Quartz运行所需要的所有信息</span></span><br><span class="line"><span class="hljs-comment">     * @throws JobExecutionException execute()方法只允许抛出JobExecutionException异常</span></span><br><span class="line"><span class="hljs-comment">     */</span></span><br><span class="line">    @Override</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> execute(JobExecutionContext executorContext) <span class="hljs-keyword">throws</span> JobExecutionException &#123;</span><br><span class="line">        <span class="hljs-comment">//JobDetail中的JobDataMap是共用的,从getMergedJobDataMap获取的JobDataMap是全新的对象</span></span><br><span class="line">        JobDataMap <span class="hljs-built_in">map</span> = executorContext.getMergedJobDataMap();</span><br><span class="line">        <span class="hljs-keyword">String</span> jarPath = <span class="hljs-built_in">map</span>.getString(<span class="hljs-string">"jarPath"</span>);</span><br><span class="line">        <span class="hljs-keyword">String</span> parameter = <span class="hljs-built_in">map</span>.getString(<span class="hljs-string">"parameter"</span>);</span><br><span class="line">        <span class="hljs-keyword">String</span> vmParam = <span class="hljs-built_in">map</span>.getString(<span class="hljs-string">"vmParam"</span>);</span><br><span class="line">        logger.info(<span class="hljs-string">"Running Job name : &#123;&#125; "</span>, <span class="hljs-built_in">map</span>.getString(<span class="hljs-string">"name"</span>));</span><br><span class="line">        logger.info(<span class="hljs-string">"Running Job description : "</span> + <span class="hljs-built_in">map</span>.getString(<span class="hljs-string">"JobDescription"</span>));</span><br><span class="line">        logger.info(<span class="hljs-string">"Running Job group: &#123;&#125; "</span>, <span class="hljs-built_in">map</span>.getString(<span class="hljs-string">"group"</span>));</span><br><span class="line">        logger.info(<span class="hljs-string">"Running Job cron : "</span> + <span class="hljs-built_in">map</span>.getString(<span class="hljs-string">"cronExpression"</span>));</span><br><span class="line">        logger.info(<span class="hljs-string">"Running Job jar path : &#123;&#125; "</span>, jarPath);</span><br><span class="line">        logger.info(<span class="hljs-string">"Running Job parameter : &#123;&#125; "</span>, parameter);</span><br><span class="line">        logger.info(<span class="hljs-string">"Running Job vmParam : &#123;&#125; "</span>, vmParam);</span><br><span class="line">        <span class="hljs-keyword">long</span> startTime = System.currentTimeMillis();</span><br><span class="line">        <span class="hljs-keyword">if</span> (!StringUtils.getStringUtil.isEmpty(jarPath)) &#123;</span><br><span class="line">            File jar = <span class="hljs-keyword">new</span> File(jarPath);</span><br><span class="line">            <span class="hljs-keyword">if</span> (jar.exists()) &#123;</span><br><span class="line">                ProcessBuilder processBuilder = <span class="hljs-keyword">new</span> ProcessBuilder();</span><br><span class="line">                processBuilder.directory(jar.getParentFile());</span><br><span class="line">                List&lt;<span class="hljs-keyword">String</span>&gt; commands = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">                commands.<span class="hljs-built_in">add</span>(<span class="hljs-string">"java"</span>);</span><br><span class="line">                <span class="hljs-keyword">if</span> (!StringUtils.getStringUtil.isEmpty(vmParam)) commands.<span class="hljs-built_in">add</span>(vmParam);</span><br><span class="line">                commands.<span class="hljs-built_in">add</span>(<span class="hljs-string">"-jar"</span>);</span><br><span class="line">                commands.<span class="hljs-built_in">add</span>(jarPath);</span><br><span class="line">                <span class="hljs-keyword">if</span> (!StringUtils.getStringUtil.isEmpty(parameter)) commands.<span class="hljs-built_in">add</span>(parameter);</span><br><span class="line">                processBuilder.command(commands);</span><br><span class="line">                logger.info(<span class="hljs-string">"Running Job details as follows &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;: "</span>);</span><br><span class="line">                logger.info(<span class="hljs-string">"Running Job commands : &#123;&#125;  "</span>, StringUtils.getStringUtil.getListString(commands));</span><br><span class="line">                <span class="hljs-keyword">try</span> &#123;</span><br><span class="line">                    Process process = processBuilder.start();</span><br><span class="line">                    logProcess(process.getInputStream(), process.getErrorStream());</span><br><span class="line">                &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> JobExecutionException(e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> JobExecutionException(<span class="hljs-string">"Job Jar not found &gt;&gt;  "</span> + jarPath);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">long</span> endTime = System.currentTimeMillis();</span><br><span class="line">        logger.info(<span class="hljs-string">"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Running Job has been completed , cost time :  "</span> + (endTime - startTime) + <span class="hljs-string">"ms\n"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-comment">//打印Job执行内容的日志</span></span><br><span class="line">    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> logProcess(InputStream inputStream, InputStream errorStream) <span class="hljs-keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="hljs-keyword">String</span> inputLine;</span><br><span class="line">        <span class="hljs-keyword">String</span> errorLine;</span><br><span class="line">        <span class="hljs-keyword">BufferedReader</span> inputReader = <span class="hljs-keyword">new</span> <span class="hljs-keyword">BufferedReader</span>(<span class="hljs-keyword">new</span> InputStreamReader(inputStream));</span><br><span class="line">        <span class="hljs-keyword">BufferedReader</span> errorReader = <span class="hljs-keyword">new</span> <span class="hljs-keyword">BufferedReader</span>(<span class="hljs-keyword">new</span> InputStreamReader(errorStream));</span><br><span class="line">        <span class="hljs-keyword">while</span> ((inputLine = inputReader.readLine()) != <span class="hljs-keyword">null</span>) logger.info(inputLine);</span><br><span class="line">        <span class="hljs-keyword">while</span> ((errorLine = errorReader.readLine()) != <span class="hljs-keyword">null</span>) logger.error(errorLine);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>6.为了方便控制Job的运行，为调度中心添加相关的业务逻辑 :<br>DynamicJobService.class  :</p>
<figure class="highlight cpp hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">package com.ealen.service;</span><br><span class="line"><span class="hljs-keyword">import</span> com.ealen.dao.JobEntityRepository;</span><br><span class="line"><span class="hljs-keyword">import</span> com.ealen.entity.JobEntity;</span><br><span class="line"><span class="hljs-keyword">import</span> com.ealen.job.DynamicJob;</span><br><span class="line"><span class="hljs-keyword">import</span> org.quartz.*;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="hljs-keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="hljs-keyword">import</span> java.util.List;</span><br><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * Created by EalenXie on 2018/6/4 14:25</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line">@Service</span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DynamicJobService</span> &#123;</span></span><br><span class="line">    @Autowired</span><br><span class="line">    <span class="hljs-keyword">private</span> JobEntityRepository repository;</span><br><span class="line">    <span class="hljs-comment">//通过Id获取Job</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> JobEntity <span class="hljs-title">getJobEntityById</span><span class="hljs-params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> repository.getById(id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-comment">//从数据库中加载获取到所有Job</span></span><br><span class="line">    <span class="hljs-keyword">public</span> List&lt;JobEntity&gt; loadJobs() &#123;</span><br><span class="line">        List&lt;JobEntity&gt; <span class="hljs-built_in">list</span> = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        repository.findAll().forEach(<span class="hljs-built_in">list</span>::add);</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-built_in">list</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-comment">//获取JobDataMap.(Job参数对象)</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> JobDataMap <span class="hljs-title">getJobDataMap</span><span class="hljs-params">(JobEntity job)</span> </span>&#123;</span><br><span class="line">        JobDataMap <span class="hljs-built_in">map</span> = <span class="hljs-keyword">new</span> JobDataMap();</span><br><span class="line">        <span class="hljs-built_in">map</span>.put(<span class="hljs-string">"name"</span>, job.getName());</span><br><span class="line">        <span class="hljs-built_in">map</span>.put(<span class="hljs-string">"group"</span>, job.getGroup());</span><br><span class="line">        <span class="hljs-built_in">map</span>.put(<span class="hljs-string">"cronExpression"</span>, job.getCron());</span><br><span class="line">        <span class="hljs-built_in">map</span>.put(<span class="hljs-string">"parameter"</span>, job.getParameter());</span><br><span class="line">        <span class="hljs-built_in">map</span>.put(<span class="hljs-string">"JobDescription"</span>, job.getDescription());</span><br><span class="line">        <span class="hljs-built_in">map</span>.put(<span class="hljs-string">"vmParam"</span>, job.getVmParam());</span><br><span class="line">        <span class="hljs-built_in">map</span>.put(<span class="hljs-string">"jarPath"</span>, job.getJarPath());</span><br><span class="line">        <span class="hljs-built_in">map</span>.put(<span class="hljs-string">"status"</span>, job.getStatus());</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-built_in">map</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-comment">//获取JobDetail,JobDetail是任务的定义,而Job是任务的执行逻辑,JobDetail里会引用一个Job Class来定义</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> JobDetail <span class="hljs-title">geJobDetail</span><span class="hljs-params">(JobKey jobKey, String description, JobDataMap <span class="hljs-built_in">map</span>)</span> </span>&#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> JobBuilder.newJob(DynamicJob.class)</span><br><span class="line">                .withIdentity(jobKey)</span><br><span class="line">                .withDescription(description)</span><br><span class="line">                .setJobData(<span class="hljs-built_in">map</span>)</span><br><span class="line">                .storeDurably()</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-comment">//获取Trigger (Job的触发器,执行规则)</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> Trigger <span class="hljs-title">getTrigger</span><span class="hljs-params">(JobEntity job)</span> </span>&#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> TriggerBuilder.newTrigger()</span><br><span class="line">                .withIdentity(job.getName(), job.getGroup())</span><br><span class="line">                .withSchedule(CronScheduleBuilder.cronSchedule(job.getCron()))</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-comment">//获取JobKey,包含Name和Group</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> JobKey <span class="hljs-title">getJobKey</span><span class="hljs-params">(JobEntity job)</span> </span>&#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> JobKey.jobKey(job.getName(), job.getGroup());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>JobController.class :</p>
<figure class="highlight swift hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">package com.ealen.web;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">import</span> com.ealen.entity.JobEntity;</span><br><span class="line"><span class="hljs-keyword">import</span> com.ealen.service.DynamicJobService;</span><br><span class="line"><span class="hljs-keyword">import</span> org.quartz.*;</span><br><span class="line"><span class="hljs-keyword">import</span> org.quartz.impl.matchers.GroupMatcher;</span><br><span class="line"><span class="hljs-keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.scheduling.quartz.SchedulerFactoryBean;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.PathVariable;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">import</span> javax.annotation.PostConstruct;</span><br><span class="line"><span class="hljs-keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * Created by EalenXie on 2018/6/4 16:12</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line">@<span class="hljs-type">RestController</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JobController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> logger = <span class="hljs-type">LoggerFactory</span>.getLogger(<span class="hljs-type">JobController</span>.<span class="hljs-keyword">class</span>);</span><br><span class="line">    @<span class="hljs-type">Autowired</span></span><br><span class="line">    <span class="hljs-keyword">private</span> <span class="hljs-type">SchedulerFactoryBean</span> schedulerFactoryBean;</span><br><span class="line">    @<span class="hljs-type">Autowired</span></span><br><span class="line">    <span class="hljs-keyword">private</span> <span class="hljs-type">DynamicJobService</span> jobService;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">//初始化启动所有的Job</span></span><br><span class="line">    @<span class="hljs-type">PostConstruct</span></span><br><span class="line">    <span class="hljs-keyword">public</span> void initialize() &#123;</span><br><span class="line">        <span class="hljs-keyword">try</span> &#123;</span><br><span class="line">            reStartAllJobs();</span><br><span class="line">            logger.info(<span class="hljs-string">"INIT SUCCESS"</span>);</span><br><span class="line">        &#125; <span class="hljs-keyword">catch</span> (<span class="hljs-type">SchedulerException</span> e) &#123;</span><br><span class="line">            logger.info(<span class="hljs-string">"INIT EXCEPTION : "</span> + e.getMessage());</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">//根据ID重启某个Job</span></span><br><span class="line">    @<span class="hljs-type">RequestMapping</span>(<span class="hljs-string">"/refresh/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-type">String</span> refresh(@<span class="hljs-type">PathVariable</span> <span class="hljs-type">Integer</span> id) <span class="hljs-keyword">throws</span> <span class="hljs-type">SchedulerException</span> &#123;</span><br><span class="line">        <span class="hljs-type">String</span> result;</span><br><span class="line">        <span class="hljs-type">JobEntity</span> entity = jobService.getJobEntityById(id);</span><br><span class="line">        <span class="hljs-keyword">if</span> (entity == null) <span class="hljs-keyword">return</span> <span class="hljs-string">"error: id is not exist "</span>;</span><br><span class="line">        synchronized (logger) &#123;</span><br><span class="line">            <span class="hljs-type">JobKey</span> jobKey = jobService.getJobKey(entity);</span><br><span class="line">            <span class="hljs-type">Scheduler</span> scheduler = schedulerFactoryBean.getScheduler();</span><br><span class="line">            scheduler.pauseJob(jobKey);</span><br><span class="line">            scheduler.unscheduleJob(<span class="hljs-type">TriggerKey</span>.triggerKey(jobKey.getName(), jobKey.getGroup()));</span><br><span class="line">            scheduler.deleteJob(jobKey);</span><br><span class="line">            <span class="hljs-type">JobDataMap</span> <span class="hljs-built_in">map</span> = jobService.getJobDataMap(entity);</span><br><span class="line">            <span class="hljs-type">JobDetail</span> jobDetail = jobService.geJobDetail(jobKey, entity.getDescription(), <span class="hljs-built_in">map</span>);</span><br><span class="line">            <span class="hljs-keyword">if</span> (entity.getStatus().equals(<span class="hljs-string">"OPEN"</span>)) &#123;</span><br><span class="line">                scheduler.scheduleJob(jobDetail, jobService.getTrigger(entity));</span><br><span class="line">                result = <span class="hljs-string">"Refresh Job : "</span> + entity.getName() + <span class="hljs-string">"\t jarPath: "</span> + entity.getJarPath() + <span class="hljs-string">" success !"</span>;</span><br><span class="line">            &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">                result = <span class="hljs-string">"Refresh Job : "</span> + entity.getName() + <span class="hljs-string">"\t jarPath: "</span> + entity.getJarPath() + <span class="hljs-string">" failed ! , "</span> +</span><br><span class="line">                        <span class="hljs-string">"Because the Job status is "</span> + entity.getStatus();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">//重启数据库中所有的Job</span></span><br><span class="line">    @<span class="hljs-type">RequestMapping</span>(<span class="hljs-string">"/refresh/all"</span>)</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-type">String</span> refreshAll() &#123;</span><br><span class="line">        <span class="hljs-type">String</span> result;</span><br><span class="line">        <span class="hljs-keyword">try</span> &#123;</span><br><span class="line">            reStartAllJobs();</span><br><span class="line">            result = <span class="hljs-string">"SUCCESS"</span>;</span><br><span class="line">        &#125; <span class="hljs-keyword">catch</span> (<span class="hljs-type">SchedulerException</span> e) &#123;</span><br><span class="line">            result = <span class="hljs-string">"EXCEPTION : "</span> + e.getMessage();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-string">"refresh all jobs : "</span> + result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment">     * 重新启动所有的job</span></span><br><span class="line"><span class="hljs-comment">     */</span></span><br><span class="line">    <span class="hljs-keyword">private</span> void reStartAllJobs() <span class="hljs-keyword">throws</span> <span class="hljs-type">SchedulerException</span> &#123;</span><br><span class="line">        synchronized (logger) &#123;                                                         <span class="hljs-comment">//只允许一个线程进入操作</span></span><br><span class="line">            <span class="hljs-type">Scheduler</span> scheduler = schedulerFactoryBean.getScheduler();</span><br><span class="line">            <span class="hljs-type">Set</span>&lt;<span class="hljs-type">JobKey</span>&gt; <span class="hljs-keyword">set</span> = scheduler.getJobKeys(<span class="hljs-type">GroupMatcher</span>.anyGroup());</span><br><span class="line">            scheduler.pauseJobs(<span class="hljs-type">GroupMatcher</span>.anyGroup());                               <span class="hljs-comment">//暂停所有JOB</span></span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-type">JobKey</span> jobKey : <span class="hljs-keyword">set</span>) &#123;                                                 <span class="hljs-comment">//删除从数据库中注册的所有JOB</span></span><br><span class="line">                scheduler.unscheduleJob(<span class="hljs-type">TriggerKey</span>.triggerKey(jobKey.getName(), jobKey.getGroup()));</span><br><span class="line">                scheduler.deleteJob(jobKey);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="hljs-keyword">for</span> (<span class="hljs-type">JobEntity</span> job : jobService.loadJobs()) &#123;                               <span class="hljs-comment">//从数据库中注册的所有JOB</span></span><br><span class="line">                logger.info(<span class="hljs-string">"Job register name : &#123;&#125; , group : &#123;&#125; , cron : &#123;&#125;"</span>, job.getName(), job.getGroup(), job.getCron());</span><br><span class="line">                <span class="hljs-type">JobDataMap</span> <span class="hljs-built_in">map</span> = jobService.getJobDataMap(job);</span><br><span class="line">                <span class="hljs-type">JobKey</span> jobKey = jobService.getJobKey(job);</span><br><span class="line">                <span class="hljs-type">JobDetail</span> jobDetail = jobService.geJobDetail(jobKey, job.getDescription(), <span class="hljs-built_in">map</span>);</span><br><span class="line">                <span class="hljs-keyword">if</span> (job.getStatus().equals(<span class="hljs-string">"OPEN"</span>)) scheduler.scheduleJob(jobDetail, jobService.getTrigger(job));</span><br><span class="line">                <span class="hljs-keyword">else</span></span><br><span class="line">                    logger.info(<span class="hljs-string">"Job jump name : &#123;&#125; , Because &#123;&#125; status is &#123;&#125;"</span>, job.getName(), job.getName(), job.getStatus());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>7.现在已经完事具备,只欠东风了,写一个启动类,跑一下看看效果。</p>
<figure class="highlight d hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">package</span> com.ealen;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * Created by EalenXie on 2018/6/4 11:00</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line"><span class="hljs-keyword">@SpringBootApplication</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> QuartzApplication &#123;</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> main(String[] args) &#123;</span><br><span class="line">        SpringApplication.run(QuartzApplication.<span class="hljs-keyword">class</span>, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行效果如下 : </p>
<p>　看到这里，那么恭喜你，Quartz集群已经搭建成功了。如果部署该项目应用到多个服务器上面，Job会在多个服务器上面执行，但同一个Job只会在某个服务器上面执行，即如果服务器A在某个时间执行了某个Job,则其他服务器如B,C,D在此时间均不会执行此Job。即不会造成该Job被多次执行。</p>
<p>这里可以看到数据库中的Job已经在Quartz注册并初始化成功了。</p>
<p>这里可看到Scheduler已经在工作了，Job也已经按照cron在定时执行了。<br>执行一个包含jar的Job，看一下效果，图下已经看到JOB在正常运行了  :<br>看到Job执行完成了。</p>
<p>此时如果在数据库中手动修改某个Job的执行cron，并不会马上生效，则可以调用上面写到的业务方法，/refresh/all，则可刷新所有的Job，或/refresh/{id},刷新某个Job。</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-07-17T00:40:00.000Z">2019-07-17</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/IT/">IT</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    6 分钟 read (About 911 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/07/17/SessionAttribute/">@SessionAttribute与@SessionAttributes</a>
            
        </h1>
        <div class="content">
            <p>@SessionAttribute与@SessionAttributes</p>
<p>@SessionAttributes<br>@SessionAttributes作用于处理器类上，用于在多个请求之间传递参数，类似于Session的Attribute，但不完全一样，一般来说@SessionAttributes设置的参数只用于暂时的传递，而不是长期的保存，长期保存的数据还是要放到Session中。<br>通过@SessionAttributes注解设置的参数有3类用法：<br>（1）在视图中通过request.getAttribute或session.getAttribute获取<br>（2）在后面请求返回的视图中通过session.getAttribute或者从model中获取<br>（3）自动将参数设置到后面请求所对应处理器的Model类型参数或者有  @ModelAttribute注释的参数里面。<br>将一个参数设置到SessionAttributes中需要满足两个条件：<br>（1）在@SessionAttributes注解中设置了参数的名字或者类型<br>（2）在处理器中将参数设置到了model中。<br>@SessionAttributes用户后可以调用SessionStatus.setComplete来清除，这个方法只是清除SessionAttribute里的参数，而不会应用Session中的参数。<br>示例如下：注解@SessionAttribute中设置book、description和  types={Double}，这样值会被放到@SessionAttributes中，但Redirect跳转时就可以重新获得这些数据了，接下来操作sessionStatus.setComplete()，则会清除掉所有的数据，这样再次跳转时就无法获取数据了。  </p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">@Controller</span>  </span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">@RequestMapping(<span class="hljs-meta-string">"/book"</span>)</span>  </span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">@SessionAttributes(value =&#123;<span class="hljs-meta-string">"book"</span>,<span class="hljs-meta-string">"description"</span>&#125;,types=&#123;Double.class&#125;)</span>  </span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RedirectController</span> </span>&#123;  </span><br><span class="line"></span><br><span class="line">	<span class="hljs-meta">@RequestMapping(<span class="hljs-meta-string">"/index"</span>)</span>  </span><br><span class="line"></span><br><span class="line">	<span class="hljs-keyword">public</span> String index(Model model)&#123;  </span><br><span class="line"></span><br><span class="line">		model.addAttribute(<span class="hljs-string">"book"</span>, <span class="hljs-string">"金刚经"</span>);  </span><br><span class="line"></span><br><span class="line">		model.addAttribute(<span class="hljs-string">"description"</span>,<span class="hljs-string">"不擦擦擦擦擦擦擦车"</span>);  </span><br><span class="line"></span><br><span class="line">		model.addAttribute(<span class="hljs-string">"price"</span>, new <span class="hljs-built_in">Double</span>(<span class="hljs-string">"1000.00"</span>));  </span><br><span class="line"></span><br><span class="line">		<span class="hljs-comment">//跳转之前将数据保存到book、description和price中，因为注解@SessionAttribute中有这几个参数</span></span><br><span class="line"></span><br><span class="line">		<span class="hljs-keyword">return</span> <span class="hljs-string">"redirect:get.action"</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">	<span class="hljs-meta">@RequestMapping(<span class="hljs-meta-string">"/get"</span>)</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">public</span> String <span class="hljs-keyword">get</span>(<span class="hljs-meta">@ModelAttribute</span> (<span class="hljs-string">"book"</span>) String book,ModelMap model,</span><br><span class="line"></span><br><span class="line">			SessionStatus sessionStatus)&#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">		<span class="hljs-comment">//可以获得book、description和price的参数</span></span><br><span class="line"></span><br><span class="line">		        System.<span class="hljs-keyword">out</span>.println(model.<span class="hljs-keyword">get</span>(<span class="hljs-string">"book"</span>)+<span class="hljs-string">";"</span>+model.<span class="hljs-keyword">get</span>(<span class="hljs-string">"description"</span>)+<span class="hljs-string">";"</span>+model.<span class="hljs-keyword">get</span>(<span class="hljs-string">"price"</span>));</span><br><span class="line"></span><br><span class="line">		sessionStatus.setComplete();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">		<span class="hljs-keyword">return</span> <span class="hljs-string">"redirect:complete.action"</span>;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="hljs-meta">@RequestMapping(<span class="hljs-meta-string">"/complete"</span>)</span></span><br><span class="line"></span><br><span class="line">	<span class="hljs-keyword">public</span> String complete(ModelMap modelMap)&#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">		<span class="hljs-comment">//已经被清除，无法获取book的值</span></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">		System.<span class="hljs-keyword">out</span>.println(modelMap.<span class="hljs-keyword">get</span>(<span class="hljs-string">"book"</span>));</span><br><span class="line"></span><br><span class="line">		modelMap.addAttribute(<span class="hljs-string">"book"</span>, <span class="hljs-string">"妹纸"</span>);</span><br><span class="line"></span><br><span class="line">		<span class="hljs-keyword">return</span> <span class="hljs-string">"sessionAttribute"</span>;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>@SessionAttribute<br>① 使用@SessionAttribute来访问预先存在的全局会话属性<br>  如果你需要访问预先存在的、以全局方式管理的会话属性的话，比如在控制器之外（比如通过过滤器）可能或不可能存在在一个方法参数上使用注解<br>  <figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">  <span class="hljs-meta">@SessionAttribute</span>：  </span><br><span class="line"></span><br><span class="line">  <span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"></span></span><br><span class="line"><span class="hljs-comment"></span></span><br><span class="line"><span class="hljs-comment"></span></span><br><span class="line"><span class="hljs-comment">     * 在处理请求 /helloWorld/jump 的时候，会在会话中添加一个 sessionStr 属性。</span></span><br><span class="line"><span class="hljs-comment"></span></span><br><span class="line"><span class="hljs-comment"></span></span><br><span class="line"><span class="hljs-comment"></span></span><br><span class="line"><span class="hljs-comment">     * &lt;p/&gt;</span></span><br><span class="line"><span class="hljs-comment"></span></span><br><span class="line"><span class="hljs-comment"></span></span><br><span class="line"><span class="hljs-comment"></span></span><br><span class="line"><span class="hljs-comment">     * 这里可以通过<span class="hljs-doctag">@SessionAttribute</span> 获取到</span></span><br><span class="line"><span class="hljs-comment"></span></span><br><span class="line"><span class="hljs-comment"></span></span><br><span class="line"><span class="hljs-comment"></span></span><br><span class="line"><span class="hljs-comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-meta">@RequestMapping(<span class="hljs-meta-string">"/sesAttr"</span>)</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">public</span> String handleSessionAttr(<span class="hljs-meta">@SessionAttribute(value = <span class="hljs-meta-string">"sessionStr"</span>)</span> String sessionStr, Model model)</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"--&gt; sessionStr : "</span> + sessionStr);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">        model.addAttribute(<span class="hljs-string">"sth"</span>, sessionStr);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-string">"/examples/targets/test1"</span>;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>为了使用这些需要添加或移除会话属性的情况，考虑注入org.springframework.web.context.request.WebRequest或javax.servlet.http.HttpSession到一个控制器方法中。<br>  对于暂存在会话中的用作控制器工作流一部分的模型属性，要像“使用 @SessionAttributes 存储模型属性到请求共享的HTTP会话”一节中描述的那样使用SessionAttributes。<br>@RequestAttribute<br>② 使用@RequestAttribute访问请求属性<br>就像@SessionAttribute一样，注解@RequestAttribute可以被用于访问由过滤器或拦截器创建的、预先存在的请求属性：</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">@RequestMapping(<span class="hljs-meta-string">"/reqAttr"</span>)</span></span><br><span class="line"></span><br><span class="line">   <span class="hljs-keyword">public</span> String handle(<span class="hljs-meta">@RequestAttribute(<span class="hljs-meta-string">"reqStr"</span>)</span> String str, Model model)</span><br><span class="line"></span><br><span class="line">   &#123;</span><br><span class="line"></span><br><span class="line">       System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"--&gt; reqStr : "</span> + str);</span><br><span class="line"></span><br><span class="line">       model.addAttribute(<span class="hljs-string">"sth"</span>, str);</span><br><span class="line"></span><br><span class="line">       <span class="hljs-keyword">return</span> <span class="hljs-string">"/examples/targets/test1"</span>;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>可以使用下面的过滤器进行测试：</p>
<figure class="highlight java hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">@WebFilter</span>(filterName = <span class="hljs-string">"myFilter"</span>, description = <span class="hljs-string">"测试过滤器"</span>, urlPatterns = &#123; <span class="hljs-string">"/*"</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyFilter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Filter</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-meta">@Override</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(FilterConfig filterConfig)</span> <span class="hljs-keyword">throws</span> ServletException</span></span><br><span class="line"><span class="hljs-function"></span></span><br><span class="line"><span class="hljs-function">    </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-meta">@Override</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doFilter</span><span class="hljs-params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="hljs-keyword">throws</span> IOException, ServletException</span></span><br><span class="line"><span class="hljs-function"></span></span><br><span class="line"><span class="hljs-function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="hljs-string">"--&gt; MyFilter Do."</span>);</span><br><span class="line"></span><br><span class="line">        request.setAttribute(<span class="hljs-string">"reqStr"</span>, <span class="hljs-string">"万万没想到，啦啦啦啦啦！"</span>);        </span><br><span class="line"></span><br><span class="line">        chain.doFilter(request, response);        </span><br><span class="line"></span><br><span class="line">    &#125;    </span><br><span class="line"></span><br><span class="line">    <span class="hljs-meta">@Override</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">destroy</span><span class="hljs-params">()</span> </span>&#123;&#125;    </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-07-16T23:07:00.000Z">2019-07-16</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/IT/">IT</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    1 分钟 read (About 146 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/07/17/annotation-ParameterizedTpye/">annotation ParameterizedTpye</a>
            
        </h1>
        <div class="content">
            <figure class="highlight typescript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Map&lt;<span class="hljs-built_in">String</span>,Mapper&gt; loadMapperAnnotation(<span class="hljs-built_in">String</span> daoClassPath)&#123;</span><br><span class="line">    <span class="hljs-comment">//得到dao接口的字节码对象</span></span><br><span class="line">    Class daoClass = Class.forName(daoClassPath);</span><br><span class="line">    <span class="hljs-comment">//得到dao接口中的方法数组</span></span><br><span class="line">    Method[] methods = daoClass.getMethods();</span><br><span class="line">    <span class="hljs-keyword">for</span>(Method method : methods)&#123;</span><br><span class="line">    <span class="hljs-comment">//取出注解的属性值  </span></span><br><span class="line">    Select xxxAnno = method.getAnnotation(xxx.class);  </span><br><span class="line">    <span class="hljs-built_in">String</span> queryString = xxxAnno.value();  </span><br><span class="line">    mapper.setQueryString(queryString);  </span><br><span class="line">    <span class="hljs-comment">//获取返回值的泛型类型  </span></span><br><span class="line">    Type <span class="hljs-keyword">type</span> = method.getGenericReturnType();  </span><br><span class="line">    <span class="hljs-comment">//判断type是不是参数化的类型  </span></span><br><span class="line">    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">type</span> <span class="hljs-keyword">instanceof</span> ParamerizedType)&#123;  </span><br><span class="line">       <span class="hljs-comment">//强转  </span></span><br><span class="line">       ParamerizedType ptype = (ParamerizedType)<span class="hljs-keyword">type</span>;  </span><br><span class="line">       <span class="hljs-comment">//参数化类型获取真实类型  </span></span><br><span class="line">       Type[] types = ptype.getActualTypeArguments();  </span><br><span class="line">       <span class="hljs-comment">//取出第一个  </span></span><br><span class="line">       Class domainClass = (Class)types[<span class="hljs-number">0</span>];  </span><br><span class="line">       <span class="hljs-built_in">String</span> resultType = domainClass.getName();  </span><br><span class="line">       mapper.setResultType(resultType);  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="hljs-built_in">String</span> methodName = method.getName();  </span><br><span class="line">    <span class="hljs-built_in">String</span> ClassName = method.getDeclaringClass().getName();  </span><br><span class="line">    <span class="hljs-built_in">String</span> key = className + <span class="hljs-string">"."</span> + methodName;  </span><br><span class="line">    mappers.put(key,mapper);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-07-16T18:50:00.000Z">2019-07-16</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/IT/">IT</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    13 分钟 read (About 1981 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/07/17/spring-task-scheduled/">spring task @scheduled</a>
            
        </h1>
        <div class="content">
            <p>Spring 4.x Task 和 Schedule 概述<br>摘要<br>在很多业务场景中，系统都需要用到任务调度系统。例如定期地清理Redis 缓存，周期性地检索某一条件并更新系统的资源等。在现代的应用系统中，快速地响应用户的请求，是用户体验最主要的因素之一。因此在Web 系统中异步地执行任务，也会在很多场景中经常涉及到。本文对任务调度和异步执行的Java 实现进行了总结，主要讲述一下内容：<br>Java 对异步执行和任务调度的支持<br>Spring 4.X 的异步执行和任务调度实现<br>Java 对异步执行和任务调度的支持<br>异步执行和任务调度底层的语言支撑都是Java 的多线程技术。线程是系统进行独立运行和调度的基本单位。拥有了多线程，系统就拥有了同时处理多项任务的能力。<br>Java 实现异步调用<br>在Java 中要实现多线程有实现Runnable 接口和扩展Thread 类两种方式。只要将需要异步执行的任务放在run() 方法中，在主线程中启动要执行任务的子线程就可以实现任务的异步执行。如果需要实现基于时间点触发的任务调度，就需要在子线程中循环的检查系统当前的时间跟触发条件是否一致，然后触发任务的执行。该内容属于Java 多线程的基础知识，此处略过不讲。<br>Java Timer 和 TimeTask 实现任务调度<br>为了便于开发者快速地实现任务调度，Java JDK 对任务调度的功能进行了封装，实现了Timer 和TimerTask 两个工具类。<br>TimerTask 类<br>由上图，我们可以看出TimeTask 抽象类在实现Runnable 接口的基础上增加了任务cancel() 和任务scheduledExecuttionTime() 两个方法。<br>Timer 类<br>上图为调度类Timer 的实现。从Timer类的源码，可以看到其采用TaskQueue 来实现对多个TimeTask 的管理。TimerThread 集成自Thread 类，其mainLoop() 用来对任务进行调度。而Timer 类提供了四种重载的schedule() 方法和重载了两种sheduleAtFixedRate() 方法来实现几种基本的任务调度类型。下面的代码是采用Timer 实现的定时系统时间打印程序。</p>
<figure class="highlight scala hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PrintTimeTask</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">TimerTask</span> </span>&#123;</span><br><span class="line">    <span class="hljs-meta">@Override</span></span><br><span class="line">        public void run() &#123;</span><br><span class="line">            <span class="hljs-type">System</span>.out.println(<span class="hljs-keyword">new</span> <span class="hljs-type">Date</span>().toString());</span><br><span class="line">        &#125;</span><br><span class="line">                    </span><br><span class="line">    public static void main(<span class="hljs-type">String</span>[] args) &#123;</span><br><span class="line">        <span class="hljs-type">Timer</span> timer = <span class="hljs-keyword">new</span> <span class="hljs-type">Timer</span>(<span class="hljs-string">"hello"</span>);</span><br><span class="line">        timer.schedule(<span class="hljs-keyword">new</span> <span class="hljs-type">PrintTimeTask</span>(), <span class="hljs-number">1000</span>L, <span class="hljs-number">2000</span>L);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Spring 4.x 中的异步执行和任务调度<br>Spring 4.x 中的异步执行<br>Spring 作为一站式框架，为开发者提供了异步执行和任务调度的抽象接口TaskExecutor 和TaskScheduler。Spring 对这些接口的实现类支持线程池(Thread Pool) 和代理。<br>Spring 提供了对JDK 中Timer和开源的流行任务调度框架Quartz的支持。Spring 通过将关联的Schedule 转化为FactoryBean 来实现。通过Spring 调度框架，开发者可以快速地通过MethodInvokingFactoryBean 来实现将POJO 类的方法转化为任务。<br>Spring TaskExecutor<br>TaskExecutor 接口扩展自java.util.concurrent.Executor 接口。TaskExecutor 被创建来为其他组件提供线程池调用的抽象。<br>ThreadPoolTaskExecutor 是TaskExecutor 的最主要实现类之一。该类的核心继承关系如下图所示。<br>ThreadPooltaskexecutor 类<br>ThreadPoolTaskExecutor 接口扩展了重多的接口，让其具备了更多的能力。要实现异步需要标注@Async 注解：<br>AsyncTaskExecutor 增加了返回结果为Future 的submit() 方法，该方法的参数为Callable 接口。相比Runnable 接口，多了将执行结果返回的功能。<br>AsyncListenableTaskExecutor 接口允许返回拥有回调功能的ListenableFuture 接口，这样在结果执行完毕是，能够直接回调处理。  </p>
<figure class="highlight java hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListenableTask</span> </span>&#123;</span><br><span class="line">    <span class="hljs-meta">@Async</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> ListenableFuture&lt;Integer&gt; <span class="hljs-title">compute</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> sum = <span class="hljs-number">0</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            sum += i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> AsyncResult&lt;&gt;(sum);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CallBackImpl</span> <span class="hljs-keyword">implements</span> </span></span><br><span class="line"><span class="hljs-class">        <span class="hljs-title">ListenableFutureCallback</span>&lt;<span class="hljs-title">Integer</span>&gt; </span>&#123;</span><br><span class="line">        <span class="hljs-meta">@Override</span></span><br><span class="line">        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onFailure</span><span class="hljs-params">(Throwable ex)</span> </span>&#123;</span><br><span class="line">            System.out.println(ex.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="hljs-meta">@Override</span></span><br><span class="line">        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onSuccess</span><span class="hljs-params">(Integer result)</span> </span>&#123;</span><br><span class="line">            System.out.println(result);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ListenableTask listenableTask = <span class="hljs-keyword">new</span> ListenableTask();</span><br><span class="line">        ListenableFuture&lt;Integer&gt; listenableFuture = </span><br><span class="line">            listenableTask.compute(<span class="hljs-number">10</span>);</span><br><span class="line">        listenableFuture.addCallback(<span class="hljs-keyword">new</span> CallBackImpl());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ThreadFactory 定义了创建线程的工厂方法，可以扩展该方法实现对Thread 的改造。<br>基于Java Config<br>基于注解 当采用基于Java Config 注解配置时，只需要在主配置添加@EnableAsync 注解，Spring 会自动的创建基于ThreadPoolTaskExecutor 实例注入到上下文中。</p>
<figure class="highlight less hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-variable">@Configuration</span></span><br><span class="line"><span class="hljs-variable">@EnableAsync</span></span><br><span class="line">public class AppConfig &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>基于AsyncConfigurer接口自定义 开发者可以自定义Executor 的类型，并且注册异常处理器。</p>
<figure class="highlight java hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">@Configuration</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TaskConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AsyncConfigurer</span> </span>&#123;</span><br><span class="line">    <span class="hljs-meta">@Override</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> Executor <span class="hljs-title">getAsyncExecutor</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">        ThreadPoolTaskExecutor executor = <span class="hljs-keyword">new</span> ThreadPoolTaskExecutor();</span><br><span class="line">        executor.setMaxPoolSize(<span class="hljs-number">100</span>);</span><br><span class="line">        executor.setCorePoolSize(<span class="hljs-number">10</span>);</span><br><span class="line">        <span class="hljs-keyword">return</span> executor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-meta">@Override</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> AsyncUncaughtExceptionHandler <span class="hljs-title">getAsyncUncaughtExceptionHandler</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> AsyncUncaughtExceptionHandler() &#123;</span><br><span class="line">            <span class="hljs-meta">@Override</span></span><br><span class="line">            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleUncaughtException</span><span class="hljs-params">(Throwable ex, </span></span></span><br><span class="line"><span class="hljs-function"><span class="hljs-params">                                                Method method, Object... params)</span> </span>&#123;</span><br><span class="line">                System.out.println(ex.getMessage());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>基于XML Config<br>基于传统XML的配置 基于XML 的形式，采用传统的Java Bean的形式配置ThreadPoolTaskExecutor。然后采用自动注入(autowire, resource,name)的可以直接在Spring Component 中注入Executor。以编程的形式实现异步任务。</p>
<figure class="highlight applescript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean <span class="hljs-built_in">id</span>=<span class="hljs-string">"taskExecutor"</span> <span class="hljs-built_in">class</span>=<span class="hljs-string">"org.springframework.scheduling.concurrent.</span></span><br><span class="line"><span class="hljs-string">    ThreadPoolTaskExecutor"</span>&gt;</span><br><span class="line">    &lt;<span class="hljs-keyword">property</span> <span class="hljs-built_in">name</span>=<span class="hljs-string">"corePoolSize"</span> value=<span class="hljs-string">"5"</span> /&gt;</span><br><span class="line">    &lt;<span class="hljs-keyword">property</span> <span class="hljs-built_in">name</span>=<span class="hljs-string">"maxPoolSize"</span> value=<span class="hljs-string">"10"</span> /&gt;</span><br><span class="line">    &lt;<span class="hljs-keyword">property</span> <span class="hljs-built_in">name</span>=<span class="hljs-string">"queueCapacity"</span> value=<span class="hljs-string">"25"</span> /&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<p>基于task 命名空间的配置 Spring 为任务的执行提供了便利的task 命名空间。当采用基于XML 配置时Spring 会自动地为开发者创建Executor。同时可以在annotation-driven 标签上注册实现了AsyncUncaughtExceptionHandler 接口的异常处理器。</p>
<figure class="highlight routeros hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--<span class="hljs-built_in"> config </span>exception handler  --&gt;</span><br><span class="line">&lt;bean <span class="hljs-attribute">id</span>=<span class="hljs-string">"taskAsyncExceptionHandler"</span> <span class="hljs-attribute">class</span>=<span class="hljs-string">"org.zzy.spring4.application.schedulie.TaskAsyncExceptionHandler"</span>/&gt;</span><br><span class="line">&lt;task:annotation-driven <span class="hljs-attribute">exception-handler</span>=<span class="hljs-string">"taskAsyncExceptionHandler"</span> <span class="hljs-attribute">scheduler</span>=<span class="hljs-string">"scheduler"</span> <span class="hljs-attribute">executor</span>=<span class="hljs-string">"executor"</span>/&gt;</span><br></pre></td></tr></table></figure>

<p>异步执行的异常处理<br>除了上文提到的两种异常处理方式，Spring 还提供了基于SimpleApplicationEventMulticaster 类的异常处理方式。</p>
<figure class="highlight aspectj hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">@Bean</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-function">SimpleApplicationEventMulticaster <span class="hljs-title">eventMulticaster</span><span class="hljs-params">(TaskExecutor taskExecutor)</span> </span>&#123;</span><br><span class="line">    SimpleApplicationEventMulticaster eventMulticaster = <span class="hljs-keyword">new</span> SimpleApplicationEventMulticaster();</span><br><span class="line">    eventMulticaster.setTaskExecutor(taskExecutor);</span><br><span class="line">    eventMulticaster.setErrorHandler(<span class="hljs-keyword">new</span> ErrorHandler() &#123;</span><br><span class="line">        <span class="hljs-meta">@Override</span></span><br><span class="line">        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">handleError</span><span class="hljs-params">(Throwable t)</span> </span>&#123;</span><br><span class="line">            System.out.println(t.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="hljs-keyword">return</span> eventMulticaster;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Spring 4.x 中任务调度实现<br>Spring 的任务调度主要基于TaskScheduler 接口。ThreadPoolTaskScheduler 是Spring 任务调度的核心实现类。该类提供了大量的重载方法进行任务调度。Trigger 定义了任务被执行的触发条件。Spring 提供了基于Corn 表达式的CornTrigger实现。TaskScheduler 如下图所示。</p>
<p>ThreadPoolTaskExecutor 类<br>实现TaskScheduler 接口的ThreadPoolTaskExecutor 继承关系。</p>
<p>ThreadPoolTaskExecutor 类<br>基于Java Config<br>基于注解的配置 当采用基于Java Config 注解配置时，只需要在主配置添加@EnableScheduling 注解，Spring 会自动的创建基于ThreadPoolTaskExecutor 实例注入到上下文中。</p>
<figure class="highlight less hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-variable">@Configuration</span></span><br><span class="line"><span class="hljs-variable">@EnableScheduling</span></span><br><span class="line">public class AppConfig &#123;</span><br><span class="line">&#125;</span><br><span class="line">基于SchedulingConfigurer接口自定义</span><br><span class="line"><span class="hljs-variable">@Configuration</span></span><br><span class="line">public class ScheduleConfig implements SchedulingConfigurer &#123;</span><br><span class="line">    <span class="hljs-variable">@Override</span></span><br><span class="line">    public void configureTasks(ScheduledTaskRegistrar taskRegistrar) &#123;</span><br><span class="line">        <span class="hljs-selector-tag">taskRegistrar</span><span class="hljs-selector-class">.setTaskScheduler</span>(new ThreadPoolTaskScheduler());</span><br><span class="line">        <span class="hljs-selector-tag">taskRegistrar</span><span class="hljs-selector-class">.getScheduler</span>()<span class="hljs-selector-class">.schedule</span>(new Runnable() &#123;</span><br><span class="line">            <span class="hljs-variable">@Override</span></span><br><span class="line">            public void run() &#123;</span><br><span class="line">                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"hello"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="hljs-selector-tag">new</span> <span class="hljs-selector-tag">CronTrigger</span>(<span class="hljs-string">"0 15 9-17 * * MON-FRI"</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>基于XML Config<br>&lt;task:annotation-driven scheduler=”myScheduler”/&gt;<br>&lt;task:scheduler id=”myScheduler” pool-size=”10”/&gt;<br>@Scheduled 注解的使用<br>当某个Bean 由Spring 管理生命周期时，就可以方便的使用@Shcheduled 注解将该Bean 的方法准换为基于任务调度的策略。</p>
<figure class="highlight smali hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Scheduled(initialDelay=1000, fixedRate=5000)</span><br><span class="line">public void doSomething() &#123;</span><br><span class="line">    // something that should<span class="hljs-built_in"> execute </span>periodically</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Scheduled(cron=<span class="hljs-string">"*/5 * * * * MON-FRI"</span>)</span><br><span class="line">public void doSomething() &#123;</span><br><span class="line">    // something that should<span class="hljs-built_in"> execute </span>on weekdays only</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>task 命名空间中的task:scheduled-tasks<br>该元素能够实现快速地将一个普通Bean 的方法转换为Scheduled 任务的途径。具体如下：</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="hljs-keyword">task</span>:scheduled-tasks scheduler=<span class="hljs-string">"myScheduler"</span>&gt;</span><br><span class="line">    &lt;<span class="hljs-keyword">task</span>:scheduled <span class="hljs-keyword">ref</span>=<span class="hljs-string">"beanA"</span> method=<span class="hljs-string">"methodA"</span> fixed-delay=<span class="hljs-string">"5000"</span> <span class="hljs-keyword">initial</span>-delay=<span class="hljs-string">"1000"</span>/&gt;</span><br><span class="line">    &lt;<span class="hljs-keyword">task</span>:scheduled <span class="hljs-keyword">ref</span>=<span class="hljs-string">"beanB"</span> method=<span class="hljs-string">"methodB"</span> fixed-rate=<span class="hljs-string">"5000"</span>/&gt;</span><br><span class="line">    &lt;<span class="hljs-keyword">task</span>:scheduled <span class="hljs-keyword">ref</span>=<span class="hljs-string">"beanC"</span> method=<span class="hljs-string">"methodC"</span> cron=<span class="hljs-string">"*/5 * * * * MON-FRI"</span>/&gt;</span><br><span class="line">&lt;/<span class="hljs-keyword">task</span>:scheduled-tasks&gt;</span><br><span class="line">&lt;<span class="hljs-keyword">task</span>:scheduler id=<span class="hljs-string">"myScheduler"</span> pool-size=<span class="hljs-string">"10"</span>/&gt;</span><br></pre></td></tr></table></figure>

<p>总结<br>本文着重介绍了JDK 为任务调度提供的基础类Timer。并在此基础上详细介绍了Spring 4.x 的异步执行和任务调度的底层接口设计。并针对常用的模式进行了讲解，并附带了源代码。第三方开源的Quartz 实现了更为强大的任务调度系统，Spring 也对集成Quartz 提供了转换。之后会择机再详细的介绍Quartz 的应用和设计原理。同时，Servlet 3.x 为Web 的异步调用提供了AsyncContext，对基于Web 的异步调用提供了原生的支持，后续的文章也会对此有相应的介绍。</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-07-16T18:39:00.000Z">2019-07-16</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/IT/">IT</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    4 分钟 read (About 663 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/07/17/spring-task/">spring task</a>
            
        </h1>
        <div class="content">
            <p>基于Spring Task的定时任务调度器实现<br>在很多时候，我们会需要执行一些定时任务 ，Spring团队提供了Spring Task模块对定时任务的调度提供了支持，基于注解式的任务使用也非常方便。<br>只要跟需要定时执行的方法加上类似 @Scheduled(cron = “0 1 * *  *  *”) 的注解就可以实现方法的定时执行。<br>cron 是一种周期的表达式，六位从右至左分别对应的是年、月、日、时、分、秒，数字配合各种通配符可以表达种类丰富的定时执行周期。  </p>
<figure class="highlight dart hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"><span class="hljs-markdown">/**</span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown"><span class="hljs-bullet">* </span>Cron Example patterns:</span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown"><span class="hljs-bullet">* </span><span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span></span>"0 0 <span class="hljs-bullet">* *</span> <span class="hljs-bullet">* *</span>" = </span>the<span class="hljs-markdown"> top of every hour of every day.<span class="hljs-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span></span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown"><span class="hljs-bullet">* </span><span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span></span>"0 0 8-10 <span class="hljs-bullet">* *</span> *" = 8, 9 and 10 o'clock of every day.<span class="hljs-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span></span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown"><span class="hljs-bullet">* </span><span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span></span>"0 0/30 8-10 <span class="hljs-bullet">* *</span> *" = 8:00, 8:30, 9:00, 9:30 and 10 o'clock every day.<span class="hljs-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span></span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown"><span class="hljs-bullet">* </span><span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span></span>"0 0 9-17 <span class="hljs-bullet">* *</span> MON-FRI" = on </span>the<span class="hljs-markdown"> hour nine-to-five weekdays<span class="hljs-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span></span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown"><span class="hljs-bullet">* </span><span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span></span>"0 0 0 25 12 ?" = every Christmas Day at midnight<span class="hljs-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span></span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown">*/</span></span></span><br><span class="line">基于注解的使用案列：</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.stereotype.Component; </span><br><span class="line">   </span><br><span class="line"><span class="hljs-meta">@Component</span>(“task”) </span><br><span class="line">public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Task</span> </span>&#123; </span><br><span class="line">    <span class="hljs-meta">@Scheduled</span>(cron = <span class="hljs-string">"0 1 * * * *"</span>)  <span class="hljs-comment">// 每分钟执行一次</span></span><br><span class="line">    public <span class="hljs-keyword">void</span> job1() &#123; </span><br><span class="line">        System.out.println(“任务进行中。。。”); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>基于注解方式的定时任务，启动会依赖于系统的启动。如果需要通过代码或前台操作触发定时任务，就需要进行包装了。<br>下面是一个可以直接提供业务代码调用的定时任务调度器。调用 schedule(Runnable task, String cron) 传入要执行的任务<br>task和定时周期cron就可以了。注：基于注解方式需要在注解扫描范围内。</p>
<figure class="highlight dart hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">package com.louis.merak.schedule;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.beans.<span class="hljs-keyword">factory</span>.annotation.Autowired;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.scheduling.concurrent.ThreadPoolTaskScheduler;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.scheduling.support.CronTrigger;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"> </span><br><span class="line"><span class="hljs-meta">@Component</span></span><br><span class="line">public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MerakTaskScheduler</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="hljs-meta">@Autowired</span></span><br><span class="line">    private ThreadPoolTaskScheduler threadPoolTaskScheduler;</span><br><span class="line">     </span><br><span class="line">    <span class="hljs-meta">@Bean</span></span><br><span class="line">    public ThreadPoolTaskScheduler threadPoolTaskScheduler()&#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ThreadPoolTaskScheduler();</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="hljs-comment"><span class="hljs-markdown">/**</span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown"><span class="hljs-bullet">     * </span>Cron Example patterns:</span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown"><span class="hljs-bullet">     * </span><span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span></span>"0 0 <span class="hljs-bullet">* *</span> <span class="hljs-bullet">* *</span>" = </span>the<span class="hljs-markdown"> top of every hour of every day.<span class="hljs-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span></span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown"><span class="hljs-bullet">     * </span><span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span></span>"0 0 8-10 <span class="hljs-bullet">* *</span> *" = 8, 9 and 10 o'clock of every day.<span class="hljs-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span></span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown"><span class="hljs-bullet">     * </span><span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span></span>"0 0/30 8-10 <span class="hljs-bullet">* *</span> *" = 8:00, 8:30, 9:00, 9:30 and 10 o'clock every day.<span class="hljs-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span></span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown"><span class="hljs-bullet">     * </span><span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span></span>"0 0 9-17 <span class="hljs-bullet">* *</span> MON-FRI" = on </span>the<span class="hljs-markdown"> hour nine-to-five weekdays<span class="hljs-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span></span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown"><span class="hljs-bullet">     * </span><span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span></span>"0 0 0 25 12 ?" = every Christmas Day at midnight<span class="hljs-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span></span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown"><span class="hljs-code">     */</span></span></span></span><br><span class="line">    public <span class="hljs-keyword">void</span> schedule(Runnable task, <span class="hljs-built_in">String</span> cron)&#123;</span><br><span class="line">        <span class="hljs-keyword">if</span>(cron == <span class="hljs-keyword">null</span> || <span class="hljs-string">""</span>.equals(cron)) &#123;</span><br><span class="line">            cron = <span class="hljs-string">"0 * * * * *"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        threadPoolTaskScheduler.schedule(task, <span class="hljs-keyword">new</span> CronTrigger(cron));</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="hljs-comment"><span class="hljs-markdown">/**</span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown"><span class="hljs-bullet">     * </span>shutdown and init</span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown"><span class="hljs-bullet">     * </span>@param task</span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown"><span class="hljs-bullet">     * </span>@param cron</span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown"><span class="hljs-code">     */</span></span></span></span><br><span class="line">    public <span class="hljs-keyword">void</span> reset()&#123;</span><br><span class="line">        threadPoolTaskScheduler.shutdown();</span><br><span class="line">        threadPoolTaskScheduler.initialize();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="hljs-comment"><span class="hljs-markdown">/**</span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown"><span class="hljs-bullet">     * </span>shutdown before </span>a<span class="hljs-markdown"> new schedule operation</span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown"><span class="hljs-bullet">     * </span>@param task</span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown"><span class="hljs-bullet">     * </span>@param cron</span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown"><span class="hljs-code">     */</span></span></span></span><br><span class="line">    public <span class="hljs-keyword">void</span> resetSchedule(Runnable task, <span class="hljs-built_in">String</span> cron)&#123;</span><br><span class="line">        shutdown();</span><br><span class="line">        threadPoolTaskScheduler.initialize();</span><br><span class="line">        schedule(task, cron);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="hljs-comment"><span class="hljs-markdown">/**</span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown"><span class="hljs-bullet">     * </span>shutdown</span></span></span><br><span class="line"><span class="hljs-comment"><span class="hljs-markdown"><span class="hljs-code">     */</span></span></span></span><br><span class="line">    public <span class="hljs-keyword">void</span> shutdown()&#123;</span><br><span class="line">        threadPoolTaskScheduler.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>如果是需要通过前台操作调用RESTful执行定时任务的调度，使用以下Controller即可。</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">package</span> com.louis.merak.common.schedule;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="hljs-keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.beans.factory.<span class="hljs-keyword">annotation</span>.Autowired;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.web.bind.<span class="hljs-keyword">annotation</span>.RequestMapping;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.web.bind.<span class="hljs-keyword">annotation</span>.RequestParam;</span><br><span class="line"><span class="hljs-keyword">import</span> org.springframework.web.bind.<span class="hljs-keyword">annotation</span>.RestController;</span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">@RestController</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MerakTaskSchedulerController</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="hljs-meta">@Autowired</span></span><br><span class="line">    MerakTaskScheduler taskScheduler;</span><br><span class="line">    </span><br><span class="line">    <span class="hljs-meta">@RequestMapping(<span class="hljs-meta-string">"/schedule"</span>)</span></span><br><span class="line">    <span class="hljs-keyword">public</span> String schedule(<span class="hljs-meta">@RequestParam</span> String cron) &#123;</span><br><span class="line">　　　　 <span class="hljs-keyword">if</span>(cron == <span class="hljs-literal">null</span>) &#123;</span><br><span class="line">　　　　　　 cron = <span class="hljs-string">"0/5 * * * * *"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Runnable runnable = new Runnable() &#123;</span><br><span class="line">            <span class="hljs-keyword">public</span> void run() &#123;</span><br><span class="line">                String time = new SimpleDateFormat(<span class="hljs-string">"yy-MM-dd HH:mm:ss"</span>).format(new Date());</span><br><span class="line">                System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"Test GETaskScheduler Success at "</span>  + time);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        taskScheduler.schedule(runnable, cron);</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-string">"Test TaskScheduler Interface."</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-07-16T18:22:00.000Z">2019-07-16</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/IT/">IT</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    1 分钟 read (About 148 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/07/17/push-existing-folder-to-git/">push existing folder to git</a>
            
        </h1>
        <div class="content">
            <p>Command line instructions    </p>
<p>You can also upload existing files from your computer using the instructions below.</p>
<figure class="highlight routeros hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Git global setup  </span><br><span class="line">git<span class="hljs-built_in"> config </span>--global user.name <span class="hljs-string">"Tong"</span>  </span><br><span class="line">git<span class="hljs-built_in"> config </span>--global user.email <span class="hljs-string">"joetonghao@126.com"</span></span><br></pre></td></tr></table></figure>

<p>Create a new repository  </p>
<figure class="highlight stylus hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git clone http:<span class="hljs-comment">//tong.lab.com/Joe/springboot-login.git  </span></span><br><span class="line">cd springboot-login  </span><br><span class="line">touch README<span class="hljs-selector-class">.md</span>  </span><br><span class="line">git add README<span class="hljs-selector-class">.md</span>  </span><br><span class="line">git commit -m <span class="hljs-string">"add README"</span>  </span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure>

<p>Push an existing folder </p>
<figure class="highlight dockerfile hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd existing_folder  </span><br><span class="line">git init  </span><br><span class="line">git remote <span class="hljs-keyword">add</span><span class="hljs-bash"> origin http://tong.lab.com/Joe/springboot-login.git  </span></span><br><span class="line">git <span class="hljs-keyword">add</span><span class="hljs-bash"> .</span></span><br><span class="line">git commit -m <span class="hljs-string">"Initial commit"</span>  </span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure>

<p>Push an existing Git repository  </p>
<figure class="highlight maxima hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd existing_repo  </span><br><span class="line">git remote <span class="hljs-built_in">rename</span> <span class="hljs-built_in">origin</span> old-<span class="hljs-built_in">origin</span>  </span><br><span class="line">git remote add <span class="hljs-built_in">origin</span> http://tong.lab.com/Joe/springboot-login.git  </span><br><span class="line">git <span class="hljs-built_in">push</span> -u <span class="hljs-built_in">origin</span> --all  </span><br><span class="line">git <span class="hljs-built_in">push</span> -u <span class="hljs-built_in">origin</span> --tags</span><br></pre></td></tr></table></figure>

<p>git - 查看远程仓库信息</p>
<p><code>git remote show origin</code></p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-07-16T17:54:00.000Z">2019-07-16</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/IT/">IT</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    13 分钟 read (About 1995 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/07/17/docker-gitlab/">docker gitlab</a>
            
        </h1>
        <div class="content">
            <p>使用docker搭建gitlab初体验+数据备份</p>
<p>一. 背景<br>作为程序员，像GitHub这种好工具是必须得十分了解的，但是有时GitHub并不能满足我们所有的需求，就如作者所在的公司，我们的代码都是商业性的产品，不可能放到GitHub的开放仓库中的，而申请GitHub私人仓库需要钱。这就陷入了尴尬的局面，那有没有一种既能具有GitHub一样的功能，又能保护隐私免费的管理工具呢？答案是肯定的，感谢程序员伟大的开源精神，我们有了GitLab!!!今天笔者在这里就跟大家分享一下自己使用docker搭建GitLab的过程吧，这其中踩了一些坑，希望看过这篇文章的人不用在踩我踩过的坑了！<br>二. 环境介绍<br>服务器信息：<br>CPU : 2<br>DISK : 30G<br>RAM : 4G<br>OS : Linux centos7-0 3.10.0-229.el7.x86_64<br>这里笔者使用的是自己公司的服务器，也可以使用虚拟机进行搭建<br>三. 搭建过程  </p>
<ol>
<li>安装docker<br>因为我们是使用docker搭建的，所以需要先安装docker，docker支持不同的OS，具体的安装信息这里不做详细介绍，可以自己的操作系统，参考官方的安装指南进行安装。  <a href="http://www.docker.io" target="_blank" rel="noopener">http://www.docker.io</a>  </li>
<li>安装GitLab及相关组件<br>GitLab需要用到数据库来存储相关数据，所以需要在安装GitLab的同时安装数据库，这里使用的是postgresql和redis。我在查找相关的镜像，之后发现有很多现成的镜像，这里我使用的sameersbn镜像。但是有一点我认为不是很好的是：这个镜像没有把redis、postgresql集成到gitlab的容器里面，需要先单独pull这两个镜像run一下，然后再pull gitlab的镜像进行安装。<br>使用如下命令分别拉取最新的镜像：<br>docker pull sameersbn/redis<br>docker pull sameersbn/postgresql<br>docker pull sameersbn/gitlab<br>这里有第一个坑：因为我们默认都是从docker的官方仓库中拉去镜像，但是由于国内访问国外的网站有墙，而且速度也是十分的慢，所以需要代理。这里推荐Daocloud加速器 <a href="https://www.daocloud.io/" target="_blank" rel="noopener">https://www.daocloud.io/</a> 免费使用，但是需要先注册，登录成功后，找到加速器执行相关命令即可。笔者亲测速度明显快很多！<br>使用如下命令运行postgresql镜像：  <figure class="highlight crystal hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker run --name postgresql -d \  </span><br><span class="line">-e <span class="hljs-string">'DB_NAME=gitlabhq_production'</span> \  </span><br><span class="line">-e <span class="hljs-string">'DB_USER=gitlab'</span> \</span><br><span class="line">-e <span class="hljs-string">'DB_PASS=password'</span> \  </span><br><span class="line">-e <span class="hljs-string">'DB_EXTENSION=pg_trgm'</span> \  </span><br><span class="line">-v /home/root/opt/postgresql/<span class="hljs-symbol">data:</span>/var/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">postgresql</span> \  </span></span><br><span class="line">sameersbn/postgresql</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>这里需要解释的是：<br>(1). 以上是一条命令，反斜杠是为了在命令内换行方便阅读，如果不喜欢，也可以写在一行。<br>(2). -e后面跟的都是容器的环境参数，都是在制作镜像的时候指定好的，所以不要去改动。<br>(3). -v后面是添加数据卷，这样在容器退出的时候数据就不会丢失，其中 /home/root/opt/postgresql/data是作者自己创建的文件夹，读者可以自己自定义，后面的部分是容器内的文件路径，需要保持不变。<br>(4). 命令执行成功之后会在控制台显示一串容器的编号，可以使用命令docker ps查看刚刚启动的容器。  </p>
<p>使用如下命令运行redis镜像：  </p>
<figure class="highlight crystal hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker run --name redis -d \  </span><br><span class="line">-v /home/root/opt/redis/<span class="hljs-symbol">data:</span>/var/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">redis</span> \  </span></span><br><span class="line">sameersbn/redis</span><br></pre></td></tr></table></figure>

<p>这里跟启动postgresql一样。<br>使用如下命令运行GitLab镜像：</p>
<figure class="highlight livescript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">docker run --name gitlab -d <span class="hljs-string">\</span></span><br><span class="line">--link postgresql:postgresql --link redis:redisio <span class="hljs-string">\</span></span><br><span class="line">-p <span class="hljs-number">10022</span>:<span class="hljs-number">22</span> -p <span class="hljs-number">10080</span>:<span class="hljs-number">80</span> <span class="hljs-string">\</span></span><br><span class="line">-e <span class="hljs-string">'GITLAB_PORT=10080'</span> <span class="hljs-string">\</span></span><br><span class="line">-e <span class="hljs-string">'GITLAB_SSH_PORT=10022'</span> <span class="hljs-string">\</span></span><br><span class="line">-e <span class="hljs-string">'GITLAB_SECRETS_DB_KEY_BASE=long-and-random-alpha-numeric-string'</span><span class="hljs-string">\</span></span><br><span class="line">-e <span class="hljs-string">'GITLAB_SECRETS_SECRET_KEY_BASE=long-and-random-alpha-numeric-string'</span> <span class="hljs-string">\</span></span><br><span class="line">-e <span class="hljs-string">'GITLAB_SECRETS_OTP_KEY_BASE=long-and-random-alpha-numeric-string'</span><span class="hljs-string">\</span></span><br><span class="line">-e <span class="hljs-string">'GITLAB_HOST=服务器地址'</span> <span class="hljs-string">\</span></span><br><span class="line">-e <span class="hljs-string">'GITLAB_EMAIL=邮箱地址'</span> <span class="hljs-string">\</span></span><br><span class="line">-e <span class="hljs-string">'SMTP_ENABLED=true'</span> <span class="hljs-string">\</span></span><br><span class="line">-e <span class="hljs-string">'SMTP_DOMAIN=www.sina.com'</span> <span class="hljs-string">\</span></span><br><span class="line">-e <span class="hljs-string">'SMTP_HOST=smtp.sina.com'</span> <span class="hljs-string">\</span> </span><br><span class="line">-e <span class="hljs-string">'SMTP_STARTTLS=false'</span>  <span class="hljs-string">\</span></span><br><span class="line">-e <span class="hljs-string">'SMTP_USER=邮箱地址'</span> <span class="hljs-string">\</span></span><br><span class="line">-e <span class="hljs-string">'SMTP_PASS=邮箱密码'</span> <span class="hljs-string">\</span></span><br><span class="line">-e <span class="hljs-string">'SMTP_AUTHENTICATION=login'</span> <span class="hljs-string">\</span></span><br><span class="line">-e <span class="hljs-string">'GITLAB_BACKUP_SCHEDULE=daily'</span> <span class="hljs-string">\</span></span><br><span class="line">-e <span class="hljs-string">'GITLAB_BACKUP_TIME=10:30'</span> <span class="hljs-string">\</span></span><br><span class="line">-v /home/root/opt/gitlab/data:/home/git/data <span class="hljs-string">\</span></span><br><span class="line">sameersbn/gitlab</span><br></pre></td></tr></table></figure>

<p>这里需要解释的是：<br>(1). 网上又很多教程讲关于使用docker安装GitLab，但是讲的不全面，至少我按照他们的方法安装时不能正常运行，这里是第三个坑：一定要加上如下环境参数：</p>
<figure class="highlight maxima hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-e 'GITLAB_SECRETS_DB_KEY_BASE=long-<span class="hljs-keyword">and</span>-<span class="hljs-built_in">random</span>-alpha-numeric-<span class="hljs-built_in">string</span>'\</span><br><span class="line">-e 'GITLAB_SECRETS_SECRET_KEY_BASE=long-<span class="hljs-keyword">and</span>-<span class="hljs-built_in">random</span>-alpha-numeric-<span class="hljs-built_in">string</span>' \</span><br><span class="line">-e 'GITLAB_SECRETS_OTP_KEY_BASE=long-<span class="hljs-keyword">and</span>-<span class="hljs-built_in">random</span>-alpha-numeric-<span class="hljs-built_in">string</span>'\</span><br></pre></td></tr></table></figure>

<p>有关于这三个环境参数的含义：</p>
<p>官方的解释 </p>
<p>我个人的理解是用来进行加密的key。<br>(2). 上面有关SMTP的环境参数是配置邮箱的，需要填上对应的邮箱信息，我使用的是新浪邮箱，读者可以根据自己的邮箱进行填写。<br>(3). 使用GitLab需要两个端口，一个是web端口，一个是SSH端口用于push代码的所以一下代码进行端口映射和指定：</p>
<p>-p 10022:22 -p 10080:80 <br>-e ‘GITLAB_PORT=10080’ <br>-e ‘GITLAB_SSH_PORT=10022’ <br>(4). GitLab有自带的备份，这里可以通过如下进行配置：<br>-e ‘GITLAB_BACKUP_SCHEDULE=daily’ <br>-e ‘GITLAB_BACKUP_TIME=10:30’ <br>指定的是每天10:30进行备份。<br>说到这里基本上GitLab就搭建好了，这里还有一个小坑就是：运行这些容器的时候可以把代码写进shell脚本中，然后通过脚本进行运行，不然直接在终端打的话很麻烦。<br>一下就是笔者安装完后的截图，直接访问：http://服务器地址:10080 即可，首次访问可能会出现错误页面，刷新几下页面就可以了然后在修改密码默认用户名：root 之后就可以正常使用。</p>
<p>登录界面 </p>
<p>group </p>
<p>admin area<br>四. 备份<br>我们可以使用GitLab自带的备份功能，在启动容器的时候就进行设置，然后再使用GitLab的 app:rake gitlab:backup:restore命令进行恢复，这里网上的教程都有说明可以参考以下网站：<br>sameersbn的GitHub wiki：<br><a href="https://github.com/sameersbn/docker-gitlab#automated-backups" target="_blank" rel="noopener">https://github.com/sameersbn/docker-gitlab#automated-backups</a><br>这个是官方的所以比较全面，里面还有关于各种环境参数的介绍。<br>这里作者使用的是如下的备份方法：<br>因为我们在运行postgresql、redis和GitLab的时候都使用了本地的文件夹进行了数据的持久化，而且我们实际需要备份的数据都在本地了，那么其实就可以直接使用rsync命令备份本地的这些卷（刚刚的文件夹）即可，无需再去深入到GitLab内部。如果搭建的GitLab崩溃了，或者服务器崩溃了，直接再使用docker再搭一个，在把刚刚的卷跟对应的postgresql、redis和GitLab内的数据文件夹进行映射即可。这是也不需要修改之前的启动命令，十分的方便而且作者自己测试过，发现能够达到要求，原先的仓库、用户的SSH信息等都在。</p>
<p>修改100.230 /data/gitlab_875/config/gitlab.rb (docker gitlab875 /etc/gitlab/gitlab.rb)<br>增加:  </p>
<figure class="highlight prolog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">gitlab_rails[<span class="hljs-string">'smtp_enable'</span>] = true</span><br><span class="line">#gitlab_rails[<span class="hljs-string">'smtp_address'</span>] = <span class="hljs-string">"smtp.domain.cn"</span></span><br><span class="line">gitlab_rails[<span class="hljs-string">'smtp_address'</span>] = <span class="hljs-string">"12.34.56.78"</span></span><br><span class="line">gitlab_rails[<span class="hljs-string">'smtp_port'</span>] = <span class="hljs-number">25</span></span><br><span class="line">gitlab_rails[<span class="hljs-string">'smtp_user_name'</span>] = <span class="hljs-string">"gitlabadmin@domain.cn"</span></span><br><span class="line">gitlab_rails[<span class="hljs-string">'smtp_password'</span>] = <span class="hljs-string">"yourpassword"</span></span><br><span class="line">gitlab_rails[<span class="hljs-string">'smtp_domain'</span>] = <span class="hljs-string">"smtp.domain.cn"</span></span><br><span class="line">gitlab_rails[<span class="hljs-string">'smtp_authentication'</span>] = <span class="hljs-string">"login"</span></span><br><span class="line">gitlab_rails[<span class="hljs-string">'smtp_enable_starttls_auto'</span>] = true</span><br><span class="line">gitlab_rails[<span class="hljs-string">'smtp_tls'</span>] = false</span><br><span class="line">gitlab_rails[<span class="hljs-string">'smtp_openssl_verify_mode'</span>] = <span class="hljs-string">'none'</span></span><br><span class="line"></span><br><span class="line">gitlab_rails[<span class="hljs-string">'gitlab_email_enabled'</span>] = true</span><br><span class="line">gitlab_rails[<span class="hljs-string">'gitlab_email_from'</span>] = <span class="hljs-string">'gitlabadmin@domain.cn'</span></span><br><span class="line">gitlab_rails[<span class="hljs-string">'gitlab_email_display_name'</span>] = <span class="hljs-string">'gitlabadmin'</span></span><br><span class="line">gitlab_rails[<span class="hljs-string">'gitlab_email_reply_to'</span>] = <span class="hljs-string">'gitlabadmin@domain.cn'</span></span><br><span class="line">gitlab_rails[<span class="hljs-string">'gitlab_email_subject_suffix'</span>] = <span class="hljs-string">''</span></span><br></pre></td></tr></table></figure>
        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-07-16T16:27:00.000Z">2019-07-16</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/IT/">IT</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    9 分钟 read (About 1319 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/07/17/springboot-login/">springboot login</a>
            
        </h1>
        <div class="content">
            <p>springboot系列（一）：初次使用与登录验证实现</p>
<p>听说过很多springboot如何流行，以及如何简化了我们的应用开发，却没有真正使用过springboot，现在终于要动手了！打算自己动手的这个项目，结果不会是促成某个真正的项目，学习为主，把学习过程分享出来。开篇探索以以下两个方面为主：<br>1、从mvc经典框架到springboot<br>2、最原始的方式实现登录验证<br>一、建一个使用springboot的项目<br>springboot是建立在的spring生态的基础上的，以前看spring的时候，有两大概念是纠结了很久的，IOC（控制反转）以及AOP（面向切面的编程）。其实控制反转就是依赖注入，spring提供了一个IOC容器来初始化对象，解决对象间依赖管理和对象的使用，如@Bean、@Autowired等可以实现依赖注入，AOP目前理解是在一些日志框架场景中用到。<br>平时我们常见的web项目开发，使用的mvc框架、maven管理在springboot依然使用到，springboot最明显的好处是简化了新建一个项目时的各种配置过程，就连tomcat都不用配置了。可以看到我新建一个maven项目大目录结构是这样的</p>
<p>跟着上图目录结构，我们来看看springboot是如何完成一个普通的web项目所需要做的事的<br>a.web容器：springboot内嵌了Tomcat,我们不需要手动配置tomcat以及以war包形式部署项目，启动入口为目录中App.java中的main函数，直接运行即可。</p>
<p>@SpringBootApplication<br>public class App {<br>public static void main(String[] args) {<br>SpringApplication.run(App.class,args);<br>}
}</p>
<p>b.依赖管理:spring提供了一系列的starter pom来简化Maven的依赖加载，如一个web项目pom.xm部分配置如下：</p>
<figure class="highlight xml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span></span><br><span class="line">     <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span></span><br><span class="line">     <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.4.3.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span></span><br><span class="line"> <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"> <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span></span><br><span class="line">     <span class="hljs-comment">&lt;!--Spring Boot的核心启动器，包含了自动配置、日志和YAML--&gt;</span></span><br><span class="line">     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="hljs-comment">&lt;!--支持全栈式Web开发，包括Tomcat和spring-webmvc--&gt;</span></span><br><span class="line">     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span></span><br><span class="line">         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span></span><br><span class="line">         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"> <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>c.配置管理：目录中src/main/resource/application.properties为配置文件，springboot可以自动读取，或者使用java配置可以看到没有web.xml，没有spring相关的配置文件，整个项目看起来非常的简洁。</p>
<p>#数据库配置<br>spring.datasource.url=jdbc:mysql://localhost:3306/world?characterEncoding=UTF-8&amp;useUnicode=true<br>spring.datasource.username=darren<br>spring.datasource.password=darren123<br>spring.datasource.driver-class-name=com.mysql.jdbc.Driver<br>spring.jpa.properties.hibernate.hbm2ddl.auto=update<br>一个springboot web项目大概就包含这些 </p>
<p>二、原始方式实现登录验证<br>流程为：登录页面发起请求–&gt;拦截器拦截匹配的url判断session–&gt;后台验证/设置session–&gt;返回<br>a、这里主要通过自定义拦截器的方式，继承WebMvcConfigurerAdapter和HandlerInterceptorAdapter来实现拦截器对登录请求进行拦截和session的判断，我这里都写在WebSecurityConfig.java中<br>其中WebMvcConfigurerAdapter是Spring提供的基础类，可以通过重写 addInterceptors 方法添加注册拦截器来组成一个拦截链，以及用于添加拦截规则和排除不用的拦截，如下：</p>
<figure class="highlight abnf hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public void  addInterceptors(InterceptorRegistry registry)&#123;</span><br><span class="line">    InterceptorRegistration addInterceptor = registry.addInterceptor(getSecurityInterceptor())<span class="hljs-comment">;</span></span><br><span class="line"></span><br><span class="line">    addInterceptor.excludePathPatterns(<span class="hljs-string">"/error"</span>)<span class="hljs-comment">;</span></span><br><span class="line">    addInterceptor.excludePathPatterns(<span class="hljs-string">"/login**"</span>)<span class="hljs-comment">;</span></span><br><span class="line"></span><br><span class="line">    addInterceptor.addPathPatterns(<span class="hljs-string">"/**"</span>)<span class="hljs-comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其中HandlerInterceptorAdapter是spring mvc提供的适配器，继承此类，可以非常方便的实现自己的拦截器，它有三个方法：preHandle、postHandle、afterCompletion。preHandle在业务处理器处理请求之前被调用。预处理，可以进行编码、安全控制等处理；postHandle在业务处理器处理请求执行完成后，生成视图之前执行。afterCompletion在DispatcherServlet完全处理完请求后被调用，可用于清理资源等。我项目中只重写了preHandle,对请求进行session判断和跳转到自定义的页面，如下：</p>
<figure class="highlight scala hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="hljs-keyword">private</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecurityInterceptor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HandlerInterceptorAdapter</span></span>&#123;</span><br><span class="line">        <span class="hljs-meta">@Override</span></span><br><span class="line">        public boolean preHandle(<span class="hljs-type">HttpServletRequest</span> request, <span class="hljs-type">HttpServletResponse</span> response,<span class="hljs-type">Object</span> handler) <span class="hljs-keyword">throws</span> <span class="hljs-type">IOException</span> &#123;</span><br><span class="line">            <span class="hljs-type">HttpSession</span> session = request.getSession();</span><br><span class="line">            </span><br><span class="line"><span class="hljs-comment">//            判断是否已有该用户登录的session</span></span><br><span class="line">            <span class="hljs-keyword">if</span>(session.getAttribute(<span class="hljs-type">SESSION_KEY</span>) != <span class="hljs-literal">null</span>)&#123;</span><br><span class="line">                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">//            跳转到登录页</span></span><br><span class="line">            <span class="hljs-type">String</span> url = <span class="hljs-string">"/login"</span>;</span><br><span class="line">            response.sendRedirect(url);</span><br><span class="line">            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>b.controller中对登录请求进行验证以及页面的跳转，如下 </p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">@Controller</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoginController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-meta">@Autowired</span></span><br><span class="line">    <span class="hljs-keyword">private</span> LoginService loginService;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-meta">@GetMapping(<span class="hljs-meta-string">"/"</span>)</span></span><br><span class="line">    <span class="hljs-keyword">public</span> String index(<span class="hljs-meta">@SessionAttribute(WebSecurityConfig.SESSION_KEY)</span>String account,Model model)&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-string">"index"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-meta">@GetMapping(<span class="hljs-meta-string">"/login"</span>)</span></span><br><span class="line">    <span class="hljs-keyword">public</span> String login()&#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-string">"login"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-meta">@PostMapping(<span class="hljs-meta-string">"/loginVerify"</span>)</span></span><br><span class="line">    <span class="hljs-keyword">public</span> String loginVerify(String username,String password,HttpSession session)&#123;</span><br><span class="line">        User user = new User();</span><br><span class="line">        user.setUsername(username);</span><br><span class="line">        user.setPassword(password);</span><br><span class="line"></span><br><span class="line">        boolean verify = loginService.verifyLogin(user);</span><br><span class="line">        <span class="hljs-keyword">if</span> (verify) &#123;</span><br><span class="line">            session.setAttribute(WebSecurityConfig.SESSION_KEY, username);</span><br><span class="line">            <span class="hljs-keyword">return</span> <span class="hljs-string">"index"</span>;</span><br><span class="line">        &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">            <span class="hljs-keyword">return</span> <span class="hljs-string">"redirect:/login"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-meta">@GetMapping(<span class="hljs-meta-string">"/logout"</span>)</span></span><br><span class="line">    <span class="hljs-keyword">public</span> String logout(HttpSession session)&#123;</span><br><span class="line">        session.removeAttribute(WebSecurityConfig.SESSION_KEY);</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-string">"redirect:/login"</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>controller代码解释：loginVerify是对登录请求到数据库中进行验证用户名和密码，验证通过以后设置session，否则跳转到登录页面。@GetMapping是一个组合注解，是@RequestMapping(method = RequestMethod.GET)的缩写,@PostMapping同理。 </p>
<p>ps:实际项目登录验证会使用登录验证框架：spring security 、shiro等，以及登录过程密码加密传输保存等，这里仅仅用于了解。</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-07-16T02:30:00.000Z">2019-07-16</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/IT/">IT</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    几秒 read (About 73 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/07/16/idea-springboot-autowired-show-redunderline/">idea springboot autowired hide red underline</a>
            
        </h1>
        <div class="content">
            <p>SpringBoot：Dao层mapper注入报红问题</p>
<p>在mapper接口上加上</p>
<p>@Component注解<br>例如:</p>
<pre><code>import com.example.sptingboot_mybatis.model.User;
import org.apache.ibatis.annotations.Mapper;
import org.springframework.stereotype.Component;

import java.util.List;

@Mapper
@Component(&quot;IUser&quot;)
public interface IUser {
   List&lt;User&gt; findAll();
}</code></pre><p>就可以解决问题</p>
<p>原文链接：<a href="https://blog.csdn.net/Sir_He/article/details/81879854" target="_blank" rel="noopener">https://blog.csdn.net/Sir_He/article/details/81879854</a> </p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-07-16T01:44:00.000Z">2019-07-16</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/IT/">IT</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    24 分钟 read (About 3597 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/07/16/auto/">@Autowired @Resource @Qualifier的区别</a>
            
        </h1>
        <div class="content">
            <p>@Autowired @Resource @Qualifier的区别<br>spring不但支持自己定义的@Autowired注解，还支持几个由JSR-250规范定义的注解，它们分别是@Resource、@PostConstruct以及@PreDestroy。  </p>
<p>@Resource的作用相当于@Autowired，只不过@Autowired按byType自动注入，而@Resource默认按 byName自动注入罢了。@Resource有两个属性是比较重要的，分是name和type，Spring将@Resource注解的name属性解析为bean的名字，而type属性则解析为bean的类型。所以如果使用name属性，则使用byName的自动注入策略，而使用type属性时则使用byType自动注入策略。如果既不指定name也不指定type属性，这时将通过反射机制使用byName自动注入策略。  </p>
<p>@Resource装配顺序<br>　　1. 如果同时指定了name和type，则从Spring上下文中找到唯一匹配的bean进行装配，找不到则抛出异常<br>　　2. 如果指定了name，则从上下文中查找名称（id）匹配的bean进行装配，找不到则抛出异常<br>　　3. 如果指定了type，则从上下文中找到类型匹配的唯一bean进行装配，找不到或者找到多个，都会抛出异常<br>　　4. 如果既没有指定name，又没有指定type，则自动按照byName方式进行装配；如果没有匹配，则回退为一个原始类型进行匹配，如果匹配则自动装配；  </p>
<p>@Autowired 与@Resource的区别：  </p>
<ul>
<li><p>1、 @Autowired与@Resource都可以用来装配bean. 都可以写在字段上,或写在setter方法上。</p>
</li>
<li><p>2、 @Autowired默认按类型装配（这个注解是属业spring的），默认情况下必须要求依赖对象必须存在，如果要允许null值，可以设置它的required属性为false，如：@Autowired(required=false) ，如果我们想使用名称装配可以结合@Qualifier注解进行使用，如下：</p>
<figure class="highlight less hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-variable">@Autowired</span>()</span><br><span class="line"><span class="hljs-variable">@Qualifier</span>(<span class="hljs-string">"baseDao"</span>)</span><br><span class="line">privateBaseDao baseDao;</span><br></pre></td></tr></table></figure>
</li>
<li><p>3、@Resource（这个注解属于J2EE的），默认按照名称进行装配，名称可以通过name属性进行指定，如果没有指定name属性，当注解写在字段上时，默认取字段名进行安装名称查找，如果注解写在setter方法上默认取属性名进行装配。当找不到与名称匹配的bean时才按照类型进行装配。但是需要注意的是，如果name属性一旦指定，就只会按照名称进行装配。</p>
<figure class="highlight css hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@<span class="hljs-keyword">Resource</span>(<span class="hljs-keyword">name</span>="<span class="hljs-keyword">baseDao</span>")</span><br><span class="line"><span class="hljs-keyword">privateBaseDao</span> baseDao;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>推荐使用：@Resource注解在字段上，这样就不用写setter方法了，并且这个注解是属于J2EE的，减少了与spring的耦合。这样代码看起就比较优雅。</p>
<p>spring @Qualifier注解</p>
<p>@Autowired是根据类型进行自动装配的。如果当Spring上下文中存在不止一个UserDao类型的bean时，就会抛出BeanCreationException异常;如果Spring上下文中不存在UserDao类型的bean，也会抛出BeanCreationException异常。我们可以使用@Qualifier配合@Autowired来解决这些问题。如下：<br>①可能存在多个UserDao实例<br> <figure class="highlight less hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-variable">@Autowired</span>   </span><br><span class="line"><span class="hljs-variable">@Qualifier</span>(<span class="hljs-string">"userServiceImpl"</span>)   </span><br><span class="line">public IUserService userService;</span><br></pre></td></tr></table></figure></p>
<p>或者</p>
 <figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">@Autowired</span>   </span><br><span class="line"><span class="hljs-keyword">public</span> void setUserDao(<span class="hljs-meta">@Qualifier(<span class="hljs-meta-string">"userDao"</span>)</span> UserDao userDao) &#123;   </span><br><span class="line">    <span class="hljs-keyword">this</span>.userDao = userDao;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样Spring会找到id为userServiceImpl和userDao的bean进行装配。</p>
<p>②可能不存在UserDao实例<br>  <figure class="highlight aspectj hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">@Autowired</span>(required = <span class="hljs-keyword">false</span>)   </span><br><span class="line"><span class="hljs-keyword">public</span> IUserService userService</span><br></pre></td></tr></table></figure></p>
<table>
<thead>
<tr>
<th align="left">个人总结：</th>
</tr>
</thead>
<tbody><tr>
<td align="left">@Autowired//默认按type注入</td>
</tr>
<tr>
<td align="left">@Qualifier(“cusInfoService”)//一般作为@Autowired()的修饰用</td>
</tr>
<tr>
<td align="left">@Resource(name=”cusInfoService”)//默认按name注入，可以通过name和type属性进行选择性注入不属于spring</td>
</tr>
<tr>
<td align="left">一般@Autowired和@Qualifier一起用，@Resource单独用。</td>
</tr>
<tr>
<td align="left">当然没有冲突的话@Autowired也可以单独用</td>
</tr>
</tbody></table>
<h5 id="常用注解"><a href="#常用注解" class="headerlink" title="常用注解"></a>常用注解</h5><p>–定义Bean的注解</p>
<p>@Controller<br>@Controller(“Bean的名称”)<br>定义控制层Bean,如Action  </p>
<p>@Service<br>@Service(“Bean的名称”)<br>定义业务层Bean  </p>
<p>@Repository<br>@Repository(“Bean的名称”)<br>定义DAO层Bean  </p>
<p>@Component<br>定义Bean, 不好归类时使用.  </p>
<p>–自动装配Bean （选用一种注解就可以）<br>@Autowired  (Srping提供的)<br>默认按类型匹配,自动装配(Srping提供的)，可以写在成员属性上,或写在setter方法上  </p>
<p>@Autowired(required=true)<br>一定要找到匹配的Bean，否则抛异常。 默认值就是true   </p>
<p>@Autowired<br>@Qualifier(“bean的名字”)<br>按名称装配Bean,与@Autowired组合使用，解决按类型匹配找到多个Bean问题。  </p>
<p>@Resource   JSR-250提供的<br>默认按名称装配,当找不到名称匹配的bean再按类型装配.<br>可以写在成员属性上,或写在setter方法上<br>可以通过@Resource(name=”beanName”) 指定被注入的bean的名称, 要是未指定name属性, 默认使用成员属性的变量名,一般不用写name属性.<br>@Resource(name=”beanName”)指定了name属性,按名称注入但没找到bean, 就不会再按类型装配了.  </p>
<p>@Inject   是JSR-330提供的<br>按类型装配，功能比@Autowired少，没有使用的必要。  </p>
<p>–定义Bean的作用域和生命过程<br>@Scope(“prototype”)<br>值有:singleton,prototype,session,request,session,globalSession  </p>
<p>@PostConstruct<br>相当于init-method,使用在方法上，当Bean初始化时执行。  </p>
<p>@PreDestroy<br>相当于destory-method，使用在方法上，当Bean销毁时执行。  </p>
<p>–声明式事务<br>@Transactional<br>@Autowired @Resource @Qualifier的区别<br>实用理解：@Autowired @Resource 二选其一，看中哪个就用哪个。  </p>
<p>简单理解：<br>@Autowired 根据类型注入，<br>@Resource 默认根据名字注入，其次按照类型搜索<br>@Autowired @Qualifie(“userService”) 两个结合起来可以根据名字和类型注入  </p>
<p>复杂理解：<br>比如你有这么一个Bean<br>@Service(“UserService”)<br>public Class UserServiceImpl implements UserService｛｝;<br>现在你想在UserController 里面使用这个UserServiceImpl<br>public Class UserController ｛<br>@AutoWired   //当使用这个注入的时候上面的 UserServiceImpl 只需要这样写 @Service，这样就会自动找到UserService这个类型以及他的子类型。UserServiceImpl 实现了UserService，所以能够找到它。不过这样有一个缺点，就是当UserService实现类有两个以上的时候，这个时候会找哪一个呢，这就造成了冲突，所以要用@AutoWire注入的时候要确保UserService只有一个实现类。<br>@Resource 默认情况下是按照名称进行匹配，如果没有找到相同名称的Bean，则会按照类型进行匹配，有人可能会想了，这下好了，用这个是万能的了，不用管名字了，也不用管类型了，但这里还是有缺点。首先，根据这个注解的匹配效果可以看出，它进行了两次匹配，也就是说，如果你在UserService这个类上面这样写注解，@Service,它会怎么找呢，首先是找相同名字的，如果没有找到，再找相同类型的，而这里的@Service没有写名字，这个时候就进行了两次搜索，显然，速度就下降了许多。也许你还会问，这里的@Service本来就没有名字，肯定是直接进行类型搜索啊。其实不是这样的，UserServiceImpl 上面如果有@Service默认的名字 是这个userServiceImpl，注意看，就是把类名前面的大写变成小写，就是默认的Bean的名字了。 @Resource根据名字搜索是这样写@Resource(“userService”)，如果你写了这个名字叫userService，那么UserServiceImpl上面必须也是这个名字，不然还是会报错。  </p>
<p>@Autowired @Qualifie(“userService”) 是直接按照名字进行搜索，也就是说，对于UserServiceImpl 上面@Service注解必须写名字，不写就会报错，而且名字必须是@Autowired @Qualifie(“userService”) 保持一致。如果@Service上面写了名字，而@Autowired @Qualifie() ，一样会报错。</p>
<p>private UserService userService;</p>
<p>｝  
说了这么多，可能你有些说晕了，那么怎么用这三个呢，要实际的工作是根据实际情况来使用的，通常使用AutoWire和@Resource多一些，bean的名字不用写，而UserServiceImpl上面能会这样写 @Service(“userService”)。这里的实际工作情况，到底是什么情况呢？说白了就是整个项目设计时候考虑的情况，<br>如果你的架构设计师考虑的比较精细，要求比较严格，要求项目上线后的访问速度比较好，通常是考虑速度了。这个时候@AutoWire没有@Resource好用，因为@Resource可以根据名字来搜索，是这样写的@Resource(“userService”)。这个@Autowired @Qualifie(“userService”) 也可以用名字啊，为什么不用呢，原因很简单，这个有点长，不喜欢，增加工作量。因为根据名字搜索是最快的，就好像查数据库一样，根据Id查找最快。因为这里的名字与数据库里面的ID是一样的作用。这个时候，就要求你多写几个名字，工作量自然就增加了。而如果你不用注解，用xml文件的时候，对于注入Bean的时候要求写一个Id，xml文件时候的id就相当于这里的名字。</p>
<p>说了那么多没用，你能做的就是简单直接，什么最方便就用什么，<br>你就直接用@Resource得了，如果你喜欢用@AutoWired也行，不用写名字。</p>
<p>通常情况一个Bean的注解写错了，会报下面这些错误，最为常见，<br>No bean named ‘user’ is defined，这个表示没有找到被命名为user的Bean，通俗的说，就是名字为user的类型，以及它的子类型，出现这个错误的原因就是注入时候的类型名字为user，而搜索的时候找不到，也就是说可能那个搜索的类型，并没有命令为user，解决办法就是找到这个类型，去命令为user，</p>
<p>下面这个错误也常见，<br>No qualifying bean of type [com.service.UserService] found for dependency:<br>这个错误的原因就是类型上面没有加@Service这个注入，不仅仅是@Service，如果是其他层也会出现这个错误，这里我是以Service为例子说明，如果是DAO层就是没有加@Repository，Controller层，则是没有加@Controller。<br>还有，如果你还是想再简单点，无论是DAO,Controller，Service三个层，都可以用这个注解，@Component，这个注解通用所有的Bean，这个时候你可能会说了，有通常的为什么用的人少呢，那是因为MVC这个分层的设计原则，用@Repository,@Service，@Controller，这个可以区别MVC原则中的DAO,Service，Controller。便于识别。</p>
<p>博客2：<br>springautowiredqualifierbytypebyname<br>　在使用Spring框架中@Autowired标签时默认情况下使用<br>Java代码<br>@Autowired<br> @Autowired<br>注释进行自动注入时，Spring 容器中匹配的候选 Bean 数目必须有且仅有一个。当找不到一个匹配的 Bean 时，Spring 容器将抛出 BeanCreationException 异常，并指出必须至少拥有一个匹配的 Bean。<br>@Autowired 默认是按照byType进行注入的，如果发现找到多个bean，则，又按照byName方式比对，如果还有多个，则报出异常。<br>例子：<br>@Autowired<br>private ExamUserMapper examUserMapper;  - ExamUserMapper是一个接口</p>
<ol>
<li>spring先找类型为ExamUserMapper的bean</li>
<li>如果存在且唯一，则OK；</li>
<li>如果不唯一，在结果集里，寻找name为examUserMapper的bean。因为bean的name有唯一性，所以，到这里应该能确定是否存在满足要求的bean了</li>
</ol>
<p>@Autowired也可以手动指定按照byName方式注入，使用@Qualifier标签，例如：<br>@Autowired () @Qualifier ( “baseDao” )</p>
<p>　　Spring 允许我们通过<br>Java代码<br>@Qualifier<br>@Qualifier<br>注释指定注入 Bean 的名称，这样歧义就消除了，可以通过下面的方法解决异常。 </p>
<p>　　<br>Java代码<br>@Qualifier(“XXX”)<br>@Qualifier(“XXX”)<br>中的 XX是 Bean 的名称，所以 @Autowired 和 @Qualifier 结合使用时，自动注入的策略就从 byType 转变成 byName 了。 </p>
<p>　　@Autowired 可以对成员变量、方法以及构造函数进行注释，而 @Qualifier 的标注对象是成员变量、方法入参、构造函数入参。 </p>
<pre><code>Spring不但支持自己定义的@Autowired注解，还支持几个由JSR-250规范定义的注解，它们分别是@Resource、@PostConstruct以及@PreDestroy。 </code></pre><p>　　<br>Java代码<br>@Resource<br>@Resource<br>的作用相当于@Autowired，只不过@Autowired按byType自动注入，而@Resource默认按 byName自动注入罢了。@Resource有两个属性是比较重要的，分是name和type，Spring将@Resource注解的name属性解析为bean的名字，而type属性则解析为bean的类型。所以如果使用name属性，则使用byName的自动注入策略，而使用type属性时则使用byType自动注入策略。如果既不指定name也不指定type属性，这时将通过反射机制使用byName自动注入策略。 </p>
<p>　　@Resource装配顺序<br>　　1. 如果同时指定了name和type，则从Spring上下文中找到唯一匹配的bean进行装配，找不到则抛出异常<br>　　2. 如果指定了name，则从上下文中查找名称（id）匹配的bean进行装配，找不到则抛出异常<br>　　3. 如果指定了type，则从上下文中找到类型匹配的唯一bean进行装配，找不到或者找到多个，都会抛出异常<br>　　4. 如果既没有指定name，又没有指定type，则自动按照byName方式进行装配；如果没有匹配，则回退为一个原始类型进行匹配，如果匹配则自动装配 </p>

        </div>
        
        
        
    </div>
</div>









    
<div class="card card-transparent">
    <nav class="pagination is-centered" role="navigation" aria-label="pagination">
        <div class="pagination-previous">
            <a class="is-flex-grow has-text-black-ter" href="/page/17/">Previous</a>
        </div>
        <div class="pagination-next">
            <a class="is-flex-grow has-text-black-ter" href="/page/19/">Next</a>
        </div>
        <ul class="pagination-list is-hidden-mobile">
            
            <li><a class="pagination-link has-text-black-ter" href="/">1</a></li>
            
            <li><span class="pagination-ellipsis has-text-black-ter">&hellip;</span></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/17/">17</a></li>
            
            <li><a class="pagination-link is-current" href="/page/18/">18</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/19/">19</a></li>
            
            <li><span class="pagination-ellipsis has-text-black-ter">&hellip;</span></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/22/">22</a></li>
            
        </ul>
    </nav>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <a href="/2020/05/29/@Select注解时使用in/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="文档标题">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-05-29T15:53:20.000Z">2020-05-29</time></div>
                    <a href="/2020/05/29/@Select注解时使用in/" class="title has-link-black-ter is-size-6 has-text-weight-normal">文档标题</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/JAVAEE/">JAVAEE</a> / <a class="has-link-grey -link" href="/categories/JAVAEE/MYBATIS/">MYBATIS</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/05/29/mysql共享锁和排它锁/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="mysql共享锁和排它锁">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-05-29T15:35:53.000Z">2020-05-29</time></div>
                    <a href="/2020/05/29/mysql共享锁和排它锁/" class="title has-link-black-ter is-size-6 has-text-weight-normal">mysql共享锁和排它锁</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/JAVAEE/">JAVAEE</a> / <a class="has-link-grey -link" href="/categories/JAVAEE/MYSQL/">MYSQL</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/05/29/邮箱找回密码与二次认证/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-05-29T14:40:15.741Z">2020-05-29</time></div>
                    <a href="/2020/05/29/邮箱找回密码与二次认证/" class="title has-link-black-ter is-size-6 has-text-weight-normal"></a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/05/29/可视化面板/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-05-29T14:40:15.601Z">2020-05-29</time></div>
                    <a href="/2020/05/29/可视化面板/" class="title has-link-black-ter is-size-6 has-text-weight-normal"></a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/05/29/CS应用配置/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-05-29T14:40:15.581Z">2020-05-29</time></div>
                    <a href="/2020/05/29/CS应用配置/" class="title has-link-black-ter is-size-6 has-text-weight-normal"></a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
            
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-128x128 has-mb-6">
                        <img class="" src="/images/avatar.png" alt="Joe">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        Joe
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        Learning
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Your location</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Posts
                    </p>
                    <p class="title has-text-weight-normal">
                        220
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Categories
                    </p>
                    <p class="title has-text-weight-normal">
                        15
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Tags
                    </p>
                    <p class="title has-text-weight-normal">
                        100
                    </p>
                </div>
            </div>
        </nav>
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/ppoffice" target="_blank">
                Follow</a>
        </div>
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Github" href="https://github.com/joeithub">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Facebook" href="https://facebook.com">
                
                <i class="fab fa-facebook"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Twitter" href="https://twitter.com">
                
                <i class="fab fa-twitter"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Dribbble" href="https://dribbble.com">
                
                <i class="fab fa-dribbble"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="RSS" href="/">
                
                <i class="fas fa-rss"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
        
            
        
            
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Categories
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/ES/">
            <span class="level-start">
                <span class="level-item">ES</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/GIT/">
            <span class="level-start">
                <span class="level-item">GIT</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/IT/">
            <span class="level-start">
                <span class="level-item">IT</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">194</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/JAVAEE/">
            <span class="level-start">
                <span class="level-item">JAVAEE</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/JAVAEE/DESIGN-PATTERNS/">
            <span class="level-start">
                <span class="level-item">DESIGN PATTERNS</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/JAVAEE/MYBATIS/">
            <span class="level-start">
                <span class="level-item">MYBATIS</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/JAVAEE/MYSQL/">
            <span class="level-start">
                <span class="level-item">MYSQL</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/SPRINGBOOT/">
            <span class="level-start">
                <span class="level-item">SPRINGBOOT</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/SPRINGBOOT/SECURITY/">
            <span class="level-start">
                <span class="level-item">SECURITY</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/SYSTEM/">
            <span class="level-start">
                <span class="level-item">SYSTEM</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">6</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/VIM/">
            <span class="level-start">
                <span class="level-item">VIM</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/WORK/">
            <span class="level-start">
                <span class="level-item">WORK</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/office/">
            <span class="level-start">
                <span class="level-item">office</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/分类1/">
            <span class="level-start">
                <span class="level-item">分类1</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/电商/">
            <span class="level-start">
                <span class="level-item">电商</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
        
            
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Tag Cloud
        </h3>
        <a href="/tags/AOP/" style="font-size: 10px;">AOP</a> <a href="/tags/CI-CD/" style="font-size: 10px;">CI/CD</a> <a href="/tags/ELASTICSEARCH/" style="font-size: 10px;">ELASTICSEARCH</a> <a href="/tags/EXCEL/" style="font-size: 10px;">EXCEL</a> <a href="/tags/Eureka/" style="font-size: 10.91px;">Eureka</a> <a href="/tags/GO/" style="font-size: 10px;">GO</a> <a href="/tags/IDEA/" style="font-size: 10.91px;">IDEA</a> <a href="/tags/IT/" style="font-size: 14.55px;">IT</a> <a href="/tags/JAVAEE/" style="font-size: 20px;">JAVAEE</a> <a href="/tags/JAVASCRIPT/" style="font-size: 11.82px;">JAVASCRIPT</a> <a href="/tags/JAVASE/" style="font-size: 10.91px;">JAVASE</a> <a href="/tags/LINUX/" style="font-size: 10px;">LINUX</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/MAC/" style="font-size: 10px;">MAC</a> <a href="/tags/MQ/" style="font-size: 11.82px;">MQ</a> <a href="/tags/ONOS/" style="font-size: 15.45px;">ONOS</a> <a href="/tags/OSGI/" style="font-size: 14.55px;">OSGI</a> <a href="/tags/OSI/" style="font-size: 10px;">OSI</a> <a href="/tags/PROTOCAL/" style="font-size: 10px;">PROTOCAL</a> <a href="/tags/PYTHON/" style="font-size: 10.91px;">PYTHON</a> <a href="/tags/Quartz/" style="font-size: 10px;">Quartz</a> <a href="/tags/RPM/" style="font-size: 10px;">RPM</a> <a href="/tags/Ribbon/" style="font-size: 10px;">Ribbon</a> <a href="/tags/SECURITY/" style="font-size: 10px;">SECURITY</a> <a href="/tags/SPRING-BOOT/" style="font-size: 10px;">SPRING-BOOT</a> <a href="/tags/SQL/" style="font-size: 12.73px;">SQL</a> <a href="/tags/SQLAlert/" style="font-size: 18.18px;">SQLAlert</a> <a href="/tags/SSO/" style="font-size: 10px;">SSO</a> <a href="/tags/StringRedisTemplate/" style="font-size: 10px;">StringRedisTemplate</a> <a href="/tags/TCP/" style="font-size: 10px;">TCP</a> <a href="/tags/TK-MYBATIS/" style="font-size: 10px;">TK.MYBATIS</a> <a href="/tags/UDP/" style="font-size: 10px;">UDP</a> <a href="/tags/annotation/" style="font-size: 15.45px;">annotation</a> <a href="/tags/bazel/" style="font-size: 10px;">bazel</a> <a href="/tags/beanutils/" style="font-size: 10px;">beanutils</a> <a href="/tags/centos/" style="font-size: 10px;">centos</a> <a href="/tags/classloader/" style="font-size: 10px;">classloader</a> <a href="/tags/computer/" style="font-size: 10px;">computer</a> <a href="/tags/cron/" style="font-size: 10px;">cron</a> <a href="/tags/debug/" style="font-size: 10px;">debug</a> <a href="/tags/docker/" style="font-size: 12.73px;">docker</a> <a href="/tags/druid/" style="font-size: 10px;">druid</a> <a href="/tags/elasticsearch/" style="font-size: 13.64px;">elasticsearch</a> <a href="/tags/enlink/" style="font-size: 10.91px;">enlink</a> <a href="/tags/fastjson/" style="font-size: 10px;">fastjson</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/gitlab/" style="font-size: 10px;">gitlab</a> <a href="/tags/go/" style="font-size: 10px;">go</a> <a href="/tags/hexo/" style="font-size: 12.73px;">hexo</a> <a href="/tags/idea/" style="font-size: 10.91px;">idea</a> <a href="/tags/interceptor/" style="font-size: 11.82px;">interceptor</a> <a href="/tags/jetty/" style="font-size: 10px;">jetty</a> <a href="/tags/jpa/" style="font-size: 10.91px;">jpa</a> <a href="/tags/json/" style="font-size: 10px;">json</a> <a href="/tags/karaf/" style="font-size: 11.82px;">karaf</a> <a href="/tags/keepalived/" style="font-size: 10px;">keepalived</a> <a href="/tags/linux-shell/" style="font-size: 15.45px;">linux-shell</a> <a href="/tags/listener/" style="font-size: 10px;">listener</a> <a href="/tags/loadbalanced/" style="font-size: 10px;">loadbalanced</a> <a href="/tags/logback/" style="font-size: 10px;">logback</a> <a href="/tags/login/" style="font-size: 10.91px;">login</a> <a href="/tags/lombok/" style="font-size: 11.82px;">lombok</a> <a href="/tags/mac/" style="font-size: 15.45px;">mac</a> <a href="/tags/markdown/" style="font-size: 11.82px;">markdown</a> <a href="/tags/mybatis/" style="font-size: 17.27px;">mybatis</a> <a href="/tags/mycat/" style="font-size: 10.91px;">mycat</a> <a href="/tags/mysql/" style="font-size: 16.36px;">mysql</a> <a href="/tags/network/" style="font-size: 12.73px;">network</a> <a href="/tags/oauth2/" style="font-size: 10px;">oauth2</a> <a href="/tags/pagehelper/" style="font-size: 10px;">pagehelper</a> <a href="/tags/postman/" style="font-size: 10px;">postman</a> <a href="/tags/python/" style="font-size: 11.82px;">python</a> <a href="/tags/rabbitMq/" style="font-size: 11.82px;">rabbitMq</a> <a href="/tags/redis/" style="font-size: 11.82px;">redis</a> <a href="/tags/redisTemplate/" style="font-size: 10px;">redisTemplate</a> <a href="/tags/reflection/" style="font-size: 11.82px;">reflection</a> <a href="/tags/registry-center/" style="font-size: 10px;">registry center</a> <a href="/tags/restTemplate/" style="font-size: 10px;">restTemplate</a> <a href="/tags/ribbon/" style="font-size: 10px;">ribbon</a> <a href="/tags/serialVersionUID/" style="font-size: 10px;">serialVersionUID</a> <a href="/tags/servlet/" style="font-size: 10.91px;">servlet</a> <a href="/tags/session/" style="font-size: 10.91px;">session</a> <a href="/tags/spring/" style="font-size: 15.45px;">spring</a> <a href="/tags/spring-task/" style="font-size: 12.73px;">spring task</a> <a href="/tags/springboot/" style="font-size: 19.09px;">springboot</a> <a href="/tags/swagger/" style="font-size: 10px;">swagger</a> <a href="/tags/webClient/" style="font-size: 10px;">webClient</a> <a href="/tags/yaml/" style="font-size: 10.91px;">yaml</a> <a href="/tags/事物/" style="font-size: 10px;">事物</a> <a href="/tags/全局异常/" style="font-size: 10px;">全局异常</a> <a href="/tags/分布式/" style="font-size: 10px;">分布式</a> <a href="/tags/抖音/" style="font-size: 10px;">抖音</a> <a href="/tags/文件服务器/" style="font-size: 10.91px;">文件服务器</a> <a href="/tags/日志/" style="font-size: 10px;">日志</a> <a href="/tags/时间转化/" style="font-size: 10px;">时间转化</a> <a href="/tags/标签1/" style="font-size: 10px;">标签1</a> <a href="/tags/消息队列/" style="font-size: 10px;">消息队列</a> <a href="/tags/淘宝/" style="font-size: 10px;">淘宝</a> <a href="/tags/设计模式/" style="font-size: 10px;">设计模式</a> <a href="/tags/高可用/" style="font-size: 10px;">高可用</a>
    </div>
</div>

        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2020/05/">
                <span class="level-start">
                    <span class="level-item">五月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">10</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/04/">
                <span class="level-start">
                    <span class="level-item">四月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/03/">
                <span class="level-start">
                    <span class="level-item">三月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/02/">
                <span class="level-start">
                    <span class="level-item">二月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/01/">
                <span class="level-start">
                    <span class="level-item">一月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">13</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/11/">
                <span class="level-start">
                    <span class="level-item">十一月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">11</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/10/">
                <span class="level-start">
                    <span class="level-item">十月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">28</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/09/">
                <span class="level-start">
                    <span class="level-item">九月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">40</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/08/">
                <span class="level-start">
                    <span class="level-item">八月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">13</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/07/">
                <span class="level-start">
                    <span class="level-item">七月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">66</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/06/">
                <span class="level-start">
                    <span class="level-item">六月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">22</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Tags
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/AOP/">
                        <span class="tag">AOP</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/CI-CD/">
                        <span class="tag">CI/CD</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ELASTICSEARCH/">
                        <span class="tag">ELASTICSEARCH</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/EXCEL/">
                        <span class="tag">EXCEL</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Eureka/">
                        <span class="tag">Eureka</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/GO/">
                        <span class="tag">GO</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/IDEA/">
                        <span class="tag">IDEA</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/IT/">
                        <span class="tag">IT</span>
                        <span class="tag is-grey">6</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/JAVAEE/">
                        <span class="tag">JAVAEE</span>
                        <span class="tag is-grey">130</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/JAVASCRIPT/">
                        <span class="tag">JAVASCRIPT</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/JAVASE/">
                        <span class="tag">JAVASE</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/LINUX/">
                        <span class="tag">LINUX</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Linux/">
                        <span class="tag">Linux</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MAC/">
                        <span class="tag">MAC</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MQ/">
                        <span class="tag">MQ</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ONOS/">
                        <span class="tag">ONOS</span>
                        <span class="tag is-grey">7</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/OSGI/">
                        <span class="tag">OSGI</span>
                        <span class="tag is-grey">6</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/OSI/">
                        <span class="tag">OSI</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/PROTOCAL/">
                        <span class="tag">PROTOCAL</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/PYTHON/">
                        <span class="tag">PYTHON</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Quartz/">
                        <span class="tag">Quartz</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/RPM/">
                        <span class="tag">RPM</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Ribbon/">
                        <span class="tag">Ribbon</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/SECURITY/">
                        <span class="tag">SECURITY</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/SPRING-BOOT/">
                        <span class="tag">SPRING-BOOT</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/SQL/">
                        <span class="tag">SQL</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/SQLAlert/">
                        <span class="tag">SQLAlert</span>
                        <span class="tag is-grey">13</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/SSO/">
                        <span class="tag">SSO</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/StringRedisTemplate/">
                        <span class="tag">StringRedisTemplate</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/TCP/">
                        <span class="tag">TCP</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/TK-MYBATIS/">
                        <span class="tag">TK.MYBATIS</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/UDP/">
                        <span class="tag">UDP</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/annotation/">
                        <span class="tag">annotation</span>
                        <span class="tag is-grey">7</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/bazel/">
                        <span class="tag">bazel</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/beanutils/">
                        <span class="tag">beanutils</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/centos/">
                        <span class="tag">centos</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/classloader/">
                        <span class="tag">classloader</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/computer/">
                        <span class="tag">computer</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/cron/">
                        <span class="tag">cron</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/debug/">
                        <span class="tag">debug</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/docker/">
                        <span class="tag">docker</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/druid/">
                        <span class="tag">druid</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/elasticsearch/">
                        <span class="tag">elasticsearch</span>
                        <span class="tag is-grey">5</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/enlink/">
                        <span class="tag">enlink</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/fastjson/">
                        <span class="tag">fastjson</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/git/">
                        <span class="tag">git</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/gitlab/">
                        <span class="tag">gitlab</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/go/">
                        <span class="tag">go</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/hexo/">
                        <span class="tag">hexo</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/idea/">
                        <span class="tag">idea</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/interceptor/">
                        <span class="tag">interceptor</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/jetty/">
                        <span class="tag">jetty</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/jpa/">
                        <span class="tag">jpa</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/json/">
                        <span class="tag">json</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/karaf/">
                        <span class="tag">karaf</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/keepalived/">
                        <span class="tag">keepalived</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/linux-shell/">
                        <span class="tag">linux-shell</span>
                        <span class="tag is-grey">7</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/listener/">
                        <span class="tag">listener</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/loadbalanced/">
                        <span class="tag">loadbalanced</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/logback/">
                        <span class="tag">logback</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/login/">
                        <span class="tag">login</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/lombok/">
                        <span class="tag">lombok</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/mac/">
                        <span class="tag">mac</span>
                        <span class="tag is-grey">7</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/markdown/">
                        <span class="tag">markdown</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/mybatis/">
                        <span class="tag">mybatis</span>
                        <span class="tag is-grey">11</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/mycat/">
                        <span class="tag">mycat</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/mysql/">
                        <span class="tag">mysql</span>
                        <span class="tag is-grey">9</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/network/">
                        <span class="tag">network</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/oauth2/">
                        <span class="tag">oauth2</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/pagehelper/">
                        <span class="tag">pagehelper</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/postman/">
                        <span class="tag">postman</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/python/">
                        <span class="tag">python</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/rabbitMq/">
                        <span class="tag">rabbitMq</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/redis/">
                        <span class="tag">redis</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/redisTemplate/">
                        <span class="tag">redisTemplate</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/reflection/">
                        <span class="tag">reflection</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/registry-center/">
                        <span class="tag">registry center</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/restTemplate/">
                        <span class="tag">restTemplate</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ribbon/">
                        <span class="tag">ribbon</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/serialVersionUID/">
                        <span class="tag">serialVersionUID</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/servlet/">
                        <span class="tag">servlet</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/session/">
                        <span class="tag">session</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/spring/">
                        <span class="tag">spring</span>
                        <span class="tag is-grey">7</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/spring-task/">
                        <span class="tag">spring task</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/springboot/">
                        <span class="tag">springboot</span>
                        <span class="tag is-grey">43</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/swagger/">
                        <span class="tag">swagger</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/webClient/">
                        <span class="tag">webClient</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/yaml/">
                        <span class="tag">yaml</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/事物/">
                        <span class="tag">事物</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/全局异常/">
                        <span class="tag">全局异常</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/分布式/">
                        <span class="tag">分布式</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/抖音/">
                        <span class="tag">抖音</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/文件服务器/">
                        <span class="tag">文件服务器</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/日志/">
                        <span class="tag">日志</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/时间转化/">
                        <span class="tag">时间转化</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/标签1/">
                        <span class="tag">标签1</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/消息队列/">
                        <span class="tag">消息队列</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/淘宝/">
                        <span class="tag">淘宝</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/设计模式/">
                        <span class="tag">设计模式</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/高可用/">
                        <span class="tag">高可用</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-128x128 has-mb-6">
                        <img class="" src="/images/avatar.png" alt="Joe">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        Joe
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        Learning
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Your location</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Posts
                    </p>
                    <p class="title has-text-weight-normal">
                        220
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Categories
                    </p>
                    <p class="title has-text-weight-normal">
                        15
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Tags
                    </p>
                    <p class="title has-text-weight-normal">
                        100
                    </p>
                </div>
            </div>
        </nav>
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/ppoffice" target="_blank">
                Follow</a>
        </div>
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Github" href="https://github.com/joeithub">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Facebook" href="https://facebook.com">
                
                <i class="fab fa-facebook"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Twitter" href="https://twitter.com">
                
                <i class="fab fa-twitter"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Dribbble" href="https://dribbble.com">
                
                <i class="fab fa-dribbble"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="RSS" href="/">
                
                <i class="fas fa-rss"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Categories
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/ES/">
            <span class="level-start">
                <span class="level-item">ES</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/GIT/">
            <span class="level-start">
                <span class="level-item">GIT</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/IT/">
            <span class="level-start">
                <span class="level-item">IT</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">194</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/JAVAEE/">
            <span class="level-start">
                <span class="level-item">JAVAEE</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/JAVAEE/DESIGN-PATTERNS/">
            <span class="level-start">
                <span class="level-item">DESIGN PATTERNS</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/JAVAEE/MYBATIS/">
            <span class="level-start">
                <span class="level-item">MYBATIS</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/JAVAEE/MYSQL/">
            <span class="level-start">
                <span class="level-item">MYSQL</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/SPRINGBOOT/">
            <span class="level-start">
                <span class="level-item">SPRINGBOOT</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/SPRINGBOOT/SECURITY/">
            <span class="level-start">
                <span class="level-item">SECURITY</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/SYSTEM/">
            <span class="level-start">
                <span class="level-item">SYSTEM</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">6</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/VIM/">
            <span class="level-start">
                <span class="level-item">VIM</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/WORK/">
            <span class="level-start">
                <span class="level-item">WORK</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/office/">
            <span class="level-start">
                <span class="level-item">office</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/分类1/">
            <span class="level-start">
                <span class="level-item">分类1</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/电商/">
            <span class="level-start">
                <span class="level-item">电商</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Tag Cloud
        </h3>
        <a href="/tags/AOP/" style="font-size: 10px;">AOP</a> <a href="/tags/CI-CD/" style="font-size: 10px;">CI/CD</a> <a href="/tags/ELASTICSEARCH/" style="font-size: 10px;">ELASTICSEARCH</a> <a href="/tags/EXCEL/" style="font-size: 10px;">EXCEL</a> <a href="/tags/Eureka/" style="font-size: 10.91px;">Eureka</a> <a href="/tags/GO/" style="font-size: 10px;">GO</a> <a href="/tags/IDEA/" style="font-size: 10.91px;">IDEA</a> <a href="/tags/IT/" style="font-size: 14.55px;">IT</a> <a href="/tags/JAVAEE/" style="font-size: 20px;">JAVAEE</a> <a href="/tags/JAVASCRIPT/" style="font-size: 11.82px;">JAVASCRIPT</a> <a href="/tags/JAVASE/" style="font-size: 10.91px;">JAVASE</a> <a href="/tags/LINUX/" style="font-size: 10px;">LINUX</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/MAC/" style="font-size: 10px;">MAC</a> <a href="/tags/MQ/" style="font-size: 11.82px;">MQ</a> <a href="/tags/ONOS/" style="font-size: 15.45px;">ONOS</a> <a href="/tags/OSGI/" style="font-size: 14.55px;">OSGI</a> <a href="/tags/OSI/" style="font-size: 10px;">OSI</a> <a href="/tags/PROTOCAL/" style="font-size: 10px;">PROTOCAL</a> <a href="/tags/PYTHON/" style="font-size: 10.91px;">PYTHON</a> <a href="/tags/Quartz/" style="font-size: 10px;">Quartz</a> <a href="/tags/RPM/" style="font-size: 10px;">RPM</a> <a href="/tags/Ribbon/" style="font-size: 10px;">Ribbon</a> <a href="/tags/SECURITY/" style="font-size: 10px;">SECURITY</a> <a href="/tags/SPRING-BOOT/" style="font-size: 10px;">SPRING-BOOT</a> <a href="/tags/SQL/" style="font-size: 12.73px;">SQL</a> <a href="/tags/SQLAlert/" style="font-size: 18.18px;">SQLAlert</a> <a href="/tags/SSO/" style="font-size: 10px;">SSO</a> <a href="/tags/StringRedisTemplate/" style="font-size: 10px;">StringRedisTemplate</a> <a href="/tags/TCP/" style="font-size: 10px;">TCP</a> <a href="/tags/TK-MYBATIS/" style="font-size: 10px;">TK.MYBATIS</a> <a href="/tags/UDP/" style="font-size: 10px;">UDP</a> <a href="/tags/annotation/" style="font-size: 15.45px;">annotation</a> <a href="/tags/bazel/" style="font-size: 10px;">bazel</a> <a href="/tags/beanutils/" style="font-size: 10px;">beanutils</a> <a href="/tags/centos/" style="font-size: 10px;">centos</a> <a href="/tags/classloader/" style="font-size: 10px;">classloader</a> <a href="/tags/computer/" style="font-size: 10px;">computer</a> <a href="/tags/cron/" style="font-size: 10px;">cron</a> <a href="/tags/debug/" style="font-size: 10px;">debug</a> <a href="/tags/docker/" style="font-size: 12.73px;">docker</a> <a href="/tags/druid/" style="font-size: 10px;">druid</a> <a href="/tags/elasticsearch/" style="font-size: 13.64px;">elasticsearch</a> <a href="/tags/enlink/" style="font-size: 10.91px;">enlink</a> <a href="/tags/fastjson/" style="font-size: 10px;">fastjson</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/gitlab/" style="font-size: 10px;">gitlab</a> <a href="/tags/go/" style="font-size: 10px;">go</a> <a href="/tags/hexo/" style="font-size: 12.73px;">hexo</a> <a href="/tags/idea/" style="font-size: 10.91px;">idea</a> <a href="/tags/interceptor/" style="font-size: 11.82px;">interceptor</a> <a href="/tags/jetty/" style="font-size: 10px;">jetty</a> <a href="/tags/jpa/" style="font-size: 10.91px;">jpa</a> <a href="/tags/json/" style="font-size: 10px;">json</a> <a href="/tags/karaf/" style="font-size: 11.82px;">karaf</a> <a href="/tags/keepalived/" style="font-size: 10px;">keepalived</a> <a href="/tags/linux-shell/" style="font-size: 15.45px;">linux-shell</a> <a href="/tags/listener/" style="font-size: 10px;">listener</a> <a href="/tags/loadbalanced/" style="font-size: 10px;">loadbalanced</a> <a href="/tags/logback/" style="font-size: 10px;">logback</a> <a href="/tags/login/" style="font-size: 10.91px;">login</a> <a href="/tags/lombok/" style="font-size: 11.82px;">lombok</a> <a href="/tags/mac/" style="font-size: 15.45px;">mac</a> <a href="/tags/markdown/" style="font-size: 11.82px;">markdown</a> <a href="/tags/mybatis/" style="font-size: 17.27px;">mybatis</a> <a href="/tags/mycat/" style="font-size: 10.91px;">mycat</a> <a href="/tags/mysql/" style="font-size: 16.36px;">mysql</a> <a href="/tags/network/" style="font-size: 12.73px;">network</a> <a href="/tags/oauth2/" style="font-size: 10px;">oauth2</a> <a href="/tags/pagehelper/" style="font-size: 10px;">pagehelper</a> <a href="/tags/postman/" style="font-size: 10px;">postman</a> <a href="/tags/python/" style="font-size: 11.82px;">python</a> <a href="/tags/rabbitMq/" style="font-size: 11.82px;">rabbitMq</a> <a href="/tags/redis/" style="font-size: 11.82px;">redis</a> <a href="/tags/redisTemplate/" style="font-size: 10px;">redisTemplate</a> <a href="/tags/reflection/" style="font-size: 11.82px;">reflection</a> <a href="/tags/registry-center/" style="font-size: 10px;">registry center</a> <a href="/tags/restTemplate/" style="font-size: 10px;">restTemplate</a> <a href="/tags/ribbon/" style="font-size: 10px;">ribbon</a> <a href="/tags/serialVersionUID/" style="font-size: 10px;">serialVersionUID</a> <a href="/tags/servlet/" style="font-size: 10.91px;">servlet</a> <a href="/tags/session/" style="font-size: 10.91px;">session</a> <a href="/tags/spring/" style="font-size: 15.45px;">spring</a> <a href="/tags/spring-task/" style="font-size: 12.73px;">spring task</a> <a href="/tags/springboot/" style="font-size: 19.09px;">springboot</a> <a href="/tags/swagger/" style="font-size: 10px;">swagger</a> <a href="/tags/webClient/" style="font-size: 10px;">webClient</a> <a href="/tags/yaml/" style="font-size: 10.91px;">yaml</a> <a href="/tags/事物/" style="font-size: 10px;">事物</a> <a href="/tags/全局异常/" style="font-size: 10px;">全局异常</a> <a href="/tags/分布式/" style="font-size: 10px;">分布式</a> <a href="/tags/抖音/" style="font-size: 10px;">抖音</a> <a href="/tags/文件服务器/" style="font-size: 10.91px;">文件服务器</a> <a href="/tags/日志/" style="font-size: 10px;">日志</a> <a href="/tags/时间转化/" style="font-size: 10px;">时间转化</a> <a href="/tags/标签1/" style="font-size: 10px;">标签1</a> <a href="/tags/消息队列/" style="font-size: 10px;">消息队列</a> <a href="/tags/淘宝/" style="font-size: 10px;">淘宝</a> <a href="/tags/设计模式/" style="font-size: 10px;">设计模式</a> <a href="/tags/高可用/" style="font-size: 10px;">高可用</a>
    </div>
</div>

    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2020/05/">
                <span class="level-start">
                    <span class="level-item">五月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">10</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/04/">
                <span class="level-start">
                    <span class="level-item">四月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/03/">
                <span class="level-start">
                    <span class="level-item">三月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/02/">
                <span class="level-start">
                    <span class="level-item">二月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/01/">
                <span class="level-start">
                    <span class="level-item">一月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">13</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/11/">
                <span class="level-start">
                    <span class="level-item">十一月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">11</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/10/">
                <span class="level-start">
                    <span class="level-item">十月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">28</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/09/">
                <span class="level-start">
                    <span class="level-item">九月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">40</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/08/">
                <span class="level-start">
                    <span class="level-item">八月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">13</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/07/">
                <span class="level-start">
                    <span class="level-item">七月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">66</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/06/">
                <span class="level-start">
                    <span class="level-item">六月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">22</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Tags
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/AOP/">
                        <span class="tag">AOP</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/CI-CD/">
                        <span class="tag">CI/CD</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ELASTICSEARCH/">
                        <span class="tag">ELASTICSEARCH</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/EXCEL/">
                        <span class="tag">EXCEL</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Eureka/">
                        <span class="tag">Eureka</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/GO/">
                        <span class="tag">GO</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/IDEA/">
                        <span class="tag">IDEA</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/IT/">
                        <span class="tag">IT</span>
                        <span class="tag is-grey">6</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/JAVAEE/">
                        <span class="tag">JAVAEE</span>
                        <span class="tag is-grey">130</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/JAVASCRIPT/">
                        <span class="tag">JAVASCRIPT</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/JAVASE/">
                        <span class="tag">JAVASE</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/LINUX/">
                        <span class="tag">LINUX</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Linux/">
                        <span class="tag">Linux</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MAC/">
                        <span class="tag">MAC</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MQ/">
                        <span class="tag">MQ</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ONOS/">
                        <span class="tag">ONOS</span>
                        <span class="tag is-grey">7</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/OSGI/">
                        <span class="tag">OSGI</span>
                        <span class="tag is-grey">6</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/OSI/">
                        <span class="tag">OSI</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/PROTOCAL/">
                        <span class="tag">PROTOCAL</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/PYTHON/">
                        <span class="tag">PYTHON</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Quartz/">
                        <span class="tag">Quartz</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/RPM/">
                        <span class="tag">RPM</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Ribbon/">
                        <span class="tag">Ribbon</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/SECURITY/">
                        <span class="tag">SECURITY</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/SPRING-BOOT/">
                        <span class="tag">SPRING-BOOT</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/SQL/">
                        <span class="tag">SQL</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/SQLAlert/">
                        <span class="tag">SQLAlert</span>
                        <span class="tag is-grey">13</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/SSO/">
                        <span class="tag">SSO</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/StringRedisTemplate/">
                        <span class="tag">StringRedisTemplate</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/TCP/">
                        <span class="tag">TCP</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/TK-MYBATIS/">
                        <span class="tag">TK.MYBATIS</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/UDP/">
                        <span class="tag">UDP</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/annotation/">
                        <span class="tag">annotation</span>
                        <span class="tag is-grey">7</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/bazel/">
                        <span class="tag">bazel</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/beanutils/">
                        <span class="tag">beanutils</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/centos/">
                        <span class="tag">centos</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/classloader/">
                        <span class="tag">classloader</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/computer/">
                        <span class="tag">computer</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/cron/">
                        <span class="tag">cron</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/debug/">
                        <span class="tag">debug</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/docker/">
                        <span class="tag">docker</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/druid/">
                        <span class="tag">druid</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/elasticsearch/">
                        <span class="tag">elasticsearch</span>
                        <span class="tag is-grey">5</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/enlink/">
                        <span class="tag">enlink</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/fastjson/">
                        <span class="tag">fastjson</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/git/">
                        <span class="tag">git</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/gitlab/">
                        <span class="tag">gitlab</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/go/">
                        <span class="tag">go</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/hexo/">
                        <span class="tag">hexo</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/idea/">
                        <span class="tag">idea</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/interceptor/">
                        <span class="tag">interceptor</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/jetty/">
                        <span class="tag">jetty</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/jpa/">
                        <span class="tag">jpa</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/json/">
                        <span class="tag">json</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/karaf/">
                        <span class="tag">karaf</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/keepalived/">
                        <span class="tag">keepalived</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/linux-shell/">
                        <span class="tag">linux-shell</span>
                        <span class="tag is-grey">7</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/listener/">
                        <span class="tag">listener</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/loadbalanced/">
                        <span class="tag">loadbalanced</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/logback/">
                        <span class="tag">logback</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/login/">
                        <span class="tag">login</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/lombok/">
                        <span class="tag">lombok</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/mac/">
                        <span class="tag">mac</span>
                        <span class="tag is-grey">7</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/markdown/">
                        <span class="tag">markdown</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/mybatis/">
                        <span class="tag">mybatis</span>
                        <span class="tag is-grey">11</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/mycat/">
                        <span class="tag">mycat</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/mysql/">
                        <span class="tag">mysql</span>
                        <span class="tag is-grey">9</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/network/">
                        <span class="tag">network</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/oauth2/">
                        <span class="tag">oauth2</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/pagehelper/">
                        <span class="tag">pagehelper</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/postman/">
                        <span class="tag">postman</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/python/">
                        <span class="tag">python</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/rabbitMq/">
                        <span class="tag">rabbitMq</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/redis/">
                        <span class="tag">redis</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/redisTemplate/">
                        <span class="tag">redisTemplate</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/reflection/">
                        <span class="tag">reflection</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/registry-center/">
                        <span class="tag">registry center</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/restTemplate/">
                        <span class="tag">restTemplate</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ribbon/">
                        <span class="tag">ribbon</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/serialVersionUID/">
                        <span class="tag">serialVersionUID</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/servlet/">
                        <span class="tag">servlet</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/session/">
                        <span class="tag">session</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/spring/">
                        <span class="tag">spring</span>
                        <span class="tag is-grey">7</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/spring-task/">
                        <span class="tag">spring task</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/springboot/">
                        <span class="tag">springboot</span>
                        <span class="tag is-grey">43</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/swagger/">
                        <span class="tag">swagger</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/webClient/">
                        <span class="tag">webClient</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/yaml/">
                        <span class="tag">yaml</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/事物/">
                        <span class="tag">事物</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/全局异常/">
                        <span class="tag">全局异常</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/分布式/">
                        <span class="tag">分布式</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/抖音/">
                        <span class="tag">抖音</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/文件服务器/">
                        <span class="tag">文件服务器</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/日志/">
                        <span class="tag">日志</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/时间转化/">
                        <span class="tag">时间转化</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/标签1/">
                        <span class="tag">标签1</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/消息队列/">
                        <span class="tag">消息队列</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/淘宝/">
                        <span class="tag">淘宝</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/设计模式/">
                        <span class="tag">设计模式</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/高可用/">
                        <span class="tag">高可用</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.svg" alt="Learning" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2020 Joe Tong&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh_CN");</script>

<script>
var IcarusThemeSettings = {
    article: {
        highlight: {
            clipboard: true,
            fold: 'unfolded'
        }
    }
};
</script>


    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>



    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>

    
    

<a id="back-to-top" title="Back to Top" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    

    
    
    
    

    
    
    
    
    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>