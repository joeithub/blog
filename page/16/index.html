<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>Learning</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="private learning">
<meta property="og:type" content="website">
<meta property="og:title" content="Learning">
<meta property="og:url" content="/blog/page/16/index.html">
<meta property="og:site_name" content="Learning">
<meta property="og:description" content="private learning">
<meta property="og:locale" content="zh_CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Learning">
<meta name="twitter:description" content="private learning">
  
    <link rel="alternate" href="/atom.xml" title="Learning" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Learning</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Joe&#39;s Blog</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="/blog"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-serialVersionUID-idea-生成" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/25/serialVersionUID-idea-生成/" class="article-date">
  <time datetime="2019-07-25T14:19:00.000Z" itemprop="datePublished">2019-07-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/IT/">IT</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/25/serialVersionUID-idea-生成/">serialVersionUID idea 生成</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>1.进入到设置<br><img src="/images/pasted-30.png" alt="upload successful"><br>2.设置之后，选中对应的类名，然后按 alt+enter 快捷键 的情况如下所示<br><img src="/images/pasted-31.png" alt="upload successful"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="/blog/2019/07/25/serialVersionUID-idea-生成/" data-id="ckbdc9uvi00cq24u228ywzwpz" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/IDEA/">IDEA</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JAVAEE/">JAVAEE</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SERIALVERSIONUID/">SERIALVERSIONUID</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-SuppressWarning" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/25/SuppressWarning/" class="article-date">
  <time datetime="2019-07-25T13:15:00.000Z" itemprop="datePublished">2019-07-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/IT/">IT</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/25/SuppressWarning/">@SuppressWarning</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>@SuppressWarnings(“rawtypes”) 是什么含义</p>
<p>简介：java.lang.SuppressWarnings是J2SE 5.0中标准的Annotation之一。可以标注在类、字段、方法、参数、构造方法，以及局部变量上。<br>作用：告诉编译器忽略指定的警告，不用在编译完成后出现警告信息。<br>使用：<br>@SuppressWarnings(“”)<br>@SuppressWarnings({})<br>@SuppressWarnings(value={})<br>根据sun的官方文档描述：<br>value - 将由编译器在注释的元素中取消显示的警告集。允许使用重复的名称。忽略第二个和后面出现的名称。出现未被识别的警告名不是 错误：编译器必须忽略无法识别的所有警告名。但如果某个注释包含未被识别的警告名，那么编译器可以随意发出一个警告。<br>各编译器供应商应该将它们所支持的警告名连同注释类型一起记录。鼓励各供应商之间相互合作，确保在多个编译器中使用相同的名称。<br>示例：<br>·   @SuppressWarnings(“unchecked”)<br>告诉编译器忽略 unchecked 警告信息，如使用List，ArrayList等未进行参数化产生的警告信息。<br>·   @SuppressWarnings(“serial”)<br>如果编译器出现这样的警告信息：The serializable class WmailCalendar does not declare a static final serialVersionUID field of type long<br>       使用这个注释将警告信息去掉。<br>·   @SuppressWarnings(“deprecation”)<br>如果使用了使用@Deprecated注释的方法，编译器将出现警告信息。<br>       使用这个注释将警告信息去掉。<br>·   @SuppressWarnings(“unchecked”, “deprecation”)<br>告诉编译器同时忽略unchecked和deprecation的警告信息。<br>·   @SuppressWarnings(value={“unchecked”, “deprecation”})<br>等同于@SuppressWarnings(“unchecked”, “deprecation”)  </p>
<p>SuppressWarnings压制警告，即去除警告<br>rawtypes是说传参时也要传递带泛型的参数<br>@SuppressWarnings(“unchecked”)<br>告诉编译器忽略 unchecked 警告信息，如使用List，ArrayList等未进行参数化产生的警告信息。  </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="/blog/2019/07/25/SuppressWarning/" data-id="ckbdc9usx006424u28ik0de6t" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ANNOTATION/">ANNOTATION</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JAVAEE/">JAVAEE</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-KARAF" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/24/KARAF/" class="article-date">
  <time datetime="2019-07-24T19:18:00.000Z" itemprop="datePublished">2019-07-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/IT/">IT</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/24/KARAF/">KARAF</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Karaf：简述对Karaf的认识</p>
<p>Karaf是基于OSGI之上建立的应用容器，能方便部署各种选定的组件，简化打包和安装应用的操作难度。Open DayLight项目发布之初，后台框架仅采用OSG技术，但自从第三版氦He版本至今， Open Daylight项目就采用了Kaaf作为后台的框架，明显提升了项目的可用性和灵活性。<br>Karaf是一个 Apache软件基金会项目，具有 Apache v2许可证。是一个基于实时运行的轻量级的基于OSGI的容器，各种组件和应用都能部署到这个容器中。<br>一、Karaf 的架构图 &nbsp;<br><img src="/images/pasted-27.png" alt="upload successful"><br>二、Karaf 的安装目录结构 &nbsp;</p>
<p>/bin: 启动脚本<br>/etc: 初始化文件<br>/data: 工作目录<br>/cache: OSGi框架包缓存<br>/generated-bundles: 部署使用的临时文件夹<br>/log: 日志文件<br>/deploy: 热部署目录<br>/instances: 含有子实例的目录<br>/lib: 包含引导库<br>/lib/ext:JRE扩展目录<br>/lib/endorsed: 赞同库目录<br>/system: OSGi包库，作为一个Maven2存储库  </p>
<p>三、Karaf的基本特性<br>Karaf典型的特性有:<br>热部署： Karaf支持 OSGI bundles的热部署。实现这个支持的关键在于 Karaf持续监测[home]/deply目录内的jar文件。每次当一个jar文件被复制到这个文件夹内，它将在运行时被安装。可以更新或删除它，这个改动将被自动处理。此外， Karaf也支持 exploded bundles和自定义的部署(默认包含 blueprint和 spring)<br>动态配置：服务通常通过OsGi服务的配置管理来进行配置。这样的配置可在 Karaf中的[home]/ec目录使用合适的文件进行定义。这样配置被监控，并且属性的改变将传播给服务。<br>日志系统：使用Log4J支持的集中日志后端，Kaaf能支持许多不同的APls(JDK14、JCL、SLF4J、 Avalon、 Tomcat、OSGi)。<br>供应：库或应用的供应( Provisioning)能通过不同的方式完成。供应在本地下载、安装、启动。<br>原生OS整合：Karaf能以服务的方式整合到一个操作系统OS中，这样生命周期就和这个OS相绑定。<br>扩展的内核控制台：Karaf的内核控制台可管理服务，安装新应用或库，并且管理它们的状态。这个内核能通过部署新命令以安装新功能或应用实现动态扩展。<br>远程访问：使用任何的SSH客户端以连接Karaf并且在控制台发出命令。<br>基于JAAS的安全框架。<br>管理实例：Karaf提供简单的命令以管理多实例。通过控制台能简单地创建、删除、启动、终止 Karaf的实例。<br>四、karaf在 Open Daylight使用中的一些常用命令<br>[cmd]-help：获取一个指定命令的相关帮助。<br><code>若需要了解 bundle: list命令，则输入:bundle: list --help; Karat将返回有关这个命令的帮助。</code><br>features: list：查看已安装的 features。<br><code>feature: install my_feature：安装本地 feature的命令。</code><br>如 <code>feature: install odl-reston。</code><br><code>feature:uninstall my_feature</code>:卸载已经安装的fm的命令。<br>如  
<code>feature uninstall odl-restconf</code> </p>
<p><code>feature: repo-add my repo：将库安装至本地。</code><br>如 <code>feature: repo-add camel2.152</code></p>
<p>log: display：显示系统日志，可配合grep来筛选需要查看的内容。<br>system: shutdown：关闭系统，退出 Karaf。同样也可运行halt命令退出 Karaf。<br>注意:<br>进入 Karaf的控制台后，按&lt; Tab &gt;键即可显示目前所有可用的命令。<br>控制台支持&lt; Tab &gt;键的输入辅助完成功能，当输入一个命令的前面一些字符时，按&lt; Tab &gt;键后，控制台将自动列出所有可能的命令，并且在只有一个提示命令时自动完成该命令的输入。</p>
<p>Karaf教程之安装和应用开发</p>
<p>概览</p>
<p>安装和启动</p>
<p>一些便利的命令</p>
<p>Tasklist - 一个小的OSGI应用</p>
<p>父pom和通用工程的设置</p>
<p>Tasklist-model</p>
<p>Tasklist-persistence</p>
<p>Tasklist-ui</p>
<p>Tasklist-features</p>
<p>在Karaf中安装应用</p>
<p>总结</p>
<p>概览</p>
<p>以这篇文章为起点，我将开始写一系列关于Apache Karaf的文章，Apache Karaf是一个基于Equinox或者Felix框架开发的一个OSGI容器。<br>与这些框架最大的不同在于它带来了优秀的管理功能。</p>
<p>Karaf突出的特性如下: </p>
<ul>
<li>可扩展控制台和Bash相似的命令补齐功能 </li>
<li>ssh控制台 </li>
<li>从maven仓库中获取bundles和features的部署文件 </li>
<li>可以在命令行中轻松的创建一个新的实例</li>
</ul>
<p>所有这些特性使开发服务端OSGi应用和开发一般的java应用几乎一样的简单。<br>从某个层面上，部署和管理比目前我知道所有应用服务器都好。所有这些karaf特性的结合带来了最终的程序。在我看来，Karaf允许轻量级的开发风格就像J2EE结合spring应用程序的灵活性一样。</p>
<p>安装和启动</p>
<p>从karaf官网下载Karaf4.0.7。<br>解压并运行bin/karaf。<br>一些便利的命令</p>
<table>
<thead>
<tr>
<th align="left">命令</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">la</td>
<td align="left">显示所有安装的bundle</td>
</tr>
<tr>
<td align="left">list</td>
<td align="left">显示用户的bundle</td>
</tr>
<tr>
<td align="left">service:list</td>
<td align="left">显示active的OSGI服务。这个列表十分长。这里有一个方便的方法，就是你可以使用unix的管道，如 “ls</td>
</tr>
<tr>
<td align="left">exports</td>
<td align="left">显示导出的packages和bundles，这个命令可以帮助你查找出package是来自哪里</td>
</tr>
<tr>
<td align="left">feature:list</td>
<td align="left">显示所有feature包括已安装和未安装的</td>
</tr>
<tr>
<td align="left">feature:install webconsole</td>
<td align="left">访问<a href="http://localhost:8181/system/console，用karaf/karaf登录并花些时间看下它所提供的信息" target="_blank" rel="noopener">http://localhost:8181/system/console，用karaf/karaf登录并花些时间看下它所提供的信息</a></td>
</tr>
<tr>
<td align="left">diag</td>
<td align="left">显示那些无法启动的bundle的诊断信息</td>
</tr>
<tr>
<td align="left">log:tail</td>
<td align="left">显示日志。可以按ctrl-c返回控制台</td>
</tr>
<tr>
<td align="left">Ctrl-d</td>
<td align="left">退出控制台。如果是主控制台，则karaf被关闭</td>
</tr>
<tr>
<td align="left">重启后OSGI容器会保存状态</td>
<td align="left"></td>
</tr>
</tbody></table>
<p>注意Karaf和其他所有的OSGI容器一样会维护已安装和已启动的bundles的最后状态。所以如果有些组件再也不能工作，重启也不一定有所帮助。为了启动一个全新的Karaf，可以停止karaf然后删除data目录或者启动的时候加个clean参数bin/karaf clean。</p>
<p>检查日志</p>
<p>Karaf运行的时候非常安静。为了不错过错误消息，可以运行tail -f data/karaf.log让日志文件处于打开状态。</p>
<p>Tasklist - 一个小的OSGI应用</p>
<p>没有任何有用的应用，Karaf是一个很棒但是没用的容器。所以让我们来创建第一个应用吧。好消息是创建一个OSGI应用非常的简单，maven会处理很多事情。和一个正常的maven工程的差异是非常少的。我推荐使用Eclipse 4写应用程序，Eclipse 4默认已经安装m2eclipse插件。</p>
<p>从github的Karaf-Tutorial仓库中获取源码。</p>
<p><code>git clone https://github.com/cschneider/Karaf-Tutorial.git</code>  </p>
<p>或者从 <a href="https://github.com/cschneider/Karaf-Tutorial/zipball/master" target="_blank" rel="noopener">https://github.com/cschneider/Karaf-Tutorial/zipball/master</a> 下载示例工程，然后解压到某个目录下。  </p>
<p>导入到Eclipse   </p>
<ul>
<li>启动Eclipse Neon或者更新版本。   </li>
<li>在Eclipse中选择File -&gt; Import -&gt; Existing maven project -&gt; Browse到刚才解压的目录选择tasklist 子文件夹。   </li>
<li>Eclipse将显示所有它找到的maven工程。   </li>
<li>单击默认导入所有工程。  </li>
</ul>
<p>Eclipse将导入所有的工程并使用m2eclipse插件管理它们之间所有的依赖。  </p>
<p>tasklist有以下这些工程组成。  </p>
<table>
<thead>
<tr>
<th align="left">模块</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">tasklist-model</td>
<td align="left">服务接口和Task类</td>
</tr>
<tr>
<td align="left">tasklist-persistence</td>
<td align="left">提供了一个TaskService接口的简单持久化实现</td>
</tr>
<tr>
<td align="left">tasklist-ui</td>
<td align="left">使用TaskService显示任务列表的servlet</td>
</tr>
<tr>
<td align="left">tasklist-features</td>
<td align="left">为应用提供features的描述信息，使应用能够很容易的安装到Karaf容器中</td>
</tr>
<tr>
<td align="left">父pom和通用工程的设置</td>
<td align="left"></td>
</tr>
</tbody></table>
<p>pom.xml打包bundle，而maven-bundle-plugin创建具有OSGi Manifest信息的jar包。默认情况，插件导入java文件import的或者在bluneprint上下文引用的所有的包。同时导出不包含内部实现的所有包。在我们的例子中我们想要model包被导入，但是persistence的实现包不导入。按照命名约定，我们不需要额外的配置。</p>
<p>Tasklist-model</p>
<p>这个工程包含domain model，这里指Task类和TaskService接口。model同时被persistence工程和用户界面工程使用。任意TaskService服务的使用者只需要依赖model工程。所以不用直接绑定到当前的实现。</p>
<p>Tasklist-persistence</p>
<p>简单持久化实现的TaskServiceImpl类用一个简单的HashMap管理task。类用@Singleton注解标记自己为blueprint bean。注解@OsgiServiceProvider用于标记为自己是一个OSGi服务，而@Properties注解允许添加服务属性。在这个例子中我们设置的属性service.exported.interfaces可以被我们在后续的教程要介绍的CXF-DOSGI使用。目前该教程这个属性可以删除。</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@OsgiServiceProvider</span></span><br><span class="line"><span class="variable">@Properties</span>(<span class="variable">@Property</span>(name = <span class="string">"service.exported.interfaces"</span>, value = <span class="string">"*"</span>))</span><br><span class="line"><span class="variable">@Singleton</span></span><br><span class="line">public class TaskServiceImpl implements TaskService &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>blueprint-maven-plugin插件将处理上面的类，且自动创建合适的blueprint xml文件。这样可以帮我们节省手动写blueprint xml文件的时间。</p>
<p>自动创建的blueprint xml文件位于target/generated-resources文件夹下</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&amp;<span class="literal">lt</span>;blueprint xmlns=<span class="string">"http://www.osgi.org/xmlns/blueprint/v1.0.0"</span>&amp;<span class="literal">gt</span>;</span><br><span class="line">    &amp;<span class="literal">lt</span>;bean<span class="built_in"> id</span>=<span class="string">"taskService"</span> class=<span class="string">"net.lr.tasklist.persistence.impl.TaskServiceImpl"</span> /&amp;<span class="literal">gt</span>;</span><br><span class="line">    &amp;<span class="literal">lt</span>;service ref=<span class="string">"taskService"</span> interface=<span class="string">"net.lr.tasklist.model.TaskService"</span> /&amp;<span class="literal">gt</span>;</span><br><span class="line">&amp;<span class="literal">lt</span>;/blueprint&amp;<span class="literal">gt</span>;</span><br></pre></td></tr></table></figure>

<p>Tasklist-ui</p>
<p>UI工程使用一个TaskServlet显示任务列表和单独的任务。为了和tasks任务协作，这个servlet需要TaskService服务。我们通过使用注解@Inject和@OsgiService注入TaskService服务，@Inject注解能够根据类型注入任意的实例。而注解@OsgiService将创建一个指定类型的OSGiSerivce服务的blueprint引用。（译注：这里我是这么理解的，@OsgiService表示从Karaf中获取一个bean，@Inject则负责注入）<br>这个类被暴露为一个OSGi服务,该类是一个有特别属性alias=/tasklist的接口java.http.Servlet实现。这样做触发了pax web的whiteboard扩展器接收这个服务，并使用url /tasklist映射到该servlet。</p>
<p>相关代码小片段</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@OsgiServiceProvider</span>(classes = Servlet.class)</span><br><span class="line"><span class="variable">@Properties</span>(<span class="variable">@Property</span>(name = <span class="string">"alias"</span>, value = <span class="string">"/tasklist"</span>))</span><br><span class="line"><span class="variable">@Singleton</span></span><br><span class="line">public class TaskListServlet extends HttpServlet &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">@Inject</span> <span class="variable">@OsgiService</span></span><br><span class="line">    TaskService taskService;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>自动创建的blueprint xml文件位于target/generated-resources文件夹下</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&amp;<span class="keyword">lt</span>;blueprint <span class="attr">xmlns=</span><span class="string">"http://www.osgi.org/xmlns/blueprint/v1.0.0"</span>&amp;<span class="keyword">gt</span>;</span><br><span class="line">    &amp;<span class="keyword">lt</span>;<span class="keyword">reference</span> <span class="attr">id=</span><span class="string">"taskService"</span> <span class="attr">availability=</span><span class="string">"mandatory"</span> <span class="attr">interface=</span><span class="string">"net.lr.tasklist.model.TaskService"</span> /&amp;<span class="keyword">gt</span>;</span><br><span class="line">    &amp;<span class="keyword">lt</span>;bean <span class="attr">id=</span><span class="string">"taskServlet"</span> <span class="attr">class=</span><span class="string">"net.lr.tasklist.ui.TaskListServlet"</span>&amp;<span class="keyword">gt</span>;</span><br><span class="line">        &amp;<span class="keyword">lt</span>;<span class="keyword">property</span><span class="title"> </span><span class="attr">name=</span><span class="string">"taskService"</span> <span class="attr">ref=</span><span class="string">"taskService"</span>&amp;<span class="keyword">gt</span>;&amp;<span class="keyword">lt</span>;/<span class="keyword">property</span><span class="title"></span>&amp;<span class="keyword">gt</span>;</span><br><span class="line">    &amp;<span class="keyword">lt</span>;/bean&amp;<span class="keyword">gt</span>;</span><br><span class="line">    &amp;<span class="keyword">lt</span>;service <span class="attr">ref=</span><span class="string">"taskServlet"</span> <span class="attr">interface=</span><span class="string">"javax.servlet.http.HttpServlet"</span>&amp;<span class="keyword">gt</span>;</span><br><span class="line">        &amp;<span class="keyword">lt</span>;service-properties&amp;<span class="keyword">gt</span>;</span><br><span class="line">            &amp;<span class="keyword">lt</span>;entry <span class="attr">key=</span><span class="string">"alias"</span> <span class="attr">value=</span><span class="string">"/tasklist"</span> /&amp;<span class="keyword">gt</span>;</span><br><span class="line">        &amp;<span class="keyword">lt</span>;/service-properties&amp;<span class="keyword">gt</span>;</span><br><span class="line">    &amp;<span class="keyword">lt</span>;/service&amp;<span class="keyword">gt</span>;</span><br><span class="line">&amp;<span class="keyword">lt</span>;/blueprint&amp;<span class="keyword">gt</span>;</span><br></pre></td></tr></table></figure>

<p>Tasklist-features</p>
<p>最后一个工程仅安装一个feature描述信息文件到一个maven仓库，这样我们可以很容易的安装应用到Karaf。描述信息定义了一个叫tasklist的feature和将从maven仓库下载安装的bundles</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&amp;<span class="keyword">lt</span>;feature name=<span class="string">"example-tasklist-persistence"</span> version=<span class="string">"$&#123;pom.version&#125;"</span>&amp;<span class="keyword">gt</span>;</span><br><span class="line">    &amp;<span class="keyword">lt</span>;bundle&amp;<span class="keyword">gt</span>;mvn:net.lr.tasklist/tasklist-<span class="keyword">model</span>/<span class="symbol">$</span>&#123;pom.version&#125;&amp;<span class="keyword">lt</span>;/bundle&amp;<span class="keyword">gt</span>;</span><br><span class="line">    &amp;<span class="keyword">lt</span>;bundle&amp;<span class="keyword">gt</span>;mvn:net.lr.tasklist/tasklist-persistence/<span class="symbol">$</span>&#123;pom.version&#125;&amp;<span class="keyword">lt</span>;/bundle&amp;<span class="keyword">gt</span>;</span><br><span class="line">&amp;<span class="keyword">lt</span>;/feature&amp;<span class="keyword">gt</span>;</span><br><span class="line"></span><br><span class="line">&amp;<span class="keyword">lt</span>;feature name=<span class="string">"example-tasklist-ui"</span> version=<span class="string">"$&#123;pom.version&#125;"</span>&amp;<span class="keyword">gt</span>;</span><br><span class="line">    &amp;<span class="keyword">lt</span>;feature&amp;<span class="keyword">gt</span>;http&amp;<span class="keyword">lt</span>;/feature&amp;<span class="keyword">gt</span>;</span><br><span class="line">    &amp;<span class="keyword">lt</span>;feature&amp;<span class="keyword">gt</span>;http-whiteboard&amp;<span class="keyword">lt</span>;/feature&amp;<span class="keyword">gt</span>;</span><br><span class="line">    &amp;<span class="keyword">lt</span>;bundle&amp;<span class="keyword">gt</span>;mvn:net.lr.tasklist/tasklist-<span class="keyword">model</span>/<span class="symbol">$</span>&#123;pom.version&#125;&amp;<span class="keyword">lt</span>;/bundle&amp;<span class="keyword">gt</span>;</span><br><span class="line">    &amp;<span class="keyword">lt</span>;bundle&amp;<span class="keyword">gt</span>;mvn:net.lr.tasklist/tasklist-ui/<span class="symbol">$</span>&#123;pom.version&#125;&amp;<span class="keyword">lt</span>;/bundle&amp;<span class="keyword">gt</span>;</span><br><span class="line">&amp;<span class="keyword">lt</span>;/feature&amp;<span class="keyword">gt</span>;</span><br></pre></td></tr></table></figure>

<p>一个feature可以由其他features和bundles组成，这些features和bundles也应该被安装。一般bundles使用mvn urls。这也意味着它们从配置好的仓库或者你的本地maven仓库~/.m2/repository中加载。</p>
<p>在Karaf中安装应用</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">feature</span>:repo-add mvn:net.lr.tasklist/tasklist-<span class="built_in">features</span>/<span class="number">1.0</span>.0-SNAPSHOT/xml</span><br><span class="line"><span class="built_in">feature</span>:install <span class="built_in">example</span>-tasklist-persistence <span class="built_in">example</span>-tasklist-ui</span><br></pre></td></tr></table></figure>

<p>添加features描述信息文件到Karaf，所以它被添加到可用的features列表中，然后安装和启动tasklist feature。运行命令之后tasklist应用应该运行了。</p>
<p>list</p>
<p>检查tasklist的所有bundles是在active状态。如果没有，尝试启动它们和检查日志。</p>
<p>http:list</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ID | Servlet         | Servlet-Name   | State       | Alias     | Url</span><br><span class="line">---------------------------------------------------------------------</span><br><span class="line">56 | TaskListServlet | ServletModel-2 | Deployed    | /tasklist | [/tasklist/<span class="strong">*]</span></span><br></pre></td></tr></table></figure>

<p>应该显示TaskListServlet。默认情况下这个例子应该运行在<a href="http://localhost:8181/tasklist。" target="_blank" rel="noopener">http://localhost:8181/tasklist。</a></p>
<p>你可以通过创建一个文本文件”etc/org.ops4j.pax.web.cfg”改变端口。文本内容为”org.osgi.service.http.port=8080”。这个方式将告诉HttpService使用这个端口8080. 现在tasklist应用应该运行在<a href="http://localhost:8080/tasklist地址。" target="_blank" rel="noopener">http://localhost:8080/tasklist地址。</a></p>
<p>总结</p>
<p>在该教程中我们已经安装了Karaf和学习了一些命令。然后我们创建了一个小的OSGi应用，这个应用涉及到servlets，OSGi服务，blueprint和whiteboard模式。下一个教程我们看下在OSGi中Apache Camel和Apache CXF的使用。</p>
<p>Apache Karaf用户指导  </p>
<p>一 安装karaf  </p>
<p>本章讲述如何在windows和unix平台安装Apache Karaf，这里你将知道预先要安装什么软件，如何下载并且安装Karaf。  </p>
<p>预安装需求<br>硬件：  </p>
<ul>
<li>20M磁盘剩余空间。<br>操作系统：<br>Windows：Windows vista，Windows XP sp2，windows2000。- Unix：Ubuntu Linux，Powerdog Linux,MacOS，AIX,HP-UX,Solaris，任何支持java的unix平台。<br>环境：<br>Java SE 1.5x或者更高。- 环境变量JAVAHOME必须设置为java运行时的安装目录，比如C:\Program Files\Java\jdk1.6.026。按住windows和break键切换到高级选项，点击环境变量，把上面的路径加入到变量中。<br>从源码构建<br>如果你想从源码构建KARAF，需求会有点不同：  </li>
</ul>
<p>硬件：  </p>
<ul>
<li>200M磁盘空间便于apache karaf源码展开或者是SVN的验证，以及maven构建和依赖maven组件的下载。<br>环境：<br>JDK 1.5或者是更高。- Apache maven 2.2.1.<br>在windows上构建<br>这过程说明如何下载和安装windows上的源码文件。注：Karaf需要java5编译，构建和运行。  </li>
</ul>
<p>在浏览器输入<a href="http://karaf.apache.org/index/community/download.html" target="_blank" rel="noopener">http://karaf.apache.org/index/community/download.html</a>.  
滚动到“Apache Karaf”区域选择需要的链接。源码文件名称类似于：apache-karaf-x.y-src.zip.<br>解压缩zip文件到你选择的目录中，请记住非法java路径的限制，比如！，%等。<br>用maven 2.2.1 或者更高的java5来构建karaf。 构建karaf的方法如下：<br>Cd [karaf安装路径]\src- Mvn<br>这两个步骤均需要10到15分钟。<br>用zip工具加压文件，windows的路径是 [karaf安装路径]\assembly\target\apache-karaf-x.y.zip<br>转到开始karaf一节<br>在Unix上构建<br>本过程将讲述如何在unix系统上下载和安装源码文件。这里假定unix机器上有浏览器，没有浏览器的请参照前面二进制unix安装区域。注：Karaf需要java5编译，构建和运行。  </p>
<p>在浏览器输入<a href="http://karaf.apache.org/" target="_blank" rel="noopener">http://karaf.apache.org/</a> download.html.<br>滚动到“Apache Karaf”区域选择需要的链接。源码文件名称类似于：apache-karaf-x.y-src.zip.<br>解压缩zip文件到你选择的目录中，例如：gunzip apache-karaf-x.y-src.tar.gz tar xvf apache-karaf-x.y-src.tar请记住非法java路径的限制，比如！，%等<br>用maven构建karaf建议方法如下: cd [karaf安装路径]\src cvn 5.解压缩刚刚创建的文件 cd [karaf安装路径]/assembly/target gunzip apache-karaf-x.y.tar.gz tar xvf apache-karaf-x.y.tar<br>转到开始karaf一节<br>Windows安装过程<br>这里说明如何在windows系统上下载和安装二进制文件。  </p>
<p>在浏览器输入 <a href="http://karaf.apache.org/index/community/download.html" target="_blank" rel="noopener">http://karaf.apache.org/index/community/download.html</a>.  
滚动到“Apache Karaf”区域选择需要的链接。源码文件名称类似于：apache-karaf-x.y-src.zip.<br>解压缩zip文件到你选择的目录中，请记住非法java路径的限制，比如！，%等。<br>转到开始karaf一节<br>可选：在Windows中启用彩色控制台输出  </p>
<ul>
<li>提示：如果你安装karaf到很深的路径或者是非法的java路径，！，%等，你可以创建一个bat文件来执行：subst S: “C:\your very % problematic path!\KARAF” 这样karaf的路径是 s: 这样的短类型。<br>Unix安装过程<br>这里属于如何在unix系统上下载和安装二进制文件。  </li>
</ul>
<p>在浏览器输入<a href="http://karaf.apache.org/" target="_blank" rel="noopener">http://karaf.apache.org/</a> download.html.<br>滚动到“Apache Karaf”区域选择需要的链接。源码文件名称类似于：apache-karaf-x.y.tar.gz<br>解压缩zip文件到你选择的目录中，例如：gunzip apache-karaf-x.y.tar.gz tar xvf apache-karaf-x.y.tar 请记住非法java路径的限制，比如！，%等。<br>转到开始karaf一节<br>安装后的步骤<br>在开始使用karaf之前强烈建议设置指向JDK的JAVA_HOME用来定位java可执行文件，并且应该配置为指向已安装java se5或者6的根目录。  </p>
<p>二 目录结构  </p>
<p>Karaf安装目录结构如下：  </p>
<p>/bin: 启动脚本<br>/etc: 初始化文件<br>/data: 工作目录<br>/cache: OSGi框架包缓存<br>/generated-bundles: 部署使用的临时文件夹<br>/log: 日志文件<br>/deploy: 热部署目录<br>/instances: 含有子实例的目录<br>/lib: 包含引导库<br>/lib/ext:JRE扩展目录<br>/lib/endorsed: 赞同库目录<br>/system: OSGi包库，作为一个Maven2存储库<br>Data文件夹包括karaf所有的工作和临时文件，如果你想从一个初始状态重启，你可以清空这个目录，这和“恢复初始化设置”一样的效果。  </p>
<p>三 启动和停止karaf  </p>
<p>本章介绍如何启动和停止Apache Karaf和各种可用的选项。  </p>
<p>启动karaf<br>Windows下：打开一个控制台窗口，更改到安装目录，并运行Karaf。对于二进制文件，运行 Cd [karaf安装目录] 然后输入：bin\karaf.bat  </p>
<p>Linux下：打开一个控制台窗口，更改到安装目录，并运行Karaf。运行 Cd [karaf安装目录] 然后输入：bin\karaf 警告：karaf运行后不要关闭控制台，否则会终止karaf（除非用非控制台启动karaf）。  </p>
<p>非控制台启动karaf<br>没有控制台也可以启动karaf，它总可以是用远程SSH访问，是用下面的命令： bin\karaf.bat server 或者是unix下：bin/karaf server  </p>
<p>在后台启动karaf<br>采用以下命令可以轻易地在后台进程启动karaf：   Bin\start.bat 或者在unix下：bin/start  </p>
<p>重置模式启动karaf<br>清空[karaf安装目录]\data文件夹就可以简单的在重置模式启动karaf，为方便起见，在karaf启动脚本使用以下参数也可以实现重置启动： bin/start clean  </p>
<p>停止karaf<br>无论是windows还是unix，你都可以在karaf控制台采用以下命令来停止它： <code>osgi:shutdown</code>, 或者简单的是：<code>shutdown</code>。    </p>
<p>Shutdown命令会询问你是否真的想要停止，如果你确认停止并且拒绝确认信息，你可以用-f或者-force选项： osgi：shutdown –f， 也可以用时间参数来延迟停止，时间参数有不同的形式。  </p>
<p>首先，可以是绝对时间各式hh：mm。第二，也可以是+m，其中m是等待的分。现在就是+0。  </p>
<p>下面的命令可以在10:35am关闭karaf:  </p>
<p>osgi:shutdown 10:35。  </p>
<p>下面的命令在10分钟后关闭karaf：  </p>
<p>osgi:shutdown +10。  </p>
<p>如果你在主控制台运行，用注销或者Ctrl+D退出控制台也可以终止karaf实例。 在控制台你可以运行如下命令：  </p>
<p>bin\stop.bat  </p>
<p>或者在unix下：  </p>
<p>bin/stop。  </p>
<p>四 使用控制台  </p>
<p>查看可用的命令<br>按提示键tab可以在控制台看到可用的命令列表：    </p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">root<span class="meta">@root</span>&amp;gt; &amp;lt;tab&amp;gt;Display all <span class="number">182</span> possibilities? (y or n)</span><br><span class="line">*:help                           addurl                           <span class="string">admin:</span>change-opts</span><br><span class="line"><span class="string">admin:</span>change-rmi-registry-port   <span class="string">admin:</span>change-ssh-port            <span class="string">admin:</span>connect</span><br><span class="line"><span class="string">admin:</span>create                     <span class="string">admin:</span>destroy                    <span class="string">admin:</span>list</span><br><span class="line"><span class="string">admin:</span>rename                     <span class="string">admin:</span>start                      <span class="string">admin:</span>stop</span><br><span class="line">bundle-level                     cancel                           cat</span><br><span class="line">change-opts                      change-rmi-registry-port         change-ssh-port</span><br><span class="line">clear                            commandlist                      <span class="string">config:</span>cancel</span><br><span class="line"><span class="string">config:</span>edit                      <span class="string">config:</span>list                      <span class="string">config:</span>propappend</span><br><span class="line"><span class="string">config:</span>propdel                   <span class="string">config:</span>proplist                  <span class="string">config:</span>propset</span><br><span class="line"><span class="string">config:</span>update                    connect                          create</span><br><span class="line">create-dump                      destroy                          <span class="string">dev:</span>create-dump</span><br><span class="line"><span class="string">dev:</span>dynamic-<span class="keyword">import</span>               <span class="string">dev:</span>framework                    <span class="string">dev:</span>print-stack-traces</span><br><span class="line"><span class="string">dev:</span>restart                      <span class="string">dev:</span>show-tree                    <span class="string">dev:</span>watch</span><br><span class="line">display                          display-exception                dynamic-<span class="keyword">import</span></span><br><span class="line">each                             echo                             edit</span><br><span class="line">exec                             exports                          <span class="string">features:</span>addurl</span><br><span class="line"><span class="string">features:</span>info                    <span class="string">features:</span>install                 <span class="string">features:</span>list</span><br><span class="line"><span class="string">features:</span>listrepositories        <span class="string">features:</span>listurl                 <span class="string">features:</span>listversions</span><br><span class="line"><span class="string">features:</span>refreshurl              <span class="string">features:</span>removerepository        <span class="string">features:</span>removeurl</span><br><span class="line"><span class="string">features:</span>uninstall               framework                        get</span><br><span class="line">grep                             head                             headers</span><br><span class="line">help                             history                          <span class="keyword">if</span></span><br><span class="line">imports                          info                             install</span><br><span class="line"><span class="string">jaas:</span>cancel                      <span class="string">jaas:</span>commandlist                 <span class="string">jaas:</span>list</span><br><span class="line"><span class="string">jaas:</span>manage                      <span class="string">jaas:</span>roleadd                     <span class="string">jaas:</span>roledel</span><br><span class="line"><span class="string">jaas:</span>update                      <span class="string">jaas:</span>useradd                     <span class="string">jaas:</span>userdel</span><br><span class="line"><span class="string">jaas:</span>userlist                    java                             list</span><br><span class="line">listrepositories                 listurl                          listversions</span><br><span class="line"><span class="string">log:</span>clear                        <span class="string">log:</span>display                      <span class="string">log:</span>display-exception</span><br><span class="line"><span class="string">log:</span>get                          <span class="string">log:</span>set                          <span class="string">log:</span>tail</span><br><span class="line">logout                           ls                               manage</span><br><span class="line">more                             <span class="keyword">new</span>                              <span class="string">osgi:</span>bundle-level</span><br><span class="line"><span class="string">osgi:</span>headers                     <span class="string">osgi:</span>info                        <span class="string">osgi:</span>install</span><br><span class="line"><span class="string">osgi:</span>list                        <span class="string">osgi:</span>ls                          <span class="string">osgi:</span>refresh</span><br><span class="line"><span class="string">osgi:</span>resolve                     <span class="string">osgi:</span>restart                     <span class="string">osgi:</span>shutdown</span><br><span class="line"><span class="string">osgi:</span>start                       <span class="string">osgi:</span>start-level                 <span class="string">osgi:</span>stop</span><br><span class="line"><span class="string">osgi:</span>uninstall                   <span class="string">osgi:</span>update                      <span class="string">packages:</span>exports</span><br><span class="line"><span class="string">packages:</span>imports                 print-stack-traces               printf</span><br><span class="line">propappend                       propdel                          proplist</span><br><span class="line">propset                          refresh                          refreshurl</span><br><span class="line">removerepository                 removeurl                        rename</span><br><span class="line">resolve                          restart                          roleadd</span><br><span class="line">roledel                          set                              <span class="string">shell:</span>cat</span><br><span class="line"><span class="string">shell:</span>clear                      <span class="string">shell:</span>each                       <span class="string">shell:</span>echo</span><br><span class="line"><span class="string">shell:</span>exec                       <span class="string">shell:</span>grep                       <span class="string">shell:</span>head</span><br><span class="line"><span class="string">shell:</span>history                    <span class="string">shell:</span><span class="keyword">if</span>                         <span class="string">shell:</span>info</span><br><span class="line"><span class="string">shell:</span>java                       <span class="string">shell:</span>logout                     <span class="string">shell:</span>more</span><br><span class="line"><span class="string">shell:</span><span class="keyword">new</span>                        <span class="string">shell:</span>printf                     <span class="string">shell:</span>sleep</span><br><span class="line"><span class="string">shell:</span>sort                       <span class="string">shell:</span>tac                        <span class="string">shell:</span>tail</span><br><span class="line">show-tree                        shutdown                         sleep</span><br><span class="line">sort                             ssh                              <span class="string">ssh:</span>ssh</span><br><span class="line"><span class="string">ssh:</span>sshd                         sshd                             start</span><br><span class="line">start-level                      stop                             tac</span><br><span class="line">tail                             uninstall                        update</span><br><span class="line">useradd                          userdel                          userlist</span><br><span class="line">watch</span><br><span class="line">root<span class="meta">@root</span>&amp;gt;</span><br></pre></td></tr></table></figure>

<p>获得命令的帮助<br>要查看一个特定的命令的帮助，在命令后加–help或使用help命令加上命令的名称：</p>
<p><code>karaf@root&amp;gt; feature:list --help</code><br>描述</p>
<p>   <code>feature:list       列出库中定义的所有功能。</code><br>语法</p>
<pre><code>`feature:list [options]`</code></pre><p>选项</p>
<p>   <code>--help               显示此帮助信息</code><br>   <code>-i, --installed      只列出已安装的功能列表</code><br>更多…<br>所有可用命令列表和它们的用法，也可以在一个专门的章节。  </p>
<p>你在开发指南会获得更多的shell语法的深入引导。  </p>
<p>如开发指南解释的那样，控制台可以很容易的被新命令扩展。  </p>
<p>五 网络控制台  </p>
<p>Karaf Web控制台提供了一个运行时的图形概述。  </p>
<p>你可以是用它来：  </p>
<p>安装和卸载功能<br>启动，停止，安装捆绑<br>创建子实例<br>配置Karaf<br>查看日志信息<br>安装web控制台<br>默认情况下web控制台是不安装的，安装请在karaf提示中运行以下命令： root@karaf&gt; features:install webconsole  </p>
<p>访问Web控制台<br>访问本地运行的一个karaf实例，在浏览器输入：   <a href="http://localhost:8181/system/console" target="_blank" rel="noopener">http://localhost:8181/system/console</a> 使用karaf用户名和karaf密码来登录系统，如果你修改过用户名或密码，请是用修改后的。  </p>
<p>改变web控制台端口号<br>默认情况下，控制台在8181端口运行，你可以通过创建属性文件etc/org.ops4j.pax.web.cfg并在后面添加如下属性设置（改成任意你想要的端口号）来改变端口：  </p>
<p><code>org.osgi.service.http.port=8181</code>    </p>
<p>六 远程控制台  </p>
<p>使用远程实例<br>初始化远程实例<br>用它本地控制台管理karaf实例不总是有意义的，你可以用远程控制台远程管理karaf。  </p>
<p>当你启动karaf时，它使任何其他Karaf控制台或纯SSH客户端可以通过SSH访问远程控制台。远程控制台提供本地控制台的所有功能，并通过运行它里面的容器和服务给远程用户完全控制。  </p>
<p>SSH主机名和端口号在配置文件[karaf安装目录]/etc/org.apache.karaf.shell.cfg用以下默认值配置：  </p>
<p>sshPort=8101<br>sshHost=0.0.0.0<br>sshRealm=karaf<br>hostKey=${karaf.base}/etc/host.key<br>你可以用初始化命令或者编辑上面的文件更改这个配置，但是需要重启ssh控制台以便它是用新的参数。  </p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># define helper functions  </span><br><span class="line">bundle-<span class="keyword">by</span>-sn = &#123; bm = new java.util.HashMap ;  each (bundles) &#123; <span class="variable">$bm</span> put (<span class="variable">$it</span> symbolicName) <span class="variable">$it</span> &#125; ; <span class="variable">$bm</span> get <span class="variable">$1</span> &#125;</span><br><span class="line">bundle-id-<span class="keyword">by</span>-sn = &#123; b = (bundle-<span class="keyword">by</span>-sn <span class="variable">$1</span>) ; <span class="keyword">if</span> &#123; <span class="variable">$b</span> &#125; &#123; <span class="variable">$b</span> bundleId &#125; &#123; -1 &#125; &#125;</span><br><span class="line"># <span class="keyword">edit</span> config</span><br><span class="line">config:<span class="keyword">edit</span> org.apache.karaf.<span class="keyword">shell</span></span><br><span class="line">config:propset sshPort 8102</span><br><span class="line">config:<span class="keyword">update</span> </span><br><span class="line"># force a restart</span><br><span class="line">osgi:restart --force (bundle-id-<span class="keyword">by</span>-sn org.apache.karaf.<span class="keyword">shell</span>.ssh)</span><br></pre></td></tr></table></figure>

<p>远程连接和断开<br>使用ssh：ssh命令</p>
<p>你可以使用ssh：ssh命令来连接远程karaf控制台。 <code>karaf@root&amp;gt; ssh:ssh -l karaf -P karaf -p 8101 hostname</code></p>
<p>注意：默认的密码是karaf，但是我们强烈建议个更改。在安全模块查看更多信息。 为了确定你已经连接到正确的karaf实例，输入ssh：info在karaf提示符。返回当前连接的实例的信息，如下所示。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Karaf</span><br><span class="line">  Karaf home  /local/apache-karaf-2.0.0</span><br><span class="line">  Karaf base  /local/apache-karaf-2.0.0</span><br><span class="line">  OSGi Framework  org.eclipse.osgi - 3.5.1.R35x_v20090827</span><br><span class="line">JVM</span><br><span class="line">  Java Virtual MachineJava HotSpot(TM)<span class="built_in"> Server </span>VM version 14.1-b02</span><br><span class="line">  <span class="built_in">..</span>.</span><br></pre></td></tr></table></figure>

<p>使用karaf客户端<br>Karaf允许你安全的连接到远程karaf实例而不必运行本地karaf实例。</p>
<p>例如，在同一台机器上快速连接在server模式下运行的karaf实例，在karaf安装目录运行以下命令：<code>bin/client</code>。 通常情况下，你需要提供主机名，端口，用户名和密码来连接到远程实例。如果你使用的客户端在一个较大的脚本，你可以附加控制台命令如下： <code>bin/client -a 8101 -h hostname -u karaf -p karaf features:install wrapper</code></p>
<p>显示可用的客户端选项，输入：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&amp;gt; bin<span class="built_in">/client </span>--help</span><br><span class="line">Apache Karaf client</span><br><span class="line">  -a [port] specify the<span class="built_in"> port </span><span class="keyword">to</span> connect <span class="keyword">to</span></span><br><span class="line">  -h [host] specify the host <span class="keyword">to</span> connect <span class="keyword">to</span></span><br><span class="line">  -u [user] specify the<span class="built_in"> user </span>name</span><br><span class="line">  -p [password] specify the password</span><br><span class="line">  --helpshows this help message</span><br><span class="line">  -vraise verbosity</span><br><span class="line">  -r [attempts] retry<span class="built_in"> connection </span>establishment (up <span class="keyword">to</span> attempts times)</span><br><span class="line">  -d [delay]intra-retry delay (defaults <span class="keyword">to</span> 2 seconds)</span><br><span class="line">  [commands]commands <span class="keyword">to</span> run</span><br></pre></td></tr></table></figure>

<p>如果没有指定的命令，客户端将在互动模式。</p>
<p>使用纯SSH客户端<br>你也可以使用你的unix系统中的纯SSH客户端或者windows SSH客户端像putty来连接。 <code>~$ ssh -p 8101 karaf@localhost karaf@localhost&#39;s password:</code></p>
<p>从远程控制台断开<br>按Ctrl+D，shell：logout或者简单的在karaf提示符输入logout就可以断开远程控制台。</p>
<p>关闭远程实例<br>使用远程控制台<br>如果你已经用ssh:ssh命令或者karaf客户端连接到远程控制台，你可以用使用osgi:shutdown命令来停止远程实例。 注意：在远程控制台按Ctrl + D键，简单地关闭远程连接并返回到本地shell。</p>
<p>使用karaf客户端<br>使用karaf客户端停止远程实例，在karaf安装目录/lib目录运行以下命令： <code>bin/client -u karaf -p karaf -a 8101 hostname osgi:shutdown</code></p>
<p>七 子实例</p>
<p>管理子实例<br>一个Karaf的子实例是一个副本，你可以分别启动和部署应用程序。实例不包含的完整副本Karaf，但只有一个配置文件和数据文件夹的副本，其中包含了所有运行中的信息，日志文件和临时文件。</p>
<p>使用管理控制台命令<br>管理控制台命令允许您在同一台机器创建和管理Karaf实例。每一个新的运行时是运行时创建的子实例。您可以轻松地使用的名称管理子实例，而不是网络地址。有关管理命令的详细信息，请参阅管理命令。</p>
<p>创建子实例<br>你可以在karaf控制台输入admin:create创建新的运行时实例.</p>
<p>如下例子所示，admin:create将使运行时在活动的运行时{实例/名称}目录创建新的运行时安装。新的实例是一个新的karaf实例并且分配一个SSH端口号基于始于8101的增量和一个RMI注册端口号基于始于1099的增量。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">karaf<span class="meta">@root</span>&amp;gt;<span class="string">admin:</span>create finn</span><br><span class="line">Creating <span class="keyword">new</span> instance on SSH port <span class="number">8106</span> and RMI port <span class="number">1100</span> <span class="string">at:</span> <span class="regexp">/home/</span>fuse<span class="regexp">/esb4/</span>instances/finn</span><br><span class="line">Creating <span class="string">dir:</span>  <span class="regexp">/home/</span>fuse<span class="regexp">/esb4/</span>instances<span class="regexp">/finn/</span>bin</span><br><span class="line">Creating <span class="string">dir:</span>  <span class="regexp">/home/</span>fuse<span class="regexp">/esb4/</span>instances<span class="regexp">/finn/</span>etc</span><br><span class="line">Creating <span class="string">dir:</span>  <span class="regexp">/home/</span>fuse<span class="regexp">/esb4/</span>instances<span class="regexp">/finn/</span>system</span><br><span class="line">Creating <span class="string">dir:</span>  <span class="regexp">/home/</span>fuse<span class="regexp">/esb4/</span>instances<span class="regexp">/finn/</span>deploy</span><br><span class="line">Creating <span class="string">dir:</span>  <span class="regexp">/home/</span>fuse<span class="regexp">/esb4/</span>instances<span class="regexp">/finn/</span>data</span><br><span class="line">Creating <span class="string">file:</span> <span class="regexp">/home/</span>fuse<span class="regexp">/esb4/</span>instances<span class="regexp">/finn/</span>etc/config.properties</span><br><span class="line">Creating <span class="string">file:</span> <span class="regexp">/home/</span>fuse<span class="regexp">/esb4/</span>instances<span class="regexp">/finn/</span>etc/java.util.logging.properties</span><br><span class="line">Creating <span class="string">file:</span> <span class="regexp">/home/</span>fuse<span class="regexp">/esb4/</span>instances<span class="regexp">/finn/</span>etc/org.apache.felix.fileinstall-deploy.cfg</span><br><span class="line">Creating <span class="string">file:</span> <span class="regexp">/home/</span>fuse<span class="regexp">/esb4/</span>instances<span class="regexp">/finn/</span>etc/org.apache.karaf.log.cfg</span><br><span class="line">Creating <span class="string">file:</span> <span class="regexp">/home/</span>fuse<span class="regexp">/esb4/</span>instances<span class="regexp">/finn/</span>etc/org.apache.karaf.features.cfg</span><br><span class="line">Creating <span class="string">file:</span> <span class="regexp">/home/</span>fuse<span class="regexp">/esb4/</span>instances<span class="regexp">/finn/</span>etc/org.ops4j.pax.logging.cfg</span><br><span class="line">Creating <span class="string">file:</span> <span class="regexp">/home/</span>fuse<span class="regexp">/esb4/</span>instances<span class="regexp">/finn/</span>etc/org.ops4j.pax.url.mvn.cfg</span><br><span class="line">Creating <span class="string">file:</span> <span class="regexp">/home/</span>fuse<span class="regexp">/esb4/</span>instances<span class="regexp">/finn/</span>etc/startup.properties</span><br><span class="line">Creating <span class="string">file:</span> <span class="regexp">/home/</span>fuse<span class="regexp">/esb4/</span>instances<span class="regexp">/finn/</span>etc/system.properties</span><br><span class="line">Creating <span class="string">file:</span> <span class="regexp">/home/</span>fuse<span class="regexp">/esb4/</span>instances<span class="regexp">/finn/</span>etc/org.apache.karaf.shell.cfg</span><br><span class="line">Creating <span class="string">file:</span> <span class="regexp">/home/</span>fuse<span class="regexp">/esb4/</span>instances<span class="regexp">/finn/</span>etc/org.apache.karaf.management.cfg</span><br><span class="line">Creating <span class="string">file:</span> <span class="regexp">/home/</span>fuse<span class="regexp">/esb4/</span>instances<span class="regexp">/finn/</span>bin/karaf</span><br><span class="line">Creating <span class="string">file:</span> <span class="regexp">/home/</span>fuse<span class="regexp">/esb4/</span>instances<span class="regexp">/finn/</span>bin/start</span><br><span class="line">Creating <span class="string">file:</span> <span class="regexp">/home/</span>fuse<span class="regexp">/esb4/</span>instances<span class="regexp">/finn/</span>bin/stop</span><br><span class="line">karaf<span class="meta">@root</span>&amp;gt;</span><br></pre></td></tr></table></figure>

<p>改变子实例端口号<br>你可以使用admin:change-ssh-port命令来改变分配给子实例的SSH端口号。命令语法是： admin:change-ssh-port 实例 端口号，需要注意的必须停止子实例才能运行此命令。  </p>
<p>同样，你可以使用admin:change-rmi-registry-port命令改变分配给子实例的RMI注册端口号。命令的语法是：   admin:change-rmi-registry-port instance port，需要注意的必须停止子实例才能运行此命令。  </p>
<p>启动子实例<br>新的子实例在停止状态下被创建，用admin:start命令来启动子实例并使之准备主机应用。这个命令需要一个标识你想启动的子实例的instance-name参数。  </p>
<p>列出所有容器实例<br>要查看一个特定的安装下运行的所有Karaf实例的列表，使用admin:list命令。  </p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">karaf</span>@<span class="keyword">root</span>&amp;<span class="keyword">gt</span>;<span class="selector-tag">admin</span><span class="selector-pseudo">:list</span></span><br><span class="line">  <span class="selector-tag">SSH</span> <span class="selector-tag">Port</span>   <span class="selector-tag">RMI</span> <span class="selector-tag">Port</span>   <span class="selector-tag">State</span>   <span class="selector-tag">Pid</span>  <span class="selector-tag">Name</span></span><br><span class="line"><span class="selector-attr">[8107]</span> <span class="selector-attr">[  1106]</span> <span class="selector-attr">[Started ]</span> <span class="selector-attr">[10628]</span> <span class="selector-tag">harry</span></span><br><span class="line"><span class="selector-attr">[8101]</span> <span class="selector-attr">[  1099]</span> <span class="selector-attr">[Started ]</span> <span class="selector-attr">[20076]</span> <span class="selector-tag">root</span></span><br><span class="line"><span class="selector-attr">[8106]</span> <span class="selector-attr">[  1105]</span> <span class="selector-attr">[Stopped ]</span> <span class="selector-attr">[15924]</span> <span class="selector-tag">dick</span></span><br><span class="line"><span class="selector-attr">[8105]</span> <span class="selector-attr">[  1104]</span> <span class="selector-attr">[Started ]</span> <span class="selector-attr">[18224]</span> <span class="selector-tag">tom</span></span><br><span class="line"><span class="selector-tag">karaf</span>@<span class="keyword">root</span>&amp;<span class="keyword">gt</span>;</span><br></pre></td></tr></table></figure>

<p>连接到子实例<br>你可以使用admin:connect命令连接到开始的子实例远程控制台，这需要三个参数： admin:connect [-u username] [-p password] instance, 一旦你连接到子实例，karaf提示符显示现在实例的名字，如下： karaf@harry&gt;</p>
<p>停止一个子实例<br>在实例自己内部停止一个子实例，输入osgi:shutdown或者简单的shutdown。 远程停止子实例，换句话说，从父或者兄弟实例，使用<code>admin:stop： admin:stop instance</code></p>
<p>注销一个子实例<br>你可以使用<code>admin:destroy</code>命令永久的删除一个停止的子实例：</p>
<p><code>*admin:destroy instance*</code><br>请注意只有停止的实例可以被注销。</p>
<p>使用管理脚本<br>你也可以管理本地的karaf实例，在karaf安装目录/bin目录下的管理员脚本提供了像管理员控制台相同的命令，除了admin:connect。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&amp;gt; bin/admin</span><br><span class="line">Available commands:</span><br><span class="line">  <span class="keyword">change</span>-ssh-port - Changes the secure shell port <span class="keyword">of</span> an existing <span class="keyword">container</span> instance.</span><br><span class="line">  <span class="keyword">change</span>-rmi-registry-port - Changes the RMI registry port (used <span class="keyword">by</span> <span class="keyword">management</span> layer) <span class="keyword">of</span> an existing <span class="keyword">container</span> instance.</span><br><span class="line">  <span class="keyword">create</span> - Creates a <span class="keyword">new</span> <span class="keyword">container</span> instance.</span><br><span class="line">  destroy - Destroys an existing <span class="keyword">container</span> instance.</span><br><span class="line">  <span class="keyword">list</span> - <span class="keyword">List</span> <span class="keyword">all</span> existing <span class="keyword">container</span> instances.</span><br><span class="line">  <span class="keyword">start</span> - Starts an existing <span class="keyword">container</span> instance.</span><br><span class="line">  <span class="keyword">stop</span> - Stops an existing <span class="keyword">container</span> instance.</span><br><span class="line"><span class="keyword">Type</span> <span class="string">'command --help'</span> <span class="keyword">for</span> more <span class="keyword">help</span> <span class="keyword">on</span> the specified command.</span><br></pre></td></tr></table></figure>

<p>例如，列出所有本机器的karaf实例，输入：</p>
<p>bin/admin list<br>八 安全</p>
<p>管理用户名和密码<br>默认安全配置使用一个位于 karaf安装目录/etc/users.properties属性文件存储授权的用户和他们的密码。</p>
<p>默认的用户名是karaf，与之相关联的密码也是karaf。我们强烈建议在将karaf转移到产品前通过编辑上面的文件修改默认密码。</p>
<p>在karaf中用户现在被使用在三个地方：</p>
<p>访问SSH控制台<br>访问JMX管理层<br>访问web控制台<br>这三种方式的全部委托基于安全认证的相同的JAAS。 users.properties文件包含一或者多行，每行都定义了一个用户，密码和相关的角色。 user=password[,role][,role]…</p>
<p>管理角色<br>JAAS角色可以被各种组件使用。三个管理层（SSH,JMX和web控制台）都使用用基于认证系统的全局角色。默认的角色名称在etc/system.properties中使用karaf.admin.role系统属性配置，并且默认值是admin。对管理层进行身份验证的所有用户必须有这个角色的定义。</p>
<p>这个值的语法如下： [classname:]principal</p>
<p>其中classname是主要对象的类名（默认以org.apache.karaf.jaas.modules.RolePrincipal），主要是这一类（默认为admin）的主要的名称。 注意，可以使用以下配置ConfigAdmin对于一个给定的层改变角色：</p>
<p>Layer    PID    Value<br>SSH    org.apache.karaf.shell    sshRole<br>JMX    org.apache.karaf.management    jmxRole<br>Web    org.apache.karaf.webconsole    role<br>启用密码加密<br>为了避免密码是纯文本，密码可以加密存储在配置文件中。 这可以通过以下命令轻易的实现：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># edit config</span></span><br><span class="line"><span class="attr">config:</span><span class="string">edit</span> <span class="string">org.apache.karaf.jaas</span></span><br><span class="line"><span class="attr">config:</span><span class="string">propset</span> <span class="string">encryption.enabled</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">config:</span><span class="string">update</span> </span><br><span class="line"><span class="comment"># force a restart</span></span><br><span class="line"><span class="attr">dev:</span><span class="string">restart</span></span><br></pre></td></tr></table></figure>

<p>用户第一次登录，密码将在 etc/users.properties 配置文件中被自动的加密。加密密码在前面加上{CRYPT}，因此很容易识别。</p>
<p>管理领域<br>更多关于更改默认领域或者部署新领域信息将会在开发者指南中被提供。</p>
<p>部署安全供应商<br>有些应用程序需要特定的安全性提供者可用，如BouncyCastle。JVM在这些jar包的使用上施加一些限制：他们必须签署和引导类路径上可用。部署这些供应商的方法之一是把他们放在位于$ JAVAHOME/ JRE/ lib / ext的JRE文件夹中并且修改安全策略配置（$JAVAHOME/jre/lib/security/java.security）以登记等供应商。</p>
<p>虽然这种方法工作的很好，他将会有全局的影响并且需要你配置所有相应的服务器。</p>
<p>Karaf提供了一个简单的方式来配置额外的安全性提供者：</p>
<p>把你的供应商jar放在karaf-install-dir/lib/ext中<br>修改初始化文件 karaf-install-dir/etc/config.properties ，添加如下属性： org.apache.karaf.security.providers = xxx,yyy 这个属性的值是一个逗号分隔的提供商类名的注册名单。 例如：org.apache.karaf.security.providers = org.bouncycastle.jce.provider.BouncyCastleProvider 此外，你可能想向系统中捆绑的供应商的类提供访问，使所有束可以访问那些。它可以通过在相同的配置文件中修改org.osgi.framework.bootdelegation 属性来实现： </p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">org<span class="selector-class">.osgi</span><span class="selector-class">.framework</span><span class="selector-class">.bootdelegation</span> = ...,org.bouncycastle*</span><br></pre></td></tr></table></figure>

<p>九 故障转移部署</p>
<p>Karaf提供故障转移功能，使用一个简单的锁定文件系统或JDBC锁定机制。在这两种情况下，一个容器级锁系统允许绑定预装到副Karaf实例，以提供更快的故障转移性能。</p>
<p>简单文件锁定<br>简单文件锁定机制用于驻留在同一台主机的实例故障转移配置。 要使用这个功能，按照如下形式编辑<code>$KARAF_HOME/etc/system.properties</code>文件中的每个系统上的主/从设置：  </p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">karaf.lock</span>=<span class="literal">true</span></span><br><span class="line"><span class="attr">karaf.lock.class</span>=org.apache.felix.karaf.main.SimpleFileLock</span><br><span class="line"><span class="attr">karaf.lock.dir</span>=&amp;lt<span class="comment">;PathToLockFileDirectory&amp;gt;</span></span><br><span class="line"><span class="attr">karaf.lock.delay</span>=<span class="number">10</span></span><br></pre></td></tr></table></figure>

<p>说明：确保karaf.lock.dir属性指向相同的主从实例目录，以便当主释放从，从只能获得锁定。  </p>
<p>JDBC锁定<br>JDBC锁定机制的目的就是为了存在单独机器上的故障转移配置。在此部署中，主实例拥有一个Karaf锁定数据库上的表上的锁，如果主失去了锁，等待从进程获得锁定表，并全面启动它的容器。  </p>
<p>要使用这个功能，按照如下形式设置每个系统上的主/从设置：  </p>
<p>更新CLASSPATH包含JDBC驱动程序  </p>
<p>更新KARAF_HOME/bin/ karaf脚本有独特的JMX远程端口设置，如果实例驻留在同一主机上  </p>
<p>更新KARAF_HOME的/ etc/ system.properties文件如下：  </p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">karaf.lock=true</span><br><span class="line">karaf<span class="selector-class">.lock</span><span class="selector-class">.class</span>=org<span class="selector-class">.apache</span><span class="selector-class">.felix</span><span class="selector-class">.karaf</span><span class="selector-class">.main</span><span class="selector-class">.DefaultJDBCLock</span></span><br><span class="line">karaf<span class="selector-class">.lock</span><span class="selector-class">.level</span>=<span class="number">50</span></span><br><span class="line">karaf<span class="selector-class">.lock</span><span class="selector-class">.delay</span>=<span class="number">10</span></span><br><span class="line">karaf<span class="selector-class">.lock</span><span class="selector-class">.jdbc</span><span class="selector-class">.url</span>=jdbc:derby:<span class="comment">//dbserver:1527/sample</span></span><br><span class="line">karaf<span class="selector-class">.lock</span><span class="selector-class">.jdbc</span><span class="selector-class">.driver</span>=org<span class="selector-class">.apache</span><span class="selector-class">.derby</span><span class="selector-class">.jdbc</span><span class="selector-class">.ClientDriver</span></span><br><span class="line">karaf<span class="selector-class">.lock</span><span class="selector-class">.jdbc</span><span class="selector-class">.user</span>=user</span><br><span class="line">karaf<span class="selector-class">.lock</span><span class="selector-class">.jdbc</span><span class="selector-class">.password</span>=password</span><br><span class="line">karaf<span class="selector-class">.lock</span><span class="selector-class">.jdbc</span><span class="selector-class">.table</span>=KARAF_LOCK</span><br><span class="line">karaf<span class="selector-class">.lock</span><span class="selector-class">.jdbc</span><span class="selector-class">.clustername</span>=karaf</span><br><span class="line">karaf<span class="selector-class">.lock</span><span class="selector-class">.jdbc</span><span class="selector-class">.timeout</span>=<span class="number">30</span></span><br></pre></td></tr></table></figure>

<p>说明：</p>
<p>如果JDBC驱动程序不在classpath中会失败。<br>将创建数据库名称“sample”，如果它不存在于数据库。<br>Karaf的第一个实例来获得锁定表的是主实例。<br>如果数据库连接丢失，主实例尝试正常关闭，主数据库服务恢复时允许一个从的实例成为主，前主将需要手动重新启动。<br>Oracle的JDBC锁定<br>在JDBC锁定情况下如果你采用oracle作为你的数据库，在$KARAF_HOME/etc/system.properties 文件中的karaf.lock.class 属性必须指向org.apache.felix.karaf.main.OracleJDBCLock。 否则，对于你的设置初始化system.properties文件是正常的，例如：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">karaf.lock=true</span><br><span class="line">karaf<span class="selector-class">.lock</span><span class="selector-class">.class</span>=org<span class="selector-class">.apache</span><span class="selector-class">.felix</span><span class="selector-class">.karaf</span><span class="selector-class">.main</span><span class="selector-class">.OracleJDBCLock</span></span><br><span class="line">karaf<span class="selector-class">.lock</span><span class="selector-class">.jdbc</span><span class="selector-class">.url</span>=jdbc:oracle:thin:@hostname:<span class="number">1521</span>:XE</span><br><span class="line">karaf<span class="selector-class">.lock</span><span class="selector-class">.jdbc</span><span class="selector-class">.driver</span>=oracle<span class="selector-class">.jdbc</span><span class="selector-class">.OracleDriver</span></span><br><span class="line">karaf<span class="selector-class">.lock</span><span class="selector-class">.jdbc</span><span class="selector-class">.user</span>=user</span><br><span class="line">karaf<span class="selector-class">.lock</span><span class="selector-class">.jdbc</span><span class="selector-class">.password</span>=password</span><br><span class="line">karaf<span class="selector-class">.lock</span><span class="selector-class">.jdbc</span><span class="selector-class">.table</span>=KARAF_LOCK</span><br><span class="line">karaf<span class="selector-class">.lock</span><span class="selector-class">.jdbc</span><span class="selector-class">.clustername</span>=karaf</span><br><span class="line">karaf<span class="selector-class">.lock</span><span class="selector-class">.jdbc</span><span class="selector-class">.timeout</span>=<span class="number">30</span></span><br></pre></td></tr></table></figure>

<p>正如默认的JDBC锁定设置，Oracle JDBC驱动包必须在calsspath中，为了确保如此你可以在karaf启动之前复制ojdbc14.jar到karaf的lib文件夹下。 说明：karaf.lock.jdbc.url 需要活动的SID，这意味着在使用这个特定的锁之前你必须手动创建数据库实例。</p>
<p>容器级锁定<br>容器级锁定允许绑定预装到从内核的实例，以提供更快的故障转移性能。容器级锁被简单的文件和JDBC锁定机制支持。 为了实现容器及说定，添加如下内容到  <code>$KARAF_HOME/etc/system.properties</code> 文件中在每个系统的主从设置上：  </p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">karaf.lock</span>=<span class="literal">true</span></span><br><span class="line"><span class="attr">karaf.lock.level</span>=<span class="number">50</span></span><br><span class="line"><span class="attr">karaf.lock.delay</span>=<span class="number">10</span></span><br></pre></td></tr></table></figure>

<p>Karaf.log.level属性告诉karaf实例引导过程带来的OSGI容器有多远。分配相同级别的绑定或者是更低的也会在那个karaf实例中被启动。  </p>
<p>绑定开始级别在$KARAF_HOME/etc/startup.properties指定，以jar.name=levle的形式。核心系统绑定级数低于50，用户绑定级别大于50。  </p>
<p>级别    行为<br>1    一个“冷”的备用实例，核心绑定不会被加载到容器中，从实例将等待指导锁定需要启动服务器。<br>&lt;50    一个“热”的备用实例，核心捆绑将被加载到容器，从实例等待指导锁需要启动用户级别绑定。控制台对于每个从实例可以在这个级别访问。<br>&gt;50    这个设置不建议作为用户捆绑被启动。<br>注意：挡在同一主机上使用“热”备用，你需要设置JMX远程端口为唯一值以避免绑定冲突，你可以编辑karaf启动脚本以包括以下内容：</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DEFAULT_JAVA_OPTS="-server $DEFAULT_JAVA_OPTS </span><br><span class="line">-<span class="ruby">Dcom.sun.management.jmxremote.port=<span class="number">1100</span> </span></span><br><span class="line"><span class="ruby">-Dcom.sun.management.jmxremote.authenticate=<span class="literal">false</span></span></span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="/blog/2019/07/24/KARAF/" data-id="ckbdc9v1r00rv24u2nw4sgqoo" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JAVAEE/">JAVAEE</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/KARAF/">KARAF</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-markdown-目录" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/24/markdown-目录/" class="article-date">
  <time datetime="2019-07-24T18:29:00.000Z" itemprop="datePublished">2019-07-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/IT/">IT</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/24/markdown-目录/">markdown 目录</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>markdown 实现页内跳转和自动生成目录</p>
<p>接上一篇 markdown 基本语法继续：</p>
<ul>
<li>实现页内跳转</li>
</ul>
<ol>
<li><p>定义锚点<br><code>&amp;lt;span id=&quot;jump&quot;&amp;gt;请点击跳转&amp;lt;/span&amp;gt;</code>  </p>
</li>
<li><p>使用markdown语法<br><code>[要跳转到的内容](#jump)</code>  </p>
</li>
</ol>
<ul>
<li>实现目录</li>
</ul>
<p>在要生成目录的地方写：<code>[TOC]</code> 即可按照标题生成目录<br>有些markdown编辑器需要写： <code>@[TOC]</code></p>
<p>案例：</p>
<pre><code>
[TOC]

#  马什么梅
## 马冬梅
### 马冬什么
#### 马冬梅
##### 什么冬梅
###### 马冬梅</code></pre><p>生成的效果图：</p>
<p><img src="/images/pasted-29.png" alt="upload successful"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="/blog/2019/07/24/markdown-目录/" data-id="ckbdc9uuz00b324u2wlr1lyp0" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MARKDOWN/">MARKDOWN</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-springboot-osgi-系统监控" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/24/springboot-osgi-系统监控/" class="article-date">
  <time datetime="2019-07-24T16:54:00.000Z" itemprop="datePublished">2019-07-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/IT/">IT</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/24/springboot-osgi-系统监控/">springboot osgi 系统监控</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Springboot 集成osgi 实现本机性能监控</p>
<p>&lt;!– 获取系统信息 –&gt;<br>        &lt;dependency&gt;<br>            &lt;groupId&gt;com.github.oshi&lt;/groupId&gt;<br>            &lt;artifactId&gt;oshi-core&lt;/artifactId&gt;<br>            &lt;version&gt;3.9.1&lt;/version&gt;<br>        &lt;/dependency&gt;</p>
<pre><code>&amp;lt;dependency&amp;gt;
    &amp;lt;groupId&amp;gt;net.java.dev.jna&amp;lt;/groupId&amp;gt;
    &amp;lt;artifactId&amp;gt;jna&amp;lt;/artifactId&amp;gt;
&amp;lt;/dependency&amp;gt;

&amp;lt;dependency&amp;gt;
    &amp;lt;groupId&amp;gt;net.java.dev.jna&amp;lt;/groupId&amp;gt;
    &amp;lt;artifactId&amp;gt;jna-platform&amp;lt;/artifactId&amp;gt;
&amp;lt;/dependency&amp;gt;</code></pre><p>第二步：CPU、内存、虚拟机、系统、系统文件属性基础封装</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">package com.zzg.monit.domain.server;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.zzg.util.Arith;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> lombok.Getter;</span><br><span class="line"><span class="keyword">import</span> lombok.Setter;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cpu</span> &#123;</span></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 核心数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	@Getter</span><br><span class="line">	@Setter</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> cpuNum;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * CPU总的使用率</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	@Setter</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> total;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * CPU系统使用率</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	@Setter</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> sys;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * CPU用户使用率</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	@Setter</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> used;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * CPU当前等待率</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	@Setter</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> wait;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * CPU当前空闲率</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	@Setter</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> <span class="built_in">free</span>;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getTotal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Arith.round(Arith.mul(total, <span class="number">100</span>), <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getSys</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Arith.round(Arith.mul(sys / total, <span class="number">100</span>), <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getUsed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Arith.round(Arith.mul(used / total, <span class="number">100</span>), <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getWait</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Arith.round(Arith.mul(wait / total, <span class="number">100</span>), <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getFree</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Arith.round(Arith.mul(<span class="built_in">free</span> / total, <span class="number">100</span>), <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">package com.zzg.monit.domain.server;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.lang.management.ManagementFactory;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.zzg.util.Arith;</span><br><span class="line"><span class="keyword">import</span> com.zzg.util.DateUtils;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> lombok.Getter;</span><br><span class="line"><span class="keyword">import</span> lombok.Setter;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 虚拟机相关设置</span></span><br><span class="line"><span class="comment"> * @author zzg</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Jvm</span> &#123;</span></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 当前JVM占用的内存总数(M)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	@Setter</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> total;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * JVM最大可用内存总数(M)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	@Setter</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> max;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * JVM空闲内存(M)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	@Setter</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> <span class="built_in">free</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * JDK版本</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	@Getter</span><br><span class="line">	@Setter</span><br><span class="line">    <span class="keyword">private</span> String version;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * JDK路径</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	@Getter</span><br><span class="line">	@Setter</span><br><span class="line">    <span class="keyword">private</span> String home;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getTotal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Arith.div(total, (<span class="number">1024</span> * <span class="number">1024</span>), <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getMax</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Arith.div(max, (<span class="number">1024</span> * <span class="number">1024</span>), <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getFree</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Arith.div(<span class="built_in">free</span>, (<span class="number">1024</span> * <span class="number">1024</span>), <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getUsed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Arith.div(total - <span class="built_in">free</span>, (<span class="number">1024</span> * <span class="number">1024</span>), <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getUsage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Arith.mul(Arith.div(total - <span class="built_in">free</span>, total, <span class="number">4</span>), <span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取JDK名称</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ManagementFactory.getRuntimeMXBean().getVmName();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * JDK启动时间</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getStartTime</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> DateUtils.parseDateToStr(DateUtils.YYYY_MM_DD_HH_MM_SS, DateUtils.getServerStartDate());</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * JDK运行时间</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getRunTime</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> DateUtils.getDatePoor(DateUtils.getNowDate(), DateUtils.getServerStartDate());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">package com.zzg.monit.domain.server;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.zzg.util.Arith;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> lombok.Setter;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 内存相关信息</span></span><br><span class="line"><span class="comment"> * @author zzg</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mem</span> &#123;</span></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 内存总量</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	@Setter</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> total;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 已用内存</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	@Setter</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> used;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 剩余内存</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	@Setter</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> <span class="built_in">free</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getTotal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Arith.div(total, (<span class="number">1024</span> * <span class="number">1024</span> * <span class="number">1024</span>), <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getUsed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Arith.div(used, (<span class="number">1024</span> * <span class="number">1024</span> * <span class="number">1024</span>), <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getFree</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Arith.div(<span class="built_in">free</span>, (<span class="number">1024</span> * <span class="number">1024</span> * <span class="number">1024</span>), <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getUsage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Arith.mul(Arith.div(used, total, <span class="number">4</span>), <span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">package</span> <span class="selector-tag">com</span><span class="selector-class">.zzg</span><span class="selector-class">.monit</span><span class="selector-class">.domain</span><span class="selector-class">.server</span>;</span><br><span class="line"> </span><br><span class="line"><span class="selector-tag">import</span> <span class="selector-tag">lombok</span><span class="selector-class">.Getter</span>;</span><br><span class="line"><span class="selector-tag">import</span> <span class="selector-tag">lombok</span><span class="selector-class">.Setter</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 系统相关信息</span></span><br><span class="line"><span class="comment"> * @author zzg</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="selector-tag">public</span> <span class="selector-tag">class</span> <span class="selector-tag">Sys</span> &#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 服务器名称</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	<span class="variable">@Getter</span></span><br><span class="line">	<span class="variable">@Setter</span></span><br><span class="line">    private String computerName;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 服务器Ip</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	<span class="variable">@Getter</span></span><br><span class="line">	<span class="variable">@Setter</span></span><br><span class="line">    private String computerIp;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 项目路径</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	<span class="variable">@Getter</span></span><br><span class="line">	<span class="variable">@Setter</span></span><br><span class="line">    private String userDir;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 操作系统</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	<span class="variable">@Getter</span></span><br><span class="line">	<span class="variable">@Setter</span></span><br><span class="line">    private String osName;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 系统架构</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	<span class="variable">@Getter</span></span><br><span class="line">	<span class="variable">@Setter</span></span><br><span class="line">    private String osArch;		</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">package</span> <span class="selector-tag">com</span><span class="selector-class">.zzg</span><span class="selector-class">.monit</span><span class="selector-class">.domain</span><span class="selector-class">.server</span>;</span><br><span class="line"> </span><br><span class="line"><span class="selector-tag">import</span> <span class="selector-tag">lombok</span><span class="selector-class">.Getter</span>;</span><br><span class="line"><span class="selector-tag">import</span> <span class="selector-tag">lombok</span><span class="selector-class">.Setter</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 系统文件相关信息</span></span><br><span class="line"><span class="comment"> * @author zzg</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="selector-tag">public</span> <span class="selector-tag">class</span> <span class="selector-tag">SysFile</span> &#123;</span><br><span class="line">	 <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 盘符路径</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	<span class="variable">@Getter</span></span><br><span class="line">	<span class="variable">@Setter</span></span><br><span class="line">    private String dirName;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 盘符类型</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	<span class="variable">@Getter</span></span><br><span class="line">	<span class="variable">@Setter</span></span><br><span class="line">    private String sysTypeName;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 文件类型</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	<span class="variable">@Getter</span></span><br><span class="line">	<span class="variable">@Setter</span></span><br><span class="line">    private String typeName;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 总大小</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	<span class="variable">@Getter</span></span><br><span class="line">	<span class="variable">@Setter</span></span><br><span class="line">    private String total;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 剩余大小</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	<span class="variable">@Getter</span></span><br><span class="line">	<span class="variable">@Setter</span></span><br><span class="line">    private String free;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 已经使用量</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	<span class="variable">@Getter</span></span><br><span class="line">	<span class="variable">@Setter</span></span><br><span class="line">    private String used;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 资源的使用率</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	<span class="variable">@Getter</span></span><br><span class="line">	<span class="variable">@Setter</span></span><br><span class="line">    private double usage;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zzg.monit.domain;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.net.UnknownHostException;</span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"><span class="keyword">import</span> com.zzg.monit.domain.server.Cpu;</span><br><span class="line"><span class="keyword">import</span> com.zzg.monit.domain.server.Jvm;</span><br><span class="line"><span class="keyword">import</span> com.zzg.monit.domain.server.Mem;</span><br><span class="line"><span class="keyword">import</span> com.zzg.monit.domain.server.Sys;</span><br><span class="line"><span class="keyword">import</span> com.zzg.monit.domain.server.SysFile;</span><br><span class="line"><span class="keyword">import</span> com.zzg.util.Arith;</span><br><span class="line"><span class="keyword">import</span> com.zzg.util.IpUtils;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> lombok.Getter;</span><br><span class="line"><span class="keyword">import</span> lombok.Setter;</span><br><span class="line"><span class="keyword">import</span> oshi.SystemInfo;</span><br><span class="line"><span class="keyword">import</span> oshi.hardware.CentralProcessor;</span><br><span class="line"><span class="keyword">import</span> oshi.hardware.GlobalMemory;</span><br><span class="line"><span class="keyword">import</span> oshi.hardware.HardwareAbstractionLayer;</span><br><span class="line"><span class="keyword">import</span> oshi.hardware.CentralProcessor.TickType;</span><br><span class="line"><span class="keyword">import</span> oshi.software.os.FileSystem;</span><br><span class="line"><span class="keyword">import</span> oshi.software.os.OSFileStore;</span><br><span class="line"><span class="keyword">import</span> oshi.software.os.OperatingSystem;</span><br><span class="line"><span class="keyword">import</span> oshi.util.Util;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> class Server implements Serializable &#123;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1</span>L;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">int</span> OSHI_WAIT_SECOND = <span class="number">1000</span>;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * CPU相关信息</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	@Getter</span><br><span class="line">	@Setter</span><br><span class="line">	<span class="keyword">private</span> Cpu cpu = <span class="keyword">new</span> Cpu();</span><br><span class="line"> </span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 內存相关信息</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	@Getter</span><br><span class="line">	@Setter</span><br><span class="line">	<span class="keyword">private</span> Mem mem = <span class="keyword">new</span> Mem();</span><br><span class="line"> </span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * JVM相关信息</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	@Getter</span><br><span class="line">	@Setter</span><br><span class="line">	<span class="keyword">private</span> Jvm jvm = <span class="keyword">new</span> Jvm();</span><br><span class="line"> </span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 服务器相关信息</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	@Getter</span><br><span class="line">	@Setter</span><br><span class="line">	<span class="keyword">private</span> Sys sys = <span class="keyword">new</span> Sys();</span><br><span class="line"> </span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 磁盘相关信息</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	@Getter</span><br><span class="line">	@Setter</span><br><span class="line">	<span class="keyword">private</span> List&amp;lt;SysFile&amp;gt; sysFiles = <span class="keyword">new</span> LinkedList&amp;lt;SysFile&amp;gt;();</span><br><span class="line">	</span><br><span class="line"> </span><br><span class="line">	 <span class="keyword">public</span> <span class="keyword">void</span> copyTo() <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">	        SystemInfo si = <span class="keyword">new</span> SystemInfo();</span><br><span class="line">	        HardwareAbstractionLayer hal = si.getHardware();</span><br><span class="line"> </span><br><span class="line">	        setCpuInfo(hal.getProcessor());</span><br><span class="line"> </span><br><span class="line">	        setMemInfo(hal.getMemory());</span><br><span class="line"> </span><br><span class="line">	        setSysInfo();</span><br><span class="line"> </span><br><span class="line">	        setJvmInfo();</span><br><span class="line"> </span><br><span class="line">	        setSysFiles(si.getOperatingSystem());</span><br><span class="line">	    &#125;</span><br><span class="line"> </span><br><span class="line">	    <span class="comment">/**</span></span><br><span class="line"><span class="comment">	     * 设置CPU信息</span></span><br><span class="line"><span class="comment">	     */</span></span><br><span class="line">	    <span class="keyword">private</span> <span class="keyword">void</span> setCpuInfo(CentralProcessor processor) &#123;</span><br><span class="line">	        <span class="comment">// CPU信息</span></span><br><span class="line">	        <span class="keyword">long</span>[] prevTicks = processor.getSystemCpuLoadTicks();</span><br><span class="line">	        Util.sleep(OSHI_WAIT_SECOND);</span><br><span class="line">	        <span class="keyword">long</span>[] ticks = processor.getSystemCpuLoadTicks();</span><br><span class="line">	        <span class="keyword">long</span> nice = ticks[TickType.NICE.getIndex()] - prevTicks[TickType.NICE.getIndex()];</span><br><span class="line">	        <span class="keyword">long</span> irq = ticks[TickType.IRQ.getIndex()] - prevTicks[TickType.IRQ.getIndex()];</span><br><span class="line">	        <span class="keyword">long</span> softirq = ticks[TickType.SOFTIRQ.getIndex()] - prevTicks[TickType.SOFTIRQ.getIndex()];</span><br><span class="line">	        <span class="keyword">long</span> steal = ticks[TickType.STEAL.getIndex()] - prevTicks[TickType.STEAL.getIndex()];</span><br><span class="line">	        <span class="keyword">long</span> cSys = ticks[TickType.SYSTEM.getIndex()] - prevTicks[TickType.SYSTEM.getIndex()];</span><br><span class="line">	        <span class="keyword">long</span> user = ticks[TickType.USER.getIndex()] - prevTicks[TickType.USER.getIndex()];</span><br><span class="line">	        <span class="keyword">long</span> iowait = ticks[TickType.IOWAIT.getIndex()] - prevTicks[TickType.IOWAIT.getIndex()];</span><br><span class="line">	        <span class="keyword">long</span> idle = ticks[TickType.IDLE.getIndex()] - prevTicks[TickType.IDLE.getIndex()];</span><br><span class="line">	        <span class="keyword">long</span> totalCpu = user + nice + cSys + idle + iowait + irq + softirq + steal;</span><br><span class="line">	        cpu.setCpuNum(processor.getLogicalProcessorCount());</span><br><span class="line">	        cpu.setTotal(totalCpu);</span><br><span class="line">	        cpu.setSys(cSys);</span><br><span class="line">	        cpu.setUsed(user);</span><br><span class="line">	        cpu.setWait(iowait);</span><br><span class="line">	        cpu.setFree(idle);</span><br><span class="line">	    &#125;</span><br><span class="line"> </span><br><span class="line">	    <span class="comment">/**</span></span><br><span class="line"><span class="comment">	     * 设置内存信息</span></span><br><span class="line"><span class="comment">	     */</span></span><br><span class="line">	    <span class="keyword">private</span> <span class="keyword">void</span> setMemInfo(GlobalMemory memory) &#123;</span><br><span class="line">	        mem.setTotal(memory.getTotal());</span><br><span class="line">	        mem.setUsed(memory.getTotal() - memory.getAvailable());</span><br><span class="line">	        mem.setFree(memory.getAvailable());</span><br><span class="line">	    &#125;</span><br><span class="line"> </span><br><span class="line">	    <span class="comment">/**</span></span><br><span class="line"><span class="comment">	     * 设置服务器信息</span></span><br><span class="line"><span class="comment">	     */</span></span><br><span class="line">	    <span class="keyword">private</span> <span class="keyword">void</span> setSysInfo() &#123;</span><br><span class="line">	        Properties props = System.getProperties();</span><br><span class="line">	        sys.setComputerName(IpUtils.getHostName());</span><br><span class="line">	        sys.setComputerIp(IpUtils.getHostIp());</span><br><span class="line">	        sys.setOsName(props.getProperty(<span class="string">"os.name"</span>));</span><br><span class="line">	        sys.setOsArch(props.getProperty(<span class="string">"os.arch"</span>));</span><br><span class="line">	        sys.setUserDir(props.getProperty(<span class="string">"user.dir"</span>));</span><br><span class="line">	    &#125;</span><br><span class="line"> </span><br><span class="line">	    <span class="comment">/**</span></span><br><span class="line"><span class="comment">	     * 设置Java虚拟机</span></span><br><span class="line"><span class="comment">	     */</span></span><br><span class="line">	    <span class="keyword">private</span> <span class="keyword">void</span> setJvmInfo() <span class="keyword">throws</span> UnknownHostException &#123;</span><br><span class="line">	        Properties props = System.getProperties();</span><br><span class="line">	        jvm.setTotal(Runtime.getRuntime().totalMemory());</span><br><span class="line">	        jvm.setMax(Runtime.getRuntime().maxMemory());</span><br><span class="line">	        jvm.setFree(Runtime.getRuntime().freeMemory());</span><br><span class="line">	        jvm.setVersion(props.getProperty(<span class="string">"java.version"</span>));</span><br><span class="line">	        jvm.setHome(props.getProperty(<span class="string">"java.home"</span>));</span><br><span class="line">	    &#125;</span><br><span class="line"> </span><br><span class="line">	    <span class="comment">/**</span></span><br><span class="line"><span class="comment">	     * 设置磁盘信息</span></span><br><span class="line"><span class="comment">	     */</span></span><br><span class="line">	    <span class="keyword">private</span> <span class="keyword">void</span> setSysFiles(OperatingSystem os) &#123;</span><br><span class="line">	        FileSystem fileSystem = os.getFileSystem();</span><br><span class="line">	        OSFileStore[] fsArray = fileSystem.getFileStores();</span><br><span class="line">	        <span class="keyword">for</span> (OSFileStore fs : fsArray) &#123;</span><br><span class="line">	            <span class="keyword">long</span> free = fs.getUsableSpace();</span><br><span class="line">	            <span class="keyword">long</span> total = fs.getTotalSpace();</span><br><span class="line">	            <span class="keyword">long</span> used = total - free;</span><br><span class="line">	            SysFile sysFile = <span class="keyword">new</span> SysFile();</span><br><span class="line">	            sysFile.setDirName(fs.getMount());</span><br><span class="line">	            sysFile.setSysTypeName(fs.getType());</span><br><span class="line">	            sysFile.setTypeName(fs.getName());</span><br><span class="line">	            sysFile.setTotal(convertFileSize(total));</span><br><span class="line">	            sysFile.setFree(convertFileSize(free));</span><br><span class="line">	            sysFile.setUsed(convertFileSize(used));</span><br><span class="line">	            sysFile.setUsage(Arith.mul(Arith.div(used, total, <span class="number">4</span>), <span class="number">100</span>));</span><br><span class="line">	            sysFiles.<span class="built_in">add</span>(sysFile);</span><br><span class="line">	        &#125;</span><br><span class="line">	    &#125;</span><br><span class="line"> </span><br><span class="line">	    <span class="comment">/**</span></span><br><span class="line"><span class="comment">	     * 字节转换</span></span><br><span class="line"><span class="comment">	     *</span></span><br><span class="line"><span class="comment">	     * @param size 字节大小</span></span><br><span class="line"><span class="comment">	     * @return 转换后值</span></span><br><span class="line"><span class="comment">	     */</span></span><br><span class="line">	    <span class="keyword">public</span> <span class="keyword">String</span> convertFileSize(<span class="keyword">long</span> <span class="built_in">size</span>) &#123;</span><br><span class="line">	        <span class="keyword">long</span> kb = <span class="number">1024</span>;</span><br><span class="line">	        <span class="keyword">long</span> mb = kb * <span class="number">1024</span>;</span><br><span class="line">	        <span class="keyword">long</span> gb = mb * <span class="number">1024</span>;</span><br><span class="line">	        <span class="keyword">if</span> (<span class="built_in">size</span> &amp;gt;= gb) &#123;</span><br><span class="line">	            <span class="keyword">return</span> <span class="keyword">String</span>.format(<span class="string">"%.1f GB"</span> , (<span class="built_in">float</span>) <span class="built_in">size</span> / gb);</span><br><span class="line">	        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">size</span> &amp;gt;= mb) &#123;</span><br><span class="line">	            <span class="built_in">float</span> f = (<span class="built_in">float</span>) <span class="built_in">size</span> / mb;</span><br><span class="line">	            <span class="keyword">return</span> <span class="keyword">String</span>.format(f &amp;gt; <span class="number">100</span> ? <span class="string">"%.0f MB"</span> : <span class="string">"%.1f MB"</span> , f);</span><br><span class="line">	        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">size</span> &amp;gt;= kb) &#123;</span><br><span class="line">	            <span class="built_in">float</span> f = (<span class="built_in">float</span>) <span class="built_in">size</span> / kb;</span><br><span class="line">	            <span class="keyword">return</span> <span class="keyword">String</span>.format(f &amp;gt; <span class="number">100</span> ? <span class="string">"%.0f KB"</span> : <span class="string">"%.1f KB"</span> , f);</span><br><span class="line">	        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	            <span class="keyword">return</span> <span class="keyword">String</span>.format(<span class="string">"%d B"</span> , <span class="built_in">size</span>);</span><br><span class="line">	        &#125;</span><br><span class="line">	    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>第三步：控制层编写：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zzg.controller;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.<span class="keyword">annotation</span>.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.<span class="keyword">annotation</span>.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"><span class="keyword">import</span> com.zzg.monit.domain.Server;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 服务器监控</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> zzg</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Api(value = <span class="meta-string">"服务器监控"</span>, description = <span class="meta-string">"服务器监控管理"</span>)</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(<span class="meta-string">"/server"</span>)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServerController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**服务器监控首页</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> Exception **/</span></span><br><span class="line">    <span class="meta">@ApiOperation(value = <span class="meta-string">"服务器监控首页"</span>, notes = <span class="meta-string">"服务器监控首页"</span>)</span></span><br><span class="line">    <span class="meta">@GetMapping(<span class="meta-string">"/server"</span>)</span></span><br><span class="line">    <span class="keyword">public</span> ModelAndView user() throws Exception&#123;</span><br><span class="line">    	Server server = new Server();</span><br><span class="line">        server.copyTo();</span><br><span class="line">    	ModelAndView modelAndView = new ModelAndView();</span><br><span class="line">    	modelAndView.setViewName(<span class="string">"admin/server/server"</span>);</span><br><span class="line">    	modelAndView.addObject(<span class="string">"server"</span>, server);</span><br><span class="line">        <span class="keyword">return</span> modelAndView;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/images/pasted-28.png" alt="upload successful"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="/blog/2019/07/24/springboot-osgi-系统监控/" data-id="ckbdc9v0500oe24u2l2tq0esy" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JAVAEE/">JAVAEE</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OSGI/">OSGI</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-karaf-cmd-develop" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/24/karaf-cmd-develop/" class="article-date">
  <time datetime="2019-07-24T16:42:00.000Z" itemprop="datePublished">2019-07-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/IT/">IT</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/24/karaf-cmd-develop/">karaf cmd develop</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Karaf命令行辅助开发</p>
<p>在命令行中，要实现如上常用的help,通过ArgumentParsers，则可以容易实现,参考代码</p>
<pre><code>package com.zte.sunquan.demo.param;

import java.io.File;
import java.util.ArrayList;
import net.sourceforge.argparse4j.ArgumentParsers;
import net.sourceforge.argparse4j.annotation.Arg;
import net.sourceforge.argparse4j.inf.ArgumentParser;
import net.sourceforge.argparse4j.inf.ArgumentParserException;

/**
 * Created by sunquan on 2018/1/10.
 */
public class ParamTest {
    public static class Params {

        @Arg(dest = &quot;type&quot;)
        public String type;

        @Arg(dest = &quot;num1&quot;)
        public String num;

        @Arg(dest = &quot;auth&quot;)
        public ArrayList&amp;lt;String&amp;gt; auth;

        @Arg(dest = &quot;schemas-dir&quot;)
        public File schemasDir;

        public String getType() {
            return type;
        }

        public String getNum() {
            return num;
        }

        public ArrayList&amp;lt;String&amp;gt; getAuth() {
            return auth;
        }

        public File getSchemasDir() {
            return schemasDir;
        }
    }

    public static void main(String[] args) throws ArgumentParserException {
        //指定命令gcs
        final ArgumentParser parser = ArgumentParsers.newArgumentParser(&quot;gcs&quot;)
                .defaultHelp(true)
                .description(&quot;alculate checksum of given String.&quot;);//描述命令功能

        parser.addArgument(&quot;-t&quot;, &quot;--type&quot;)//参数选项,第二个参数默认对应@Arg中dest
                .type(String.class)//默认值
                .choices(&quot;SHA-256&quot;, &quot;SHA-512&quot;, &quot;SHA1&quot;)//可选项
                .setDefault(&quot;SHA-256&quot;)//默认值
                .help(&quot;Specify hash function to use&quot;);//选项描述
        parser.addArgument(&quot;-c&quot;, &quot;--content&quot;)
                .type(String.class)
                .help(&quot;content which need calculate&quot;)
                .dest(&quot;num1&quot;);//指定对应的@Arg 定义属性
        parser.addArgument(&quot;-a&quot;, &quot;--auth&quot;)
                .nargs(2)
                .help(&quot;Username and password for HTTP basic authentication in order username password.&quot;)
                .dest(&quot;auth&quot;);

        parser.addArgument(&quot;-f&quot;, &quot;--schemas-dir&quot;)
                .type(File.class)
                .help(&quot;Directory containing yang schemas to describe simulated devices. Some schemas e.g. netconf monitoring and inet types are included by default&quot;)
                .dest(&quot;schemas-dir&quot;);

        parser.printHelp();//打印help信息

        Params params = new Params();//命令包装对象
        try {
            //命令行参数--&amp;gt;自动转包装对象
            parser.parseArgs(new String[]{&quot;-t&quot;, &quot;SHA-256&quot;,
                    &quot;--content&quot;, &quot;sunquan&quot;,
                    &quot;-a&quot;, &quot;sunquan&quot;, &quot;password&quot;,
                    &quot;-f&quot;, &quot;C:/Users/Administrator/.m2/settings.xml&quot;}, params);//字符串转命令包装对象
        } catch (final ArgumentParserException e) {
            parser.handleError(e);
        }
        System.out.println(&quot;type:\t&quot; + params.getType());
        System.out.println(&quot;num:\t&quot; + params.getNum());
        System.out.println(&quot;userName:\t&quot; + params.getAuth().get(0));
        System.out.println(&quot;password:\t&quot; + params.getAuth().get(1));
        if (params.getSchemasDir().exists())
            System.out.println(&quot;file:\t&quot; + params.getSchemasDir().getName());

    }
}</code></pre><p>再介绍org.apache.karaf.shell.table.ShellTable</p>
<pre><code>    public static void main(String[] args) {

        ShellTable table = new ShellTable();
        table.size(40);//设置显示列宽（从最后一列开始计数），不设置
        table.column(&quot;name&quot;).alignLeft();//设置1列标题靠左
        table.column(&quot;age&quot;).alignCenter();//设置1列标题居中
        Col gender = new Col(&quot;gender&quot;);
        gender.alignRight();
        gender.maxSize(10);//设置该列长度，多余字符会被截断，不设置
        table.column(gender);
//        table.column(&quot;gender&quot;).alignRight();//设置1列标题靠右
        table.separator(&quot; % &quot;);//设置分隔符
        table.addRow().addContent(&quot;sunquan111111111111111111&quot;, &quot;291111111111&quot;, &quot;boy456789&quot;);
        table.addRow().addContent(&quot;sunquan&quot;, &quot;29&quot;, &quot;boy&quot;);
        table.addRow().addContent(&quot;sunquan&quot;, &quot;29&quot;, &quot;boy&quot;);
//        table.noHeaders();//不显示头，不设置
        table.print(System.out);

        table = new ShellTable();
        table.column(&quot;name&quot;).alignLeft();//设置1列标题靠左
        table.emptyTableText(&quot;null&quot;);//表示一个空表，用null替代
        table.print(System.out, true);

    }</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="/blog/2019/07/24/karaf-cmd-develop/" data-id="ckbdc9uuq00ab24u2u4mj742b" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JAVAEE/">JAVAEE</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/KARAF/">KARAF</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-OSGI" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/24/OSGI/" class="article-date">
  <time datetime="2019-07-24T10:23:00.000Z" itemprop="datePublished">2019-07-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/IT/">IT</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/24/OSGI/">OSGI</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>OSGI （面向Java的动态模型系统）   </p>
<p>OSGi（开放服务网关协议，Open Service Gateway Initiative）技术是Java动态化模块化系统的一系列规范。OSGi一方面指维护OSGi规范的OSGI官方联盟，另一方面指的是该组织维护的基于Java语言的服务（业务）规范。简单来说，OSGi可以认为是Java平台的模块层。OSGi服务平台向Java提供服务，这些服务使Java成为软件集成和软件开发的首选环境。SGi技术提供允许应用程序使用精炼、可重用和可协作的组件构建的标准化原语，这些组件能够组装进一个应用和部署中。<br>开放服务网关协议有双重含义。一方面它指OSGi Alliance组织；另一方面指该组织制定的一个基于Java语言的服务规范——OSGi服务平台。 OSGi Alliance是一个由Sun Microsystems、IBM、爱立信等于1999年3月成立的开放的标准化组织，最初名为Connected Alliance。该组织及其标准原本主要目的在于使服务提供商通过住宅网关，为各种家庭智能设备提供各种服务。该平台逐渐成为一个为室内、交通工具、移动电话和其他环境下的所有类型的网络设备的应用程序和服务进行传递和远程管理的开放式服务平台。<br>该规范和核心部分是一个框架，其中定义了应用程序的生命周期模式和服务注册。基于这个框架定义了大量的OSGi服务：日志、配置管理、偏好，HTTP（运行servlet）、XML分析、设备访问、软件包管理、许可管理、星级、用户管理、IO连接、连线管理、Jini和UPnP。<br>这个框架实现了一个优雅、完整和动态的组件模型。应用程序（称为bundle）无需重新引导可以被远程安装、启动、升级和卸载（其中Java包/类的管理被详细定义）。API中还定义了运行远程下载管理政策的生命周期管理。<font color="red">服务注册允许bundles去检测新服务和取消的服务，然后相应配合。 </font>OSGI框架一般具备的基础功能：<br>支持模块化的动态部署。基于OSGI而构建的系统可以以模块化的方式动态地部署至框架中，从而增加、扩展或改变系统的功能。支持模块化的封装和交互。每个工程（模块）可通过声明Export-Package对外提供访问此工程的类和接口。<br>支持模块的动态扩展。基于OSGI提供的面向服务的组件模型的设计方法，以及OSGI实现框架提供的扩展点方法可实现模块的动态扩展。模块化的设计。在OSGI中模块由一个或多个bundle构成，模块之间的交互通过Import-Package、Export-Package以及OSGI Service的方式实现。<br>动态化的设计。动态化的设计是指系统中所有的模块必须支持动态的插拔和修改，“即插即用，即删即无”。<br>可扩展的设计。通常使用定义扩展点的方式。按照Eclipse推荐的扩展点插件的标准格式定义bundle中的扩展点，其它要扩展的bundle可通过实现相应的扩展点来扩展该bundle的功能。<font color="red">每个bundle拥有独立的class loader，通过它来完成本bundle类的加载。 </font><br>稳定、高效的系统。基于OSGI的系统采用的是微核机制，微核机制保证了系统的稳定性，微核机制的系统只要微核是稳定运行的，那么系统就不会崩溃，也就是说基于OSGI的系统不会受到运行在其中的bundle的影响，不会因为bundle的崩溃而导致整个系统的崩溃。 [1]<br>OSGi服务平台提供在多种网络设备上无需重启的动态改变构造的功能。为了最小化耦合度和促使这些耦合度可管理，OSGi技术提供一种面向服务的架构，它能使这些组件动态地发现对方。OSGi联盟已经开发了例如像HTTP服务器、配置、日志、安全、用户管理、XML等很多公共功能标准组件接口。这些组件的兼容性插件实现可以从进行了不同优化和使用代价的不同计算机服务提供商得到。然而，服务接口能够基于专有权基础上开发。<br>因为OSGi技术为集成提供了预建立和预测试的组件子系统，所以OSGi技术使你从改善产品上市时间和降低开发成本上获益。因为这些组件能够动态发布到设备上，所以OSGi技术也能降低维护成本和拥有新的配件市场机会。 </p>
<p>OSGI规范的核心组件是OSGI框架。这个框架为应用程序（被叫做组件（bundle））提供了一个标准环境。整个框架可以划分为一些层次：</p>
<p>OSGI<br>L0：运行环境<br>L1：模块<br>L2：生命周期管理<br>L3：服务注册<br>还有一个无处不在的安全系统渗透到所有层。</p>
<p>L0层执行环境是Java环境的规范。Java2配置和子规范，像J2SE，CDC，CLDC，MIDP等等，都是有效的执行环境。OSGi平台已经标准化了一个执行环境，它是基于基础轮廓和在一个执行环境上确定了最小需求的一个小一些的变种，该执行环境对OSGi组件是有用的。<br>L1模块层定义类的装载策略。OSGi框架是一个强大的具有严格定义的类装载模型。它基于Java之上，但是增加了模块化。在Java中，正常情况下有一个包含所有类和资源的类路径。OSGi模块层为一个模块增加了私有类同时有可控模块间链接。模块层同安全架构完全集成，可以选择部署到部署封闭系统，防御系统，或者由厂商决定的完全由用户管理的系统。<br>L2生命周期层增加了能够被动态安装、开启、关闭、更新和卸载的bundles。这些bundles依赖于于具有类装载功能的模块层，但是增加了在运行时管理这些模块的API。生命周期层引入了正常情况下不属于一个应用程序的动态性。扩展依赖机制用于确保环境的操作正确。生命周期操作在安全架构保护之下，使其不受到病毒的攻击。<br>L3层增加了服务注册。服务注册提供了一个面向bundles的考虑到动态性的协作模型。bundles能通过传统的类共享进行协作，但是类共享同动态安装和卸载代码不兼容。服务注册提供了一个在bundles间分享对象的完整模型。定义了大量的事件来处理服务的注册和删除。这些服务仅仅是能代表任何事物的Java对象。很多服务类似服务器对象，例如HTTP服务器，而另一些服务表示的是一个真实世界的对象，例如附近的一个蓝牙手机。这个服务模块提供了完整安全保障。该服务安全模块使用了一个很聪明的方式来保障bundles之间通信安全。</p>
<p>标准服务<br>在该框架之上，OSGi联盟定义了很多服务。这些服务通过一个Java接口指定。bundles能够实  </p>
<p>OSGI<br>现这个接口，并在注册服务层注册该服务。服务的客户端在注册库中找到它，或者当它出现或者消失时做出响应。这个同SOA架构使用Web服务进行发布的方式相似。<br>两者主要不同是Web服务总是需要传输层，这个使它比采用直接方法调用的OSGi服务慢几千倍。同时，OSGi组件能够对这些服务的出现和消失做出响应。更多的信息可以从OSGi服务平台发行版本4手册或者PDF下载中找到。需要注意的是每一种服务都是抽象定义的，与不同计算机服务商的实现相独立。  </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="/blog/2019/07/24/OSGI/" data-id="ckbdc9uqv003y24u2tpmfdx42" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JAVAEE/">JAVAEE</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OSGI/">OSGI</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-docker-onos" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/24/docker-onos/" class="article-date">
  <time datetime="2019-07-24T06:17:00.000Z" itemprop="datePublished">2019-07-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/IT/">IT</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/24/docker-onos/">docker onos</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在Docker中运行ONOS  </p>
<p>下载镜像：  </p>
<p><code>docker pull onosproject/onos</code></p>
<p><img src="/images/pasted-19.png" alt="upload successful"></p>
<p> 查看上一步下载的镜像</p>
<p><code>docker images</code></p>
<p><img src="/images/pasted-20.png" alt="upload successful"></p>
<p>创建docker容器实例<br><code>docker run -t -d --name onos1 onosproject/onos</code></p>
<p><img src="/images/pasted-21.png" alt="upload successful"></p>
<p> 查看上一步创建的docker实例  </p>
<p><img src="/images/pasted-22.png" alt="upload successful"></p>
<p>修改~/.bashrc文件，获取容器实例的IP  </p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">docker-ip</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">sudo docker inspect --format <span class="string">'&#123;&#123; .NetworkSettings.IPAddress &#125;&#125;'</span> <span class="string">"$@"</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><code>. ~/.bashrc</code></p>
<p>用SSH连接一个容器实例，密码是karaf  </p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ssh</span> <span class="selector-tag">-p</span> 8101 <span class="selector-tag">karaf</span>@`<span class="keyword">docker</span>-<span class="keyword">ip</span> onos1`</span><br></pre></td></tr></table></figure>

<p><img src="/images/pasted-23.png" alt="upload successful"></p>
<p> 激活Openflow</p>
<p>onos&gt; app activate org.onosproject.openflow</p>
<p>onos&gt; app activate org.onosproject.fwd</p>
<p><img src="/images/pasted-24.png" alt="upload successful"></p>
<p>如果上述命令报错，则SSH连接到其它docker实例,直至成功激活Openflow</p>
<p>测试<br><code>apt install mininet</code></p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">mn</span> --topo tree,<span class="number">2</span> --controller remote,<span class="built_in">ip</span>=`docker-<span class="built_in">ip</span> onos3`</span><br></pre></td></tr></table></figure>

<p><img src="/images/pasted-25.png" alt="upload successful"></p>
<p><img src="/images/pasted-26.png" alt="upload successful"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="/blog/2019/07/24/docker-onos/" data-id="ckbdc9utt007g24u2byfrnxn3" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DOCKER/">DOCKER</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ONOS/">ONOS</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Mac-关闭开机声音" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/22/Mac-关闭开机声音/" class="article-date">
  <time datetime="2019-07-22T09:08:31.000Z" itemprop="datePublished">2019-07-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/SYSTEM/">SYSTEM</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/22/Mac-关闭开机声音/">Mac 关闭开机声音</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>苹果 Mac系统如何关闭开机声音？<br>1、打开 “应用程序” ，打开“实用工具”，找到并打开[终端]程序，然后输入如下命令并回车（注意，复制的时候不要多复制了空格）： &amp;nbsp;<br><code>sudo nvram SystemAudioVolume=%80</code>  </p>
<p>2、之后会提示输入密码，输入你的用户密码，回车，如下图。这样之后再次启动Mac的时候就是完全静音的了。<br>（注意：输入密码是看不到的，不像普通的输入密码那样能看到，你只管输就可以了，输入完按回车。）</p>
<p>3、如果想要恢复正常的开机声音，只要在终端中再次输入如下命令即可：<br><code>sudo nvram -d SystemAudioVolume</code></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="/blog/2019/07/22/Mac-关闭开机声音/" data-id="ckbdc9uqj003324u29dufo261" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MAC/">MAC</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-docker重指定挂载镜像" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/22/docker重指定挂载镜像/" class="article-date">
  <time datetime="2019-07-22T06:36:00.000Z" itemprop="datePublished">2019-07-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/IT/">IT</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/22/docker重指定挂载镜像/">docker重指定挂载镜像</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>docker-修改容器的挂载目录三种方式<br>方式一：修改配置文件（需停止docker服务）<br>1、停止docker服务<br>systemctl stop docker.service（关键，修改之前必须停止docker服务）<br>2、vim /var/lib/docker/containers/container-ID/config.v2.json<br>修改配置文件中的目录位置，然后保存退出  </p>
<p> “MountPoints”:{“/home”:{“Source”:”/docker”,”Destination”:”/home”,”RW”:true,”Name”:””,”Driver”:””,”Type”:”bind”,”Propagation”:”rprivate”,”Spec”:{“Type”:”bind”,”Source”:”//docker/“,”Target”:”/home”}}}</p>
<p>3、启动docker服务<br>systemctl start docker.service<br>4、启动docker容器<br>docker start &lt;container-name/ID&gt;<br>方式二：提交现有容器为新镜像，然后重新运行它  </p>
<p>$ docker ps  -a   &nbsp;<br>|CONTAINERID|IMAGE|COMMAND|CREATED|STATUS|PORTS|NAMES|<br>|:-|:-|:-|:-|:-|:-|:-|   &nbsp;<br>|5a3422adeead|ubuntu:14.04|”/bin/bash”| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; About a minute ago|Exited(0)|About a minute ago|agitated_newton|<br>$ docker commit 5a3422adeead newimagename<br>$ docker run -ti -v “$PWD/dir1”:/dir1 -v    “$PWD/dir2”:/dir2 newimagename /bin/bash  </p>
<p>然后停止旧容器，并使用这个新容器，如果由于某种原因需要新容器使用旧名称，请在删除旧容器后使用docker rename。<br>方式三：export容器为镜像，然后import为新镜像  </p>
<p>$docker container export -o ./myimage.docker 容器ID<br>$docker import ./myimage.docker newimagename<br>$docker run -ti -v “$PWD/dir1”:/dir1 -v    “$PWD/dir2”:/dir2 newimagename /bin/bash  </p>
<p>然后停止旧容器，并使用这个新容器，如果由于某种原因需要新容器使用旧名称，请在删除旧容器后使用docker rename。  </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="/blog/2019/07/22/docker重指定挂载镜像/" data-id="ckbdc9utv007n24u21tv8p85o" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DOCKER/">DOCKER</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/15/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="page-number" href="/page/15/">15</a><span class="page-number current">16</span><a class="page-number" href="/page/17/">17</a><a class="page-number" href="/page/18/">18</a><span class="space">&hellip;</span><a class="page-number" href="/page/23/">23</a><a class="extend next" rel="next" href="/page/17/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/GIT/">GIT</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/IT/">IT</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVAEE/">JAVAEE</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/JAVAEE/MYSQL/">MYSQL</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/OFFICE/">OFFICE</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SYSTEM/">SYSTEM</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/VIM/">VIM</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/分类1/">分类1</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/电商/">电商</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ANNOTATION/">ANNOTATION</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AOP/">AOP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BAZEL/">BAZEL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BEANUTILS/">BEANUTILS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CENTOS/">CENTOS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CI-CD/">CI/CD</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CLASSLOADER/">CLASSLOADER</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CRONTAB/">CRONTAB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DEBUG/">DEBUG</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DESIGN-PATTERNS/">DESIGN PATTERNS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DNS/">DNS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DOCKER/">DOCKER</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DRUID/">DRUID</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ENLINK/">ENLINK</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ES/">ES</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/EUREKA/">EUREKA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/EXCEL/">EXCEL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Eureka/">Eureka</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FASTJSON/">FASTJSON</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GIT/">GIT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GITLAB/">GITLAB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GLOBALEXCEPTION/">GLOBALEXCEPTION</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GO/">GO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HEXO/">HEXO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IDEA/">IDEA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/INTERCEPTOR/">INTERCEPTOR</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IT/">IT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JAVADOC/">JAVADOC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JAVAEE/">JAVAEE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JAVASCRIPT/">JAVASCRIPT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JAVASE/">JAVASE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JETTY/">JETTY</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JPA/">JPA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JSONUTILS/">JSONUTILS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/KARAF/">KARAF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/KEEPALIVED/">KEEPALIVED</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LINUX/">LINUX</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LISTENER/">LISTENER</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LOADBALANCED/">LOADBALANCED</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LOG/">LOG</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LOGBACK/">LOGBACK</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LOGIN/">LOGIN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LOMBOK/">LOMBOK</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MAC/">MAC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MARKDOWN/">MARKDOWN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MIME-TYPE/">MIME-TYPE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MQ/">MQ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MYBATIS/">MYBATIS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MYCAT/">MYCAT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MYSQL/">MYSQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NETWORK/">NETWORK</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OAUTH2/">OAUTH2</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ONOS/">ONOS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OSGI/">OSGI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OSI/">OSI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PAGEHELPER/">PAGEHELPER</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/POSTMAN/">POSTMAN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PYTHON/">PYTHON</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RABBITMQ/">RABBITMQ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/REDIS/">REDIS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/REDISTEMPLATE/">REDISTEMPLATE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/REFLECTION/">REFLECTION</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/REGISTRY-CENTER/">REGISTRY CENTER</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/REPO/">REPO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RESTTEMPLATE/">RESTTEMPLATE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RIBBON/">RIBBON</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RPM/">RPM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SECURITY/">SECURITY</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SERIALVERSIONUID/">SERIALVERSIONUID</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SERVLET/">SERVLET</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SESSION/">SESSION</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SHELL/">SHELL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SPINTBOOT/">SPINTBOOT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SPRING/">SPRING</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SPRING-MVC/">SPRING MVC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SPRING-STREAM/">SPRING STREAM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SPRINGBBOT/">SPRINGBBOT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SPRINGBOOT/">SPRINGBOOT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SPRINGQUARTZ/">SPRINGQUARTZ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SPRINGTASK/">SPRINGTASK</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SPRINGTBOOT/">SPRINGTBOOT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SPTING/">SPTING</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL/">SQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQLAlert/">SQLAlert</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SSO/">SSO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/STRINGREDISTEMPLATE/">STRINGREDISTEMPLATE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SWAGGER/">SWAGGER</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SYSTEM/">SYSTEM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TCP/">TCP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TCP-IP/">TCP/IP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TERMUX/">TERMUX</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TK-MYBATIS/">TK.MYBATIS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TRANSECTION/">TRANSECTION</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UBUNTU/">UBUNTU</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UDP/">UDP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WEBClIENT/">WEBClIENT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/YAML/">YAML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rabbitMq/">rabbitMq</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分布式/">分布式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/抖音/">抖音</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/文件服务器/">文件服务器</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/时间转化/">时间转化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/标签1/">标签1</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/淘宝/">淘宝</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计模式/">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/高可用/">高可用</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/ANNOTATION/" style="font-size: 14.62px;">ANNOTATION</a> <a href="/tags/AOP/" style="font-size: 10.77px;">AOP</a> <a href="/tags/BAZEL/" style="font-size: 10px;">BAZEL</a> <a href="/tags/BEANUTILS/" style="font-size: 10px;">BEANUTILS</a> <a href="/tags/CENTOS/" style="font-size: 10px;">CENTOS</a> <a href="/tags/CI-CD/" style="font-size: 10px;">CI/CD</a> <a href="/tags/CLASSLOADER/" style="font-size: 10px;">CLASSLOADER</a> <a href="/tags/CRONTAB/" style="font-size: 10.77px;">CRONTAB</a> <a href="/tags/DEBUG/" style="font-size: 10px;">DEBUG</a> <a href="/tags/DESIGN-PATTERNS/" style="font-size: 10px;">DESIGN PATTERNS</a> <a href="/tags/DNS/" style="font-size: 10px;">DNS</a> <a href="/tags/DOCKER/" style="font-size: 11.54px;">DOCKER</a> <a href="/tags/DRUID/" style="font-size: 10px;">DRUID</a> <a href="/tags/ENLINK/" style="font-size: 10px;">ENLINK</a> <a href="/tags/ES/" style="font-size: 16.15px;">ES</a> <a href="/tags/EUREKA/" style="font-size: 10px;">EUREKA</a> <a href="/tags/EXCEL/" style="font-size: 10px;">EXCEL</a> <a href="/tags/Eureka/" style="font-size: 10px;">Eureka</a> <a href="/tags/FASTJSON/" style="font-size: 10px;">FASTJSON</a> <a href="/tags/GIT/" style="font-size: 10px;">GIT</a> <a href="/tags/GITLAB/" style="font-size: 10px;">GITLAB</a> <a href="/tags/GLOBALEXCEPTION/" style="font-size: 10px;">GLOBALEXCEPTION</a> <a href="/tags/GO/" style="font-size: 10.77px;">GO</a> <a href="/tags/HEXO/" style="font-size: 12.31px;">HEXO</a> <a href="/tags/IDEA/" style="font-size: 12.31px;">IDEA</a> <a href="/tags/INTERCEPTOR/" style="font-size: 11.54px;">INTERCEPTOR</a> <a href="/tags/IT/" style="font-size: 11.54px;">IT</a> <a href="/tags/JAVADOC/" style="font-size: 10px;">JAVADOC</a> <a href="/tags/JAVAEE/" style="font-size: 20px;">JAVAEE</a> <a href="/tags/JAVASCRIPT/" style="font-size: 11.54px;">JAVASCRIPT</a> <a href="/tags/JAVASE/" style="font-size: 10.77px;">JAVASE</a> <a href="/tags/JETTY/" style="font-size: 10px;">JETTY</a> <a href="/tags/JPA/" style="font-size: 10.77px;">JPA</a> <a href="/tags/JSONUTILS/" style="font-size: 10px;">JSONUTILS</a> <a href="/tags/KARAF/" style="font-size: 11.54px;">KARAF</a> <a href="/tags/KEEPALIVED/" style="font-size: 10px;">KEEPALIVED</a> <a href="/tags/LINUX/" style="font-size: 16.92px;">LINUX</a> <a href="/tags/LISTENER/" style="font-size: 10px;">LISTENER</a> <a href="/tags/LOADBALANCED/" style="font-size: 10px;">LOADBALANCED</a> <a href="/tags/LOG/" style="font-size: 10px;">LOG</a> <a href="/tags/LOGBACK/" style="font-size: 10px;">LOGBACK</a> <a href="/tags/LOGIN/" style="font-size: 10px;">LOGIN</a> <a href="/tags/LOMBOK/" style="font-size: 11.54px;">LOMBOK</a> <a href="/tags/MAC/" style="font-size: 15.38px;">MAC</a> <a href="/tags/MARKDOWN/" style="font-size: 11.54px;">MARKDOWN</a> <a href="/tags/MIME-TYPE/" style="font-size: 10px;">MIME-TYPE</a> <a href="/tags/MQ/" style="font-size: 12.31px;">MQ</a> <a href="/tags/MYBATIS/" style="font-size: 17.69px;">MYBATIS</a> <a href="/tags/MYCAT/" style="font-size: 10.77px;">MYCAT</a> <a href="/tags/MYSQL/" style="font-size: 16.15px;">MYSQL</a> <a href="/tags/NETWORK/" style="font-size: 10px;">NETWORK</a> <a href="/tags/OAUTH2/" style="font-size: 10.77px;">OAUTH2</a> <a href="/tags/ONOS/" style="font-size: 14.62px;">ONOS</a> <a href="/tags/OSGI/" style="font-size: 13.85px;">OSGI</a> <a href="/tags/OSI/" style="font-size: 10px;">OSI</a> <a href="/tags/PAGEHELPER/" style="font-size: 10px;">PAGEHELPER</a> <a href="/tags/POSTMAN/" style="font-size: 10px;">POSTMAN</a> <a href="/tags/PYTHON/" style="font-size: 13.08px;">PYTHON</a> <a href="/tags/RABBITMQ/" style="font-size: 10.77px;">RABBITMQ</a> <a href="/tags/REDIS/" style="font-size: 11.54px;">REDIS</a> <a href="/tags/REDISTEMPLATE/" style="font-size: 10px;">REDISTEMPLATE</a> <a href="/tags/REFLECTION/" style="font-size: 11.54px;">REFLECTION</a> <a href="/tags/REGISTRY-CENTER/" style="font-size: 10px;">REGISTRY CENTER</a> <a href="/tags/REPO/" style="font-size: 10px;">REPO</a> <a href="/tags/RESTTEMPLATE/" style="font-size: 10px;">RESTTEMPLATE</a> <a href="/tags/RIBBON/" style="font-size: 10.77px;">RIBBON</a> <a href="/tags/RPM/" style="font-size: 10px;">RPM</a> <a href="/tags/SECURITY/" style="font-size: 12.31px;">SECURITY</a> <a href="/tags/SERIALVERSIONUID/" style="font-size: 10px;">SERIALVERSIONUID</a> <a href="/tags/SERVLET/" style="font-size: 10.77px;">SERVLET</a> <a href="/tags/SESSION/" style="font-size: 12.31px;">SESSION</a> <a href="/tags/SHELL/" style="font-size: 14.62px;">SHELL</a> <a href="/tags/SPINTBOOT/" style="font-size: 10px;">SPINTBOOT</a> <a href="/tags/SPRING/" style="font-size: 13.08px;">SPRING</a> <a href="/tags/SPRING-MVC/" style="font-size: 10px;">SPRING MVC</a> <a href="/tags/SPRING-STREAM/" style="font-size: 10px;">SPRING STREAM</a> <a href="/tags/SPRINGBBOT/" style="font-size: 10px;">SPRINGBBOT</a> <a href="/tags/SPRINGBOOT/" style="font-size: 19.23px;">SPRINGBOOT</a> <a href="/tags/SPRINGQUARTZ/" style="font-size: 10px;">SPRINGQUARTZ</a> <a href="/tags/SPRINGTASK/" style="font-size: 12.31px;">SPRINGTASK</a> <a href="/tags/SPRINGTBOOT/" style="font-size: 10px;">SPRINGTBOOT</a> <a href="/tags/SPTING/" style="font-size: 10px;">SPTING</a> <a href="/tags/SQL/" style="font-size: 12.31px;">SQL</a> <a href="/tags/SQLAlert/" style="font-size: 18.46px;">SQLAlert</a> <a href="/tags/SSO/" style="font-size: 10px;">SSO</a> <a href="/tags/STRINGREDISTEMPLATE/" style="font-size: 10px;">STRINGREDISTEMPLATE</a> <a href="/tags/SWAGGER/" style="font-size: 10px;">SWAGGER</a> <a href="/tags/SYSTEM/" style="font-size: 10px;">SYSTEM</a> <a href="/tags/TCP/" style="font-size: 10px;">TCP</a> <a href="/tags/TCP-IP/" style="font-size: 11.54px;">TCP/IP</a> <a href="/tags/TERMUX/" style="font-size: 10.77px;">TERMUX</a> <a href="/tags/TK-MYBATIS/" style="font-size: 10px;">TK.MYBATIS</a> <a href="/tags/TRANSECTION/" style="font-size: 10px;">TRANSECTION</a> <a href="/tags/UBUNTU/" style="font-size: 10px;">UBUNTU</a> <a href="/tags/UDP/" style="font-size: 10px;">UDP</a> <a href="/tags/WEBClIENT/" style="font-size: 10px;">WEBClIENT</a> <a href="/tags/YAML/" style="font-size: 10.77px;">YAML</a> <a href="/tags/rabbitMq/" style="font-size: 10px;">rabbitMq</a> <a href="/tags/分布式/" style="font-size: 10px;">分布式</a> <a href="/tags/抖音/" style="font-size: 10px;">抖音</a> <a href="/tags/文件服务器/" style="font-size: 10.77px;">文件服务器</a> <a href="/tags/时间转化/" style="font-size: 10px;">时间转化</a> <a href="/tags/标签1/" style="font-size: 10px;">标签1</a> <a href="/tags/淘宝/" style="font-size: 10px;">淘宝</a> <a href="/tags/设计模式/" style="font-size: 10px;">设计模式</a> <a href="/tags/高可用/" style="font-size: 10px;">高可用</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/06/13/可视化面板/">(no title)</a>
          </li>
        
          <li>
            <a href="/2020/06/13/邮箱找回密码与二次认证/">(no title)</a>
          </li>
        
          <li>
            <a href="/2020/06/13/特权用户访问策略控制/">(no title)</a>
          </li>
        
          <li>
            <a href="/2020/06/13/md列表/">markdown任务列表语法checkbox</a>
          </li>
        
          <li>
            <a href="/2020/06/13/CS应用配置/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 Joe Tong<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>