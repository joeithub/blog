{"filter":false,"title":"jetty-servlet-开发.md","tooltip":"/_posts/jetty-servlet-开发.md","undoManager":{"mark":100,"position":100,"stack":[[{"start":{"row":415,"column":34},"end":{"row":415,"column":35},"action":"insert","lines":[" "],"id":234},{"start":{"row":415,"column":35},"end":{"row":415,"column":36},"action":"insert","lines":[" "]}],[{"start":{"row":416,"column":7},"end":{"row":416,"column":8},"action":"insert","lines":[" "],"id":235},{"start":{"row":416,"column":8},"end":{"row":416,"column":9},"action":"insert","lines":[" "]}],[{"start":{"row":417,"column":13},"end":{"row":417,"column":14},"action":"insert","lines":[" "],"id":236},{"start":{"row":417,"column":14},"end":{"row":417,"column":15},"action":"insert","lines":[" "]}],[{"start":{"row":418,"column":21},"end":{"row":418,"column":22},"action":"insert","lines":[" "],"id":237},{"start":{"row":418,"column":22},"end":{"row":418,"column":23},"action":"insert","lines":[" "]}],[{"start":{"row":420,"column":17},"end":{"row":420,"column":18},"action":"insert","lines":[" "],"id":238},{"start":{"row":420,"column":18},"end":{"row":420,"column":19},"action":"insert","lines":[" "]}],[{"start":{"row":421,"column":11},"end":{"row":421,"column":12},"action":"insert","lines":[" "],"id":239},{"start":{"row":421,"column":12},"end":{"row":421,"column":13},"action":"insert","lines":[" "]}],[{"start":{"row":422,"column":22},"end":{"row":422,"column":23},"action":"insert","lines":[" "],"id":240}],[{"start":{"row":422,"column":22},"end":{"row":422,"column":23},"action":"remove","lines":[" "],"id":241}],[{"start":{"row":422,"column":23},"end":{"row":422,"column":24},"action":"insert","lines":[" "],"id":242},{"start":{"row":422,"column":24},"end":{"row":422,"column":25},"action":"insert","lines":[" "]}],[{"start":{"row":423,"column":34},"end":{"row":423,"column":35},"action":"insert","lines":[" "],"id":243},{"start":{"row":423,"column":35},"end":{"row":423,"column":36},"action":"insert","lines":[" "]}],[{"start":{"row":424,"column":7},"end":{"row":424,"column":8},"action":"insert","lines":[" "],"id":244},{"start":{"row":424,"column":8},"end":{"row":424,"column":9},"action":"insert","lines":[" "]}],[{"start":{"row":425,"column":13},"end":{"row":425,"column":14},"action":"insert","lines":[" "],"id":245},{"start":{"row":425,"column":14},"end":{"row":425,"column":15},"action":"insert","lines":[" "]}],[{"start":{"row":426,"column":11},"end":{"row":426,"column":12},"action":"insert","lines":[" "],"id":246},{"start":{"row":426,"column":12},"end":{"row":426,"column":13},"action":"insert","lines":[" "]}],[{"start":{"row":426,"column":13},"end":{"row":426,"column":14},"action":"insert","lines":[" "],"id":247}],[{"start":{"row":429,"column":18},"end":{"row":429,"column":19},"action":"insert","lines":[" "],"id":248},{"start":{"row":429,"column":19},"end":{"row":429,"column":20},"action":"insert","lines":[" "]}],[{"start":{"row":430,"column":76},"end":{"row":430,"column":77},"action":"insert","lines":[" "],"id":249},{"start":{"row":430,"column":77},"end":{"row":430,"column":78},"action":"insert","lines":[" "]}],[{"start":{"row":430,"column":78},"end":{"row":431,"column":0},"action":"insert","lines":["",""],"id":250},{"start":{"row":431,"column":0},"end":{"row":431,"column":1},"action":"insert","lines":["`"]},{"start":{"row":431,"column":1},"end":{"row":431,"column":2},"action":"insert","lines":["`"]},{"start":{"row":431,"column":2},"end":{"row":431,"column":3},"action":"insert","lines":["`"]}],[{"start":{"row":431,"column":3},"end":{"row":432,"column":0},"action":"insert","lines":["",""],"id":251}],[{"start":{"row":432,"column":0},"end":{"row":475,"column":60},"action":"insert","lines":["","实例14 ListenerEchoSocket.java","package examples.echo;"," ","import org.eclipse.jetty.websocket.api.Session;","import org.eclipse.jetty.websocket.api.WebSocketListener;"," ","/**"," * Example EchoSocket using Listener."," */","public class ListenerEchoSocket implements WebSocketListener {"," ","    private Session outbound;"," ","    @Override","    public void onWebSocketBinary(byte[] payload, int offset, int len) {","    }"," ","    @Override","    public void onWebSocketClose(int statusCode, String reason) {","        this.outbound = null;","    }"," ","    @Override","    public void onWebSocketConnect(Session session) {","        this.outbound = session;","    }"," ","    @Override","    public void onWebSocketError(Throwable cause) {","        cause.printStackTrace(System.err);","    }"," ","    @Override","    public void onWebSocketText(String message) {","        if ((outbound != null) && (outbound.isOpen())) {","            System.out.printf(\"Echoing back message [%s]%n\", message);","            outbound.getRemote().sendString(message, null);","        }","    }","","--------------------- ","版权声明：本文为CSDN博主「tomato__」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。","原文链接：https://blog.csdn.net/tomato__/article/details/38418155"],"id":252}],[{"start":{"row":473,"column":0},"end":{"row":475,"column":60},"action":"remove","lines":["--------------------- ","版权声明：本文为CSDN博主「tomato__」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。","原文链接：https://blog.csdn.net/tomato__/article/details/38418155"],"id":253},{"start":{"row":473,"column":0},"end":{"row":473,"column":1},"action":"insert","lines":["}"]}],[{"start":{"row":473,"column":1},"end":{"row":474,"column":0},"action":"insert","lines":["",""],"id":254},{"start":{"row":474,"column":0},"end":{"row":474,"column":1},"action":"insert","lines":["`"]},{"start":{"row":474,"column":1},"end":{"row":474,"column":2},"action":"insert","lines":["`"]},{"start":{"row":474,"column":2},"end":{"row":474,"column":3},"action":"insert","lines":["`"]}],[{"start":{"row":471,"column":5},"end":{"row":472,"column":0},"action":"remove","lines":["",""],"id":255}],[{"start":{"row":472,"column":1},"end":{"row":473,"column":0},"action":"insert","lines":["",""],"id":256}],[{"start":{"row":474,"column":3},"end":{"row":475,"column":0},"action":"insert","lines":["",""],"id":257}],[{"start":{"row":475,"column":0},"end":{"row":475,"column":41},"action":"insert","lines":["如果listener做了太多的工作，你能使用WebSocketAdapter代替。"],"id":258}],[{"start":{"row":475,"column":41},"end":{"row":475,"column":43},"action":"insert","lines":["''"],"id":259}],[{"start":{"row":475,"column":41},"end":{"row":475,"column":43},"action":"remove","lines":["''"],"id":260}],[{"start":{"row":475,"column":41},"end":{"row":476,"column":0},"action":"insert","lines":["",""],"id":261}],[{"start":{"row":476,"column":0},"end":{"row":479,"column":0},"action":"insert","lines":["使用WebSocketAdapter","WebSocketListener的适配器。","",""],"id":262}],[{"start":{"row":479,"column":0},"end":{"row":479,"column":1},"action":"insert","lines":["`"],"id":263},{"start":{"row":479,"column":1},"end":{"row":479,"column":2},"action":"insert","lines":["`"]},{"start":{"row":479,"column":2},"end":{"row":479,"column":3},"action":"insert","lines":["`"]}],[{"start":{"row":479,"column":3},"end":{"row":480,"column":0},"action":"insert","lines":["",""],"id":264}],[{"start":{"row":480,"column":0},"end":{"row":505,"column":60},"action":"insert","lines":["实例15 AdapterEchoSocket.java","package examples.echo;"," ","import java.io.IOException;","import org.eclipse.jetty.websocket.api.WebSocketAdapter;"," ","/**"," * Example EchoSocket using Adapter."," */","public class AdapterEchoSocket extends WebSocketAdapter {"," ","    @Override","    public void onWebSocketText(String message) {","        if (isConnected()) {","            try {","                System.out.printf(\"Echoing back message [%s]%n\", message);","                getRemote().sendString(message);","            } catch (IOException e) {","                e.printStackTrace(System.err);","            }","        }","    }","","--------------------- ","版权声明：本文为CSDN博主「tomato__」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。","原文链接：https://blog.csdn.net/tomato__/article/details/38418155"],"id":265}],[{"start":{"row":503,"column":0},"end":{"row":505,"column":60},"action":"remove","lines":["--------------------- ","版权声明：本文为CSDN博主「tomato__」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。","原文链接：https://blog.csdn.net/tomato__/article/details/38418155"],"id":266},{"start":{"row":503,"column":0},"end":{"row":503,"column":1},"action":"insert","lines":["}"]}],[{"start":{"row":503,"column":1},"end":{"row":504,"column":0},"action":"insert","lines":["",""],"id":267},{"start":{"row":504,"column":0},"end":{"row":504,"column":1},"action":"insert","lines":["`"]},{"start":{"row":504,"column":1},"end":{"row":504,"column":2},"action":"insert","lines":["`"]},{"start":{"row":504,"column":2},"end":{"row":504,"column":3},"action":"insert","lines":["`"]}],[{"start":{"row":501,"column":5},"end":{"row":502,"column":0},"action":"remove","lines":["",""],"id":268}],[{"start":{"row":503,"column":3},"end":{"row":504,"column":0},"action":"insert","lines":["",""],"id":269}],[{"start":{"row":504,"column":0},"end":{"row":515,"column":60},"action":"insert","lines":["这个类比WebSocketListener跟为便利，并提供了有用的方法检查Session的状态。","","Jetty WebSocket Server API","Jetty通过WebSocketServlet和servlet桥接的使用，提供了将WebSocket端点到Servlet路径的对应。","内在地，Jetty管理HTTP升级到WebSocket，并且从一个HTTP连接移植到一个WebSocket连接。","这只有当运行在Jetty容器内部时才工作。","","Jetty WebSocketServlet","为了通过WebSocketServlet对应你的WebSocket到一个指定的路径，你将需要扩展org.eclipse.jetty.websocket.servlet.WebSocketServlet并指定什么WebSocket对象应该被创建。","--------------------- ","版权声明：本文为CSDN博主「tomato__」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。","原文链接：https://blog.csdn.net/tomato__/article/details/38418155"],"id":270}],[{"start":{"row":513,"column":0},"end":{"row":515,"column":60},"action":"remove","lines":["--------------------- ","版权声明：本文为CSDN博主「tomato__」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。","原文链接：https://blog.csdn.net/tomato__/article/details/38418155"],"id":271}],[{"start":{"row":513,"column":0},"end":{"row":513,"column":1},"action":"insert","lines":["`"],"id":272},{"start":{"row":513,"column":1},"end":{"row":513,"column":2},"action":"insert","lines":["`"]},{"start":{"row":513,"column":2},"end":{"row":513,"column":3},"action":"insert","lines":["`"]}],[{"start":{"row":513,"column":3},"end":{"row":514,"column":0},"action":"insert","lines":["",""],"id":273}],[{"start":{"row":514,"column":0},"end":{"row":534,"column":60},"action":"insert","lines":["","实例16 MyEchoServlet.java","package examples;"," ","import javax.servlet.annotation.WebServlet;","import org.eclipse.jetty.websocket.servlet.WebSocketServlet;","import org.eclipse.jetty.websocket.servlet.WebSocketServletFactory;"," ","@SuppressWarnings(\"serial\")","@WebServlet(name = \"MyEcho WebSocket Servlet\", urlPatterns = { \"/echo\" })","public class MyEchoServlet extends WebSocketServlet {"," ","    @Override","    public void configure(WebSocketServletFactory factory) {","        factory.getPolicy().setIdleTimeout(10000);","        factory.register(MyEchoSocket.class);","    }","","--------------------- ","版权声明：本文为CSDN博主「tomato__」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。","原文链接：https://blog.csdn.net/tomato__/article/details/38418155"],"id":274}],[{"start":{"row":531,"column":0},"end":{"row":534,"column":60},"action":"remove","lines":["","--------------------- ","版权声明：本文为CSDN博主「tomato__」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。","原文链接：https://blog.csdn.net/tomato__/article/details/38418155"],"id":275},{"start":{"row":531,"column":0},"end":{"row":531,"column":1},"action":"insert","lines":["}"]}],[{"start":{"row":531,"column":1},"end":{"row":532,"column":0},"action":"insert","lines":["",""],"id":276},{"start":{"row":532,"column":0},"end":{"row":532,"column":1},"action":"insert","lines":["`"]},{"start":{"row":532,"column":1},"end":{"row":532,"column":2},"action":"insert","lines":["`"]},{"start":{"row":532,"column":2},"end":{"row":532,"column":3},"action":"insert","lines":["`"]}],[{"start":{"row":531,"column":1},"end":{"row":532,"column":0},"action":"insert","lines":["",""],"id":277}],[{"start":{"row":533,"column":3},"end":{"row":534,"column":0},"action":"insert","lines":["",""],"id":278},{"start":{"row":534,"column":0},"end":{"row":535,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":535,"column":0},"end":{"row":546,"column":60},"action":"insert","lines":["这个例子将创建一个Sevlet，通过@WebServlet注解匹配到Servlet路径\"/echo\"（或者你能在你的web应用的WEB-INF/web.xml中手动的配置），当收到HTTP升级请求时将创建MyEchoSocket实例。","WebSocketServlet.configure(WebSocketServletFactory factory)是为你的WebSocket指定配置的地方。在这个例子中，我们指定一个10s的空闲超时，并注册MyEchoSocket，即当收到请求时我们想创建的WebSocket类，使用默认的WebSocketCreator创建。","","使用WebSocketCreator","所有WebSocket都是通过你注册到WebSocketServletFactory的WebSocketCreator创建的。","默认，WebSocketServletFactory是一个简单的WebSocketCreator，能创建一个单例的WebSocket对象。 使用WebSocketCreator.register(Class<?> websocket)告诉WebSocketServletFactory应该实例化哪个类（确保它有一个默认的构造器）。","如果你有更复杂的创建场景，你可以提供你自己的WebSocketCreator，基于在UpgradeRequest对象中出现的信息创建的WebSocket。","","","--------------------- ","版权声明：本文为CSDN博主「tomato__」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。","原文链接：https://blog.csdn.net/tomato__/article/details/38418155"],"id":279}],[{"start":{"row":543,"column":0},"end":{"row":546,"column":60},"action":"remove","lines":["","--------------------- ","版权声明：本文为CSDN博主「tomato__」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。","原文链接：https://blog.csdn.net/tomato__/article/details/38418155"],"id":280}],[{"start":{"row":544,"column":0},"end":{"row":544,"column":1},"action":"insert","lines":["`"],"id":281},{"start":{"row":544,"column":1},"end":{"row":544,"column":2},"action":"insert","lines":["`"]},{"start":{"row":544,"column":2},"end":{"row":544,"column":3},"action":"insert","lines":["`"]}],[{"start":{"row":544,"column":3},"end":{"row":545,"column":0},"action":"insert","lines":["",""],"id":282}],[{"start":{"row":545,"column":0},"end":{"row":580,"column":60},"action":"insert","lines":["实例17 MyAdvancedEchoCreator.java","package examples;"," ","import org.eclipse.jetty.websocket.servlet.ServletUpgradeRequest;","import org.eclipse.jetty.websocket.servlet.ServletUpgradeResponse;","import org.eclipse.jetty.websocket.servlet.WebSocketCreator;"," ","public class MyAdvancedEchoCreator implements WebSocketCreator {"," ","    private MyBinaryEchoSocket binaryEcho;"," ","    private MyEchoSocket textEcho;"," ","    public MyAdvancedEchoCreator() {","        this.binaryEcho = new MyBinaryEchoSocket();","        this.textEcho = new MyEchoSocket();","    }"," ","    @Override","    public Object createWebSocket(ServletUpgradeRequest req, ServletUpgradeResponse resp) {","        for (String subprotocol : req.getSubProtocols()) {","            if (\"binary\".equals(subprotocol)) {","                resp.setAcceptedSubProtocol(subprotocol);","                return binaryEcho;","            }","            if (\"text\".equals(subprotocol)) {","                resp.setAcceptedSubProtocol(subprotocol);","                return textEcho;","            }","        }","        return null;","    }","","--------------------- ","版权声明：本文为CSDN博主「tomato__」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。","原文链接：https://blog.csdn.net/tomato__/article/details/38418155"],"id":283}],[{"start":{"row":578,"column":0},"end":{"row":580,"column":60},"action":"remove","lines":["--------------------- ","版权声明：本文为CSDN博主「tomato__」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。","原文链接：https://blog.csdn.net/tomato__/article/details/38418155"],"id":284},{"start":{"row":578,"column":0},"end":{"row":578,"column":1},"action":"insert","lines":["}"]}],[{"start":{"row":578,"column":1},"end":{"row":579,"column":0},"action":"insert","lines":["",""],"id":285},{"start":{"row":579,"column":0},"end":{"row":579,"column":1},"action":"insert","lines":["`"]},{"start":{"row":579,"column":1},"end":{"row":579,"column":2},"action":"insert","lines":["`"]},{"start":{"row":579,"column":2},"end":{"row":579,"column":3},"action":"insert","lines":["`"]}],[{"start":{"row":576,"column":5},"end":{"row":577,"column":0},"action":"remove","lines":["",""],"id":286}],[{"start":{"row":578,"column":3},"end":{"row":579,"column":0},"action":"insert","lines":["",""],"id":287}],[{"start":{"row":579,"column":0},"end":{"row":579,"column":70},"action":"insert","lines":["这儿我们展示了一个WebSocketCreator，将利用来自请求的WebSocket子协议信息决定什么类型的WebSocket应该被创建。"],"id":288}],[{"start":{"row":579,"column":70},"end":{"row":580,"column":0},"action":"insert","lines":["",""],"id":289}],[{"start":{"row":580,"column":0},"end":{"row":580,"column":1},"action":"insert","lines":["`"],"id":290},{"start":{"row":580,"column":1},"end":{"row":580,"column":2},"action":"insert","lines":["`"]},{"start":{"row":580,"column":2},"end":{"row":580,"column":3},"action":"insert","lines":["`"]}],[{"start":{"row":580,"column":3},"end":{"row":581,"column":0},"action":"insert","lines":["",""],"id":291}],[{"start":{"row":581,"column":0},"end":{"row":600,"column":60},"action":"insert","lines":["实例18 MyAdvancedEchoServlet.java","package examples;"," ","import javax.servlet.annotation.WebServlet;","import org.eclipse.jetty.websocket.servlet.WebSocketServlet;","import org.eclipse.jetty.websocket.servlet.WebSocketServletFactory;"," ","@SuppressWarnings(\"serial\")","@WebServlet(name = \"MyAdvanced Echo WebSocket Servlet\", urlPatterns = { \"/advecho\" })","public class MyAdvancedEchoServlet extends WebSocketServlet {"," ","    @Override","    public void configure(WebSocketServletFactory factory) {","        factory.getPolicy().setIdleTimeout(10000);","        factory.setCreator(new MyAdvancedEchoCreator());","    }","","--------------------- ","版权声明：本文为CSDN博主「tomato__」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。","原文链接：https://blog.csdn.net/tomato__/article/details/38418155"],"id":292}],[{"start":{"row":597,"column":0},"end":{"row":600,"column":60},"action":"remove","lines":["","--------------------- ","版权声明：本文为CSDN博主「tomato__」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。","原文链接：https://blog.csdn.net/tomato__/article/details/38418155"],"id":293},{"start":{"row":597,"column":0},"end":{"row":597,"column":1},"action":"insert","lines":["}"]}],[{"start":{"row":597,"column":1},"end":{"row":598,"column":0},"action":"insert","lines":["",""],"id":294},{"start":{"row":598,"column":0},"end":{"row":598,"column":1},"action":"insert","lines":["`"]},{"start":{"row":598,"column":1},"end":{"row":598,"column":2},"action":"insert","lines":["1"]},{"start":{"row":598,"column":2},"end":{"row":598,"column":3},"action":"insert","lines":["`"]},{"start":{"row":598,"column":3},"end":{"row":598,"column":4},"action":"insert","lines":["`"]}],[{"start":{"row":598,"column":3},"end":{"row":598,"column":4},"action":"remove","lines":["`"],"id":295},{"start":{"row":598,"column":2},"end":{"row":598,"column":3},"action":"remove","lines":["`"]},{"start":{"row":598,"column":1},"end":{"row":598,"column":2},"action":"remove","lines":["1"]}],[{"start":{"row":598,"column":1},"end":{"row":598,"column":2},"action":"insert","lines":["`"],"id":296},{"start":{"row":598,"column":2},"end":{"row":598,"column":3},"action":"insert","lines":["`"]}],[{"start":{"row":598,"column":3},"end":{"row":599,"column":0},"action":"insert","lines":["",""],"id":297}],[{"start":{"row":599,"column":0},"end":{"row":609,"column":60},"action":"insert","lines":["当你想要一个定制的WebSocketCreator时，使用WebSocketServletFactory.setCreator(WebSocketCreator creator)，然后WebSocketServletFactory将为所有在这个servlet上收到的Upgrade请求用你的创造器。","一个WebSocketCreator还可以用于："," 1）控制WebSocket子协议的选择；"," 2）履行任何你认为重要的WebSocket源；"," 3）从输入的请求获取HTTP头；"," 4）获取Servlet HttpSession对象（如果它存在）；"," 5）指定一个响应状态码和原因；","如果你不想接收这个请求，简单的从WebSocketCreator.createWebSocket(UpgradeRequest req, UpgradeResponse resp)返回null。","--------------------- ","版权声明：本文为CSDN博主「tomato__」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。","原文链接：https://blog.csdn.net/tomato__/article/details/38418155"],"id":298}],[{"start":{"row":601,"column":0},"end":{"row":601,"column":1},"action":"remove","lines":[" "],"id":299}],[{"start":{"row":602,"column":0},"end":{"row":602,"column":1},"action":"remove","lines":[" "],"id":300}],[{"start":{"row":603,"column":0},"end":{"row":603,"column":1},"action":"remove","lines":[" "],"id":301}],[{"start":{"row":604,"column":0},"end":{"row":604,"column":1},"action":"remove","lines":[" "],"id":302}],[{"start":{"row":605,"column":0},"end":{"row":605,"column":1},"action":"remove","lines":[" "],"id":303}],[{"start":{"row":607,"column":0},"end":{"row":609,"column":60},"action":"remove","lines":["--------------------- ","版权声明：本文为CSDN博主「tomato__」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。","原文链接：https://blog.csdn.net/tomato__/article/details/38418155"],"id":304}],[{"start":{"row":607,"column":0},"end":{"row":608,"column":0},"action":"insert","lines":["",""],"id":305}],[{"start":{"row":608,"column":0},"end":{"row":610,"column":54},"action":"insert","lines":["Jetty WebSocket Client API","Jetty也提供了一个Jetty WebSocket Client库，为了更容易的与WebSocket服务端交互。","为了在你自己的Java项目上使用Jetty WebSocket Client，你将需要下面的maven配置："],"id":306}],[{"start":{"row":610,"column":54},"end":{"row":611,"column":0},"action":"insert","lines":["",""],"id":307}],[{"start":{"row":611,"column":0},"end":{"row":612,"column":0},"action":"insert","lines":["",""],"id":308}],[{"start":{"row":612,"column":0},"end":{"row":621,"column":60},"action":"insert","lines":["","<dependency>","  <groupId>org.eclipse.jetty.websocket</groupId>","  <artifactId>websocket-client</artifactId>","  <version>${project.version}</version>","</dependency>","WebSocketClient","--------------------- ","版权声明：本文为CSDN博主「tomato__」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。","原文链接：https://blog.csdn.net/tomato__/article/details/38418155"],"id":309}],[{"start":{"row":619,"column":0},"end":{"row":621,"column":60},"action":"remove","lines":["--------------------- ","版权声明：本文为CSDN博主「tomato__」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。","原文链接：https://blog.csdn.net/tomato__/article/details/38418155"],"id":310}],[{"start":{"row":612,"column":0},"end":{"row":612,"column":1},"action":"insert","lines":["`"],"id":311},{"start":{"row":612,"column":1},"end":{"row":612,"column":2},"action":"insert","lines":["`"]},{"start":{"row":612,"column":2},"end":{"row":612,"column":3},"action":"insert","lines":["`"]}],[{"start":{"row":617,"column":13},"end":{"row":618,"column":0},"action":"insert","lines":["",""],"id":312},{"start":{"row":618,"column":0},"end":{"row":618,"column":1},"action":"insert","lines":["`"]},{"start":{"row":618,"column":1},"end":{"row":618,"column":2},"action":"insert","lines":["`"]},{"start":{"row":618,"column":2},"end":{"row":618,"column":3},"action":"insert","lines":["`"]}],[{"start":{"row":617,"column":13},"end":{"row":618,"column":0},"action":"insert","lines":["",""],"id":313}],[{"start":{"row":620,"column":15},"end":{"row":621,"column":0},"action":"insert","lines":["",""],"id":314}],[{"start":{"row":621,"column":0},"end":{"row":621,"column":63},"action":"insert","lines":["为了使用WebSocketClient，你将需要连接一个WebSocket对象实例到一个指定的目标WebSocket URI。"],"id":315}],[{"start":{"row":622,"column":0},"end":{"row":622,"column":1},"action":"insert","lines":["`"],"id":316},{"start":{"row":622,"column":1},"end":{"row":622,"column":2},"action":"insert","lines":["`"]},{"start":{"row":622,"column":2},"end":{"row":622,"column":3},"action":"insert","lines":["`"]}],[{"start":{"row":622,"column":3},"end":{"row":623,"column":0},"action":"insert","lines":["",""],"id":317}],[{"start":{"row":623,"column":0},"end":{"row":663,"column":60},"action":"insert","lines":["实例19 SimpleEchoClient.java","package examples;"," ","import java.net.URI;","import java.util.concurrent.TimeUnit;","import org.eclipse.jetty.websocket.client.ClientUpgradeRequest;","import org.eclipse.jetty.websocket.client.WebSocketClient;"," ","/**"," * Example of a simple Echo Client."," */","public class SimpleEchoClient {"," ","    public static void main(String[] args) {","        String destUri = \"ws://echo.websocket.org\";","        if (args.length > 0) {","            destUri = args[0];","        }","        WebSocketClient client = new WebSocketClient();","        SimpleEchoSocket socket = new SimpleEchoSocket();","        try {","            client.start();","            URI echoUri = new URI(destUri);","            ClientUpgradeRequest request = new ClientUpgradeRequest();","            client.connect(socket, echoUri, request);","            System.out.printf(\"Connecting to : %s%n\", echoUri);","            socket.awaitClose(5, TimeUnit.SECONDS);","        } catch (Throwable t) {","            t.printStackTrace();","        } finally {","            try {","                client.stop();","            } catch (Exception e) {","                e.printStackTrace();","            }","        }","    }","","--------------------- ","版权声明：本文为CSDN博主「tomato__」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。","原文链接：https://blog.csdn.net/tomato__/article/details/38418155"],"id":318}],[{"start":{"row":661,"column":0},"end":{"row":663,"column":60},"action":"remove","lines":["--------------------- ","版权声明：本文为CSDN博主「tomato__」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。","原文链接：https://blog.csdn.net/tomato__/article/details/38418155"],"id":319},{"start":{"row":661,"column":0},"end":{"row":661,"column":1},"action":"insert","lines":["}"]}],[{"start":{"row":661,"column":1},"end":{"row":662,"column":0},"action":"insert","lines":["",""],"id":320},{"start":{"row":662,"column":0},"end":{"row":662,"column":1},"action":"insert","lines":["·"]},{"start":{"row":662,"column":1},"end":{"row":662,"column":2},"action":"insert","lines":["·"]},{"start":{"row":662,"column":2},"end":{"row":662,"column":3},"action":"insert","lines":["·"]}],[{"start":{"row":662,"column":2},"end":{"row":662,"column":3},"action":"remove","lines":["·"],"id":321},{"start":{"row":662,"column":1},"end":{"row":662,"column":2},"action":"remove","lines":["·"]},{"start":{"row":662,"column":0},"end":{"row":662,"column":1},"action":"remove","lines":["·"]}],[{"start":{"row":662,"column":0},"end":{"row":662,"column":1},"action":"insert","lines":["`"],"id":322},{"start":{"row":662,"column":1},"end":{"row":662,"column":2},"action":"insert","lines":["`"]},{"start":{"row":662,"column":2},"end":{"row":662,"column":3},"action":"insert","lines":["`"]}],[{"start":{"row":662,"column":3},"end":{"row":663,"column":0},"action":"insert","lines":["",""],"id":323}],[{"start":{"row":663,"column":0},"end":{"row":663,"column":80},"action":"insert","lines":["上面的例子连接到一个远端WebSocket服务端，并且连接后使用一个SimpleEchoSocket履行在websocket上的处理逻辑，等待socket关闭。"],"id":324}],[{"start":{"row":663,"column":80},"end":{"row":664,"column":0},"action":"insert","lines":["",""],"id":325}],[{"start":{"row":664,"column":0},"end":{"row":664,"column":1},"action":"insert","lines":["`"],"id":326},{"start":{"row":664,"column":1},"end":{"row":664,"column":2},"action":"insert","lines":["`"]},{"start":{"row":664,"column":2},"end":{"row":664,"column":3},"action":"insert","lines":["`"]}],[{"start":{"row":664,"column":3},"end":{"row":665,"column":0},"action":"insert","lines":["",""],"id":327}],[{"start":{"row":665,"column":0},"end":{"row":727,"column":60},"action":"insert","lines":["实例20 SimpleEchoSocket.java","package examples;"," ","import java.util.concurrent.CountDownLatch;","import java.util.concurrent.Future;","import java.util.concurrent.TimeUnit;","import org.eclipse.jetty.websocket.api.Session;","import org.eclipse.jetty.websocket.api.StatusCode;","import org.eclipse.jetty.websocket.api.annotations.OnWebSocketClose;","import org.eclipse.jetty.websocket.api.annotations.OnWebSocketConnect;","import org.eclipse.jetty.websocket.api.annotations.OnWebSocketMessage;","import org.eclipse.jetty.websocket.api.annotations.WebSocket;"," ","/**"," * Basic Echo Client Socket"," */","@WebSocket(maxTextMessageSize = 64 * 1024)","public class SimpleEchoSocket {"," ","    private final CountDownLatch closeLatch;"," ","    @SuppressWarnings(\"unused\")","    private Session session;"," ","    public SimpleEchoSocket() {","        this.closeLatch = new CountDownLatch(1);","    }"," ","    public boolean awaitClose(int duration, TimeUnit unit) throws InterruptedException {","        return this.closeLatch.await(duration, unit);","    }"," ","    @OnWebSocketClose","    public void onClose(int statusCode, String reason) {","        System.out.printf(\"Connection closed: %d - %s%n\", statusCode, reason);","        this.session = null;","        this.closeLatch.countDown();","    }"," ","    @OnWebSocketConnect","    public void onConnect(Session session) {","        System.out.printf(\"Got connect: %s%n\", session);","        this.session = session;","        try {","            Future<Void> fut;","            fut = session.getRemote().sendStringByFuture(\"Hello\");","            fut.get(2, TimeUnit.SECONDS);","            fut = session.getRemote().sendStringByFuture(\"Thanks for the conversation.\");","            fut.get(2, TimeUnit.SECONDS);","            session.close(StatusCode.NORMAL, \"I'm done\");","        } catch (Throwable t) {","            t.printStackTrace();","        }","    }"," ","    @OnWebSocketMessage","    public void onMessage(String msg) {","        System.out.printf(\"Got msg: %s%n\", msg);","    }","","--------------------- ","版权声明：本文为CSDN博主「tomato__」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。","原文链接：https://blog.csdn.net/tomato__/article/details/38418155"],"id":328}],[{"start":{"row":725,"column":0},"end":{"row":727,"column":60},"action":"remove","lines":["--------------------- ","版权声明：本文为CSDN博主「tomato__」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。","原文链接：https://blog.csdn.net/tomato__/article/details/38418155"],"id":329},{"start":{"row":725,"column":0},"end":{"row":725,"column":1},"action":"insert","lines":["}"]}],[{"start":{"row":725,"column":1},"end":{"row":726,"column":0},"action":"insert","lines":["",""],"id":330}],[{"start":{"row":726,"column":0},"end":{"row":727,"column":0},"action":"insert","lines":["",""],"id":331}],[{"start":{"row":727,"column":0},"end":{"row":728,"column":50},"action":"insert","lines":["当SimpleEchoSocket连接成功后，它发送2个文本信息，然后关闭socket。","onMessage(String msg)收到来自远端WebSocket的响应，并输出他们到控制台。"],"id":332}],[{"start":{"row":726,"column":0},"end":{"row":726,"column":1},"action":"insert","lines":["`"],"id":333},{"start":{"row":726,"column":1},"end":{"row":726,"column":2},"action":"insert","lines":["`"]},{"start":{"row":726,"column":2},"end":{"row":726,"column":3},"action":"insert","lines":["`"]}],[{"start":{"row":725,"column":1},"end":{"row":726,"column":0},"action":"insert","lines":["",""],"id":335}]]},"ace":{"folds":[],"scrolltop":4436.5,"scrollleft":0,"selection":{"start":{"row":726,"column":0},"end":{"row":726,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1565249183646,"hash":"636a941b355b32d2d42d78585b616a4d65d8331d"}